/*! For license information please see main.b6ad808b.chunk.js.LICENSE.txt */
(this.webpackJsonptrucklovely=this.webpackJsonptrucklovely||[]).push([[0],{102:function(e,t,n){var r=n(12),i=(n(18)("interblock:models:integrity"),n(117)),a=(0,n(41).standardize)({schema:n(87).integritySchema,create:function(e){if(!e||"UNKNOWN"===e)return a.clone({hash:"UNKNOWN",algorithm:"sha256"});if("string"===typeof e&&64===e.length)return a.clone({hash:e,algorithm:"sha256"});"string"===typeof e&&(e={string:e}),r("object"===typeof e,"Must supply object: ".concat(e));var t={hash:i.objectHash(e),algorithm:"sha256"};return a.clone(t)},logicize:function(e){return{isUnknown:function(){return"UNKNOWN"===e.hash},isIntegrityMatch:function(t){return a.create(t).hash===e.hash}}}});e.exports={integrityModel:a}},103:function(e,t,n){var r=n(2225);e.exports=r},104:function(e,t,n){"use strict";var r=n(360),i=n(9),a=n(54),s=n(10),o=n(15),c=n(21),u=n(27),l=n(37),d=n(38),p=n(12),f=n(116),h=n(76),v=function(e){l(v,e);var t=d(v);function v(e,n){var r;return c(this,v),(r=t.call(this)).options=h.merge({},e),r.answers=o({},n),r}return u(v,[{key:"register",value:function(e,t){if(h.isObject(e)){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];this.register(i,e[i])}return this}p.equal(typeof t,"function","expected a function");var a=e.toLowerCase();return t.prototype instanceof this.Prompt?this.prompts[a]=t:this.prompts[a]=t(this.Prompt,this),this}},{key:"prompt",value:function(){var e=s(i.mark((function e(){var t,n,r,s,o=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.length>0&&void 0!==o[0]?o[0]:[],n=a([].concat(t)),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=20;break}if(s=r.value,e.prev=6,"function"!==typeof s){e.next=11;break}return e.next=10,s.call(this);case 10:s=e.sent;case 11:return e.next=13,this.ask(h.merge({},this.options,s));case 13:e.next=18;break;case 15:return e.prev=15,e.t0=e.catch(6),e.abrupt("return",Promise.reject(e.t0));case 18:e.next=4;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(2),n.e(e.t1);case 25:return e.prev=25,n.f(),e.finish(25);case 28:return e.abrupt("return",this.answers);case 29:case"end":return e.stop()}}),e,this,[[2,22,25,28],[6,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"ask",value:function(){var e=s(i.mark((function e(t){var n,r,a,s,o,c,u,l,d,f=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t){e.next=4;break}return e.next=3,t.call(this);case 3:t=e.sent;case 4:if(n=h.merge({},this.options,t),a=(r=t).type,s=r.name,o=h.set,c=h.get,"function"!==typeof a){e.next=11;break}return e.next=10,a.call(this,t,this.answers);case 10:a=e.sent;case 11:if(a){e.next=13;break}return e.abrupt("return",this.answers[s]);case 13:if(p(this.prompts[a],'Prompt "'.concat(a,'" is not registered')),u=new this.prompts[a](n),l=c(this.answers,s),u.state.answers=this.answers,u.enquirer=this,s&&u.on("submit",(function(e){f.emit("answer",s,e,u),o(f.answers,s,e)})),d=u.emit.bind(u),u.emit=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=f.emit).call.apply(e,[f].concat(n)),d.apply(void 0,n)},this.emit("prompt",u,this),!n.autofill||null==l){e.next=29;break}if(u.value=u.input=l,"show"!==n.autofill){e.next=27;break}return e.next=27,u.submit();case 27:e.next=32;break;case 29:return e.next=31,u.run();case 31:l=u.value=e.sent;case 32:return e.abrupt("return",l);case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"use",value:function(e){return e.call(this,this),this}},{key:"Prompt",get:function(){return this._Prompt||this.constructor.Prompt},set:function(e){this._Prompt=e}},{key:"prompts",get:function(){return this.constructor.prompts}}],[{key:"Prompt",get:function(){return this._Prompt||n(223)},set:function(e){this._Prompt=e}},{key:"prompts",get:function(){return n(2405)}},{key:"types",get:function(){return n(2425)}},{key:"prompt",get:function(){var e=this,t=function t(n){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];var o=r(e,a),c=o.emit.bind(o);return o.emit=function(){return t.emit.apply(t,arguments),c.apply(void 0,arguments)},o.prompt(n)};return h.mixinEmitter(t,new f),t}}]),v}(f);h.mixinEmitter(v,new f);for(var g=v.prompts,y=function(){var e=b[m],t=e.toLowerCase(),n=function(t){return new g[e](t).run()};v.prompt[t]=n,v[t]=n,v[e]||Reflect.defineProperty(v,e,{get:function(){return g[e]}})},m=0,b=Object.keys(g);m<b.length;m++)y();var k=function(e){h.defineExport(v,e,(function(){return v.types[e]}))};k("ArrayPrompt"),k("AuthPrompt"),k("BooleanPrompt"),k("NumberPrompt"),k("StringPrompt"),e.exports=v},110:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(42),i=n.n(r),a=n(12),s=n.n(a),o=i()("terminal:utils"),c=function(e,t){s.a.strictEqual(typeof e,"string"),s.a.strictEqual(typeof t,"string");var n=u(e);for(s()(n.includes(t),"invalid cwd: ".concat(t));n[0]!==t;)n.shift();n.shift();var r=n.shift();return o("nextPath",r),r},u=function(e){if("/"===e)return["/"];var t="",n=e.split("/").filter((function(e){return!!e}));return n.unshift("/"),n.map((function(e){return t&&"/"!==t&&(t+="/"),t+=e}))}},117:function(e,t,n){var r=n(15),i=n(858),a=n(550);e.exports=r(r({},i),a)},120:function(e,t,n){var r=n(15),i=n(12),a=n(117),s=n(41).standardize,o=n(102).integrityModel,c=s({schema:n(87).addressSchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.create(),t="UNKNOWN";if("GENESIS"===e)t="GENESIS_".concat(a.generateNonce()),e=o.create("GENESIS");else if("LOOPBACK"===e)t="LOOPBACK",e=o.create("LOOPBACK");else if("ROOT"===e)t="ROOT",e=o.create("ROOT");else if("INVALID"===e)t="INVALID",e=o.create("INVALID");else if("string"===typeof e){e.startsWith("TEST")&&(e=o.create("TEST").hash);var n=o.create(e);if(n.hash.length===e.length){var s=e;e=o.clone(r(r({},n),{},{hash:s})),t="RESOLVED"}else e=n}else e.isUnknown()||(t="RESOLVED");return i(o.isModel(e)),c.clone({chainId:e,status:t})},logicize:function(e){var t=e.chainId,n=e.status;return{getChainId:function(){if("LOOPBACK"===n)return"LOOPBACK";if("ROOT"===n)return"ROOT";if("RESOLVED"!==n)throw new Error("Tried to get chainId on address with status: ".concat(n));return t.hash},isRoot:function(){return"ROOT"===n},isLoopback:function(){return"LOOPBACK"===n},isGenesis:function(){return n.startsWith("GENESIS_")},isUnknown:function(){return"UNKNOWN"===n},isResolved:function(){return"RESOLVED"===n},isInvalid:function(){return"INVALID"===n}}}});e.exports={addressModel:c}},123:function(e,t,n){var r=n(2308).consistencySourceFactory,i=n(2314),a=i.toFunctions,s=i.fromFunctions,o=n(281).ramDynamoDbFactory,c=n(392).ramS3Factory,u=n(580).s3Keys,l=n(579).dbFactory;e.exports={consistencyFactory:function(e,t,n){var i=r(e,t,n);return s(i)},toFunctions:a,ramDynamoDbFactory:o,ramS3Factory:c,consistencySourceFactory:r,s3Keys:u,dbFactory:l}},127:function(e,t,n){"use strict";var r=n(64),i=(n(0),n(78),n(246)),a=n(42),s=n.n(a),o=(n(2481),n(12),n(110)),c=n(13),u=s()("terminal:Explorer"),l=function(e,t){if(t[e])return u("widget found for ".concat(e)),t[e];for(var n in t){if(n.endsWith("*"))if(n===e.substring(0,e.lastIndexOf("/"))+"/*")return u("regex widget found for ".concat(e," by matching ").concat(n)),t[n]}};t.a=function e(t){var n=t.path,a=t.cwd,s=void 0===a?"/":a,d=t.widgets,p=void 0===d?{}:d;u("path: %s cwd: %s",n,s);var f=Object(i.a)(s);if(!f)return null;var h=l(s,p);if(h)return Object(c.jsx)(h,{block:f,path:n,cwd:s,widgets:p});var v=Object(o.a)(n,s);if(!v)return null;var g=v.split("/").pop(),y=f.network[g].address.getChainId(),m=Object(r.a)(Object(r.a)({},t),{},{cwd:v,chainId:y});return v?Object(c.jsx)(e,Object(r.a)({},m)):null}},150:function(e,t,n){"use strict";var r=n(9),i=n(10),a=n(21),s=n(27),o=n(66),c=n(59),u=n(37),l=n(38),d=n(284),p=n(76),f=function(e){u(n,e);var t=l(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).emptyError=r.options.emptyError||"No items were selected",r}return s(n,[{key:"dispatch",value:function(){var e=i(r.mark((function e(t,i){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.multiple){e.next=11;break}if(!this[i.name]){e.next=7;break}return e.next=4,this[i.name](t,i);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,o(c(n.prototype),"dispatch",this).call(this,t,i);case 9:e.t0=e.sent;case 10:return e.abrupt("return",e.t0);case 11:this.alert();case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"separator",value:function(){if(this.options.separator)return o(c(n.prototype),"separator",this).call(this);var e=this.styles.muted(this.symbols.ellipsis);return this.state.submitted?o(c(n.prototype),"separator",this).call(this):e}},{key:"pointer",value:function(e,t){return!this.multiple||this.options.pointer?o(c(n.prototype),"pointer",this).call(this,e,t):""}},{key:"indicator",value:function(e,t){return this.multiple?o(c(n.prototype),"indicator",this).call(this,e,t):""}},{key:"choiceMessage",value:function(e,t){var n=this.resolve(e.message,this.state,e,t);return"heading"!==e.role||p.hasColor(n)||(n=this.styles.strong(n)),this.resolve(n,this.state,e,t)}},{key:"choiceSeparator",value:function(){return":"}},{key:"renderChoice",value:function(){var e=i(r.mark((function e(t,n){var i,a,s,o,c,u,l,d=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return i=this.index===n,e.next=5,this.pointer(t,n);case 5:return a=e.sent,e.next=8,this.indicator(t,n);case 8:return e.t0=e.sent,e.t1=t.pad||"",s=e.t0+e.t1,e.next=13,this.resolve(t.hint,this.state,t,n);case 13:return(o=e.sent)&&!p.hasColor(o)&&(o=this.styles.muted(o)),c=this.indent(t),e.next=18,this.choiceMessage(t,n);case 18:if(u=e.sent,l=function(){return[d.margin[3],c+a+s,u,d.margin[1],o].filter(Boolean).join(" ")},"heading"!==t.role){e.next=22;break}return e.abrupt("return",l());case 22:if(!t.disabled){e.next=25;break}return p.hasColor(u)||(u=this.styles.disabled(u)),e.abrupt("return",l());case 25:return i&&(u=this.styles.em(u)),e.abrupt("return",l());case 27:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoices",value:function(){var e=i(r.mark((function e(){var t,n,a,s,o=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("choices"!==this.state.loading){e.next=2;break}return e.abrupt("return",this.styles.warning("Loading choices"));case 2:if(!this.state.submitted){e.next=4;break}return e.abrupt("return","");case 4:return t=this.visible.map(function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.renderChoice(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=7,Promise.all(t);case 7:if((n=e.sent).length||n.push(this.styles.danger("No matching choices")),a=this.margin[0]+n.join("\n"),!this.options.choicesHeader){e.next=14;break}return e.next=13,this.resolve(this.options.choicesHeader,this.state);case 13:s=e.sent;case 14:return e.abrupt("return",[s,a].filter(Boolean).join("\n"));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"format",value:function(){var e=this;return!this.state.submitted||this.state.cancelled?"":Array.isArray(this.selected)?this.selected.map((function(t){return e.styles.primary(t.name)})).join(", "):this.styles.primary(this.selected.name)}},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s,o,c,u,l,d,p,f;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.submitted,i=t.size,a="",e.next=4,this.header();case 4:return s=e.sent,e.next=7,this.prefix();case 7:return o=e.sent,e.next=10,this.separator();case 10:return c=e.sent,e.next=13,this.message();case 13:return u=e.sent,!1!==this.options.promptLine&&(a=[o,u,c,""].join(" "),this.state.prompt=a),e.next=17,this.format();case 17:return l=e.sent,e.next=20,this.error();case 20:if(e.t0=e.sent,e.t0){e.next=25;break}return e.next=24,this.hint();case 24:e.t0=e.sent;case 25:return d=e.t0,e.next=28,this.renderChoices();case 28:return p=e.sent,e.next=31,this.footer();case 31:f=e.sent,l&&(a+=l),d&&!a.includes(d)&&(a+=" "+d),n&&!l&&!p.trim()&&this.multiple&&null!=this.emptyError&&(a+=this.styles.danger(this.emptyError)),this.clear(i),this.write([s,a,p,f].filter(Boolean).join("\n")),this.write(this.margin[2]),this.restore();case 39:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(d);e.exports=f},173:function(e,t,n){var r=n(15),i=(0,n(41).standardize)({schema:n(87).actionSchema,create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"===typeof e)throw new Error("Actions cannot be undefined");return"string"===typeof e&&(e={type:e,payload:t}),e.payload||(e=r(r({},e),{},{payload:{}})),i.clone(e)},logicize:function(e){return{}}});e.exports={actionModel:i}},174:function(e,t,n){var r,i=n(34),a=n(9),s=n(15),o=n(10),c=n(12),u=(n(51),n(18)("interblock:models:provenance"),n(41).standardize),l=n(102).integrityModel,d=n(175).keypairModel,p=n(120).addressModel,f=n(87).provenanceSchema,h=n(117),v=d.create("PIERCE",h.pierceKeypair),g=d.create("CI",h.ciKeypair),y=function(e){return c(l.isModel(e)),g.sign(e)},m=u({schema:f,create:function(e,t){var i=arguments;return o(a.mark((function o(){var u,d,f,h,v,g,b,k,x,w,I;return a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return u=i.length>2&&void 0!==i[2]?i[2]:{},d=i.length>3&&void 0!==i[3]?i[3]:y,r||(r=n(269).dmzModel,c(r)),e=e||r.create(),c(r.isModel(e)),c(!t||m.isModel(t)),c.strictEqual(typeof u,"object"),c(Object.values(u).every(l.isModel)),c(!Object.keys(u).length||t),dmzIntegrity=l.create(e.getHash()),h=0,v=s({},u),t&&(g=t.reflectIntegrity(),c(!Object.values(v).some((function(e){return e.equals(g)}))),v[t.height]=g,h=t.height+1,f=t.getAddress()),b={dmzIntegrity:dmzIntegrity,address:f||p.create("GENESIS"),lineage:v,height:h},k=l.create(b),a.next=17,d(k);case 17:return x=a.sent,w=[x],I=m.clone(s(s({},b),{},{integrity:k,signatures:w})),a.abrupt("return",I);case 21:case"end":return a.stop()}}),o)})))()},logicize:function(e){if(e.dmzIntegrity.isUnknown())throw new Error("Dmz not a genuine type of integrity: ".concat(e.dmzIntegrity.hash));var t=Object.keys(e.lineage).map((function(e){return parseInt(e)}));c(t.length||e.address.isGenesis()),c(e.height||e.address.isGenesis()),c(t.every((function(t){return t>=0&&t<e.height}))),c.strictEqual(e.signatures.length,1,"single signer only");if(!function(){var t={};["dmzIntegrity","address","lineage","height"].forEach((function(n){return t[n]=e[n]}));var n=l.create(t).equals(e.integrity);return n}())throw new Error("Self integrity degraded - refusing to instantiate");if(!e.signatures.length||!e.signatures.every((function(t){return t.integrity.equals(e.integrity)})))throw new Error("Signature degraded - refusing to instantiate");var n=l.create(e),r=e.address;0===e.height&&(c(r.isGenesis()),r=p.create(n));var a=function(){return n};return{merge:function(){},getAddress:function(){return r},reflectIntegrity:a,isNext:function(t){var n=Object.values(t.lineage).some((function(e){return e.equals(a())})),r=t.height>e.height;t.signatures[0].publicKey;return n&&r},getShortestHeight:function(){var n=i(t);n.sort((function(e,t){return e-t}));var r=n.shift();return c(r>=0&&r<e.height),r}}}});e.exports={provenanceModel:m,ciSigner:y,pierceSigner:function(e){return c(l.isModel(e)),v.sign(e)}}},175:function(e,t,n){var r=n(9),i=n(10),a=n(80),s=n(12),o=n(18)("interblock:models:keypair"),c=n(117),u=n(41).standardize,l=n(216).publicKeyModel,d=n(102).integrityModel,p=n(374).signatureModel,f=u({schema:{title:"Keypair",description:"public private key pair",type:"object",additionalProperties:!1,required:["name","publicKey","secretKey","algorithm"],properties:{name:{type:"string"},publicKey:l.schema,secretKey:{type:"string"},algorithm:{enum:["tweetnacl","sodium"]}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CI",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.ciKeypair;s.strictEqual(typeof e,"string");var n=l.clone({key:t.publicKey,algorithm:"sodium"}),r=t.secretKey;return f.clone({name:e,publicKey:n,secretKey:r,algorithm:"sodium"})},logicize:function(e){var t={publicKey:e.publicKey.key,secretKey:e.secretKey};if(!c.verifyKeyPairSync(t))throw new Error("Not a valid keypair - refusing to instantiate");return{sign:function(){var t=i(r.mark((function t(n){var i,a,u,l,f,h,v,g;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o("sign"),n){t.next=3;break}throw new Error("Refusing to sign undefined integrity");case 3:return n=d.clone(n),i=n.hash,a=e.publicKey,u=e.secretKey,t.next=8,c.signHash(i,u);case 8:return l=t.sent,f=l.signature,t.next=12,c.verifyHash(i,f,a.key);case 12:return h=t.sent,s(h),s(c.verifyHashSync(i,f,a.key)),v={publicKey:a,integrity:n,seal:f},g=p.clone(v),o("sign complete"),t.abrupt("return",g);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getValidatorEntry:function(){return a({},e.name,e.publicKey)}}}});e.exports={keypairModel:f}},179:function(e,t,n){"use strict";var r=n(9),i=n(10),a=n(21),s=n(27),o=n(66),c=n(59),u=n(37),l=n(38),d=n(223),p=n(595),f=n(76).isPrimitive,h=function(e){u(n,e);var t=l(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).initial=f(r.initial)?String(r.initial):"",r.initial&&r.cursorHide(),r.state.prevCursor=0,r.state.clipboard=[],r}return s(n,[{key:"keypress",value:function(){var e=i(r.mark((function e(t){var i,a,s=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>1&&void 0!==s[1]?s[1]:{},a=this.state.prevKeypress,this.state.prevKeypress=i,!0!==this.options.multiline||"return"!==i.name){e.next=6;break}if(a&&"return"===a.name){e.next=6;break}return e.abrupt("return",this.append("\n",i));case 6:return e.abrupt("return",o(c(n.prototype),"keypress",this).call(this,t,i));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"moveCursor",value:function(e){this.cursor+=e}},{key:"reset",value:function(){return this.input=this.value="",this.cursor=0,this.render()}},{key:"dispatch",value:function(e,t){if(!e||t.ctrl||t.code)return this.alert();this.append(e)}},{key:"append",value:function(e){var t=this.state,n=t.cursor,r=t.input;this.input="".concat(r).slice(0,n)+e+"".concat(r).slice(n),this.moveCursor(String(e).length),this.render()}},{key:"insert",value:function(e){this.append(e)}},{key:"delete",value:function(){var e=this.state,t=e.cursor,n=e.input;if(t<=0)return this.alert();this.input="".concat(n).slice(0,t-1)+"".concat(n).slice(t),this.moveCursor(-1),this.render()}},{key:"deleteForward",value:function(){var e=this.state,t=e.cursor,n=e.input;if(void 0===n[t])return this.alert();this.input="".concat(n).slice(0,t)+"".concat(n).slice(t+1),this.render()}},{key:"cutForward",value:function(){var e=this.cursor;if(this.input.length<=e)return this.alert();this.state.clipboard.push(this.input.slice(e)),this.input=this.input.slice(0,e),this.render()}},{key:"cutLeft",value:function(){var e=this.cursor;if(0===e)return this.alert();var t=this.input.slice(0,e),n=this.input.slice(e),r=t.split(" ");this.state.clipboard.push(r.pop()),this.input=r.join(" "),this.cursor=this.input.length,this.input+=n,this.render()}},{key:"paste",value:function(){if(!this.state.clipboard.length)return this.alert();this.insert(this.state.clipboard.pop()),this.render()}},{key:"toggleCursor",value:function(){this.state.prevCursor?(this.cursor=this.state.prevCursor,this.state.prevCursor=0):(this.state.prevCursor=this.cursor,this.cursor=0),this.render()}},{key:"first",value:function(){this.cursor=0,this.render()}},{key:"last",value:function(){this.cursor=this.input.length-1,this.render()}},{key:"next",value:function(){var e=null!=this.initial?String(this.initial):"";if(!e||!e.startsWith(this.input))return this.alert();this.input=this.initial,this.cursor=this.initial.length,this.render()}},{key:"prev",value:function(){if(!this.input)return this.alert();this.reset()}},{key:"backward",value:function(){return this.left()}},{key:"forward",value:function(){return this.right()}},{key:"right",value:function(){return this.cursor>=this.input.length?this.alert():(this.moveCursor(1),this.render())}},{key:"left",value:function(){return this.cursor<=0?this.alert():(this.moveCursor(-1),this.render())}},{key:"isValue",value:function(e){return!!e}},{key:"format",value:function(){var e=i(r.mark((function e(){var t,n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:this.value,e.next=3,this.resolve(this.initial,this.state);case 3:if(n=e.sent,this.state.submitted){e.next=6;break}return e.abrupt("return",p(this,{input:t,initial:n,pos:this.cursor}));case 6:return e.abrupt("return",this.styles.submitted(t||n));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s,o,c,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.size,e.next=3,this.prefix();case 3:return n=e.sent,e.next=6,this.separator();case 6:return i=e.sent,e.next=9,this.message();case 9:return a=e.sent,s=[n,a,i].filter(Boolean).join(" "),this.state.prompt=s,e.next=14,this.header();case 14:return o=e.sent,e.next=17,this.format();case 17:return c=e.sent,e.next=20,this.error();case 20:if(e.t0=e.sent,e.t0){e.next=25;break}return e.next=24,this.hint();case 24:e.t0=e.sent;case 25:return u=e.t0,e.next=28,this.footer();case 28:l=e.sent,u&&!c.includes(u)&&(c+=" "+u),s+=" "+c,this.clear(t),this.write([o,s,l].filter(Boolean).join("\n")),this.restore();case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(d);e.exports=h},192:function(e,t,n){"use strict";(function(e){var r=n(82),i=n(2941),a=n(2948),s=n(2942),o=(n(0),n(42)),c=n.n(o),u=(n(127),n(73)),l=n(13),d=(c()("terminal:widgets:OpenDialog"),Object(u.a)({root:{position:"absolute"},backdrop:{position:"absolute"}}));t.a=function(t){var n=t.title,o=t.children,c=d(),u=document.getElementById("DUI"),p=!u.contains(document.activeElement);return Object(l.jsxs)(a.a,{scroll:"body",maxWidth:"xl",container:u,onClose:function(){var t,n=Object(r.a)("cd ..\n");try{for(n.s();!(t=n.n()).done;){var i=t.value;e.stdin.send(i)}}catch(a){n.e(a)}finally{n.f()}},"aria-labelledby":"simple-dialog-title",open:!0,BackdropProps:{classes:{root:c.backdrop}},style:{position:"absolute"},disableEnforceFocus:!0,disableRestoreFocus:p,disableAutoFocus:p,children:[Object(l.jsx)(i.a,{id:"simple-dialog-title",children:n}),Object(l.jsx)(s.a,{dividers:!0,children:o})]})}}).call(this,n(20))},215:function(e,t,n){var r=n(121),i=n(9),a=n(10),s=n(34),o=n(15),c=n(12),u=n(18)("interblock:models:block"),l=n(41).standardize,d=n(174).provenanceModel,p=n(175).keypairModel,f=n(269).dmzModel,h=n(102).integrityModel,v=f.schema,g=o(o({},v),{},{title:"Block",description:"The fundamental unit of state persistence and transmission\nA DMZ with a 'provenance' key is a block.",required:[].concat(s(v.required),["provenance"]),properties:o(o({},v.properties),{},{provenance:d.schema})}),y=function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.create("CI");case 2:return n=e.sent,c(h.isModel(t)),e.abrupt("return",n.sign(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=l({schema:g,create:function(e){var t=arguments;return a(i.mark((function n(){var r,a,s,l;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:y,u("create"),c("function"===typeof r),e=f.clone(e),void 0,a={},n.next=8,d.create(e,undefined,a,r);case 8:return s=n.sent,l=m.clone(o(o({},e),{},{provenance:s})),n.abrupt("return",l);case 11:case"end":return n.stop()}}),n)})))()},logicize:function(e){var t=e.network.getAliases().some((function(t){var n=e.network[t].address;return e.provenance.getAddress().equals(n)}));c(!t,"Loop detected");var n=e.provenance,i=r(e,["provenance"]),a=f.clone(i),s=a.getHash();c(s===n.dmzIntegrity.hash);return{isValidated:function(){if(n.address.isGenesis())return!0;var e=a.validators,t=Object.values(e),r=n.signatures.map((function(e){return e.publicKey})),i=t.every((function(e){return r.some((function(t){return t.equals(e)}))})),s=r.every((function(e){return t.some((function(t){return t.equals(e)}))}));return i&&s},getDmz:function(){return a},whoami:function(e,t){c(m.isModel(t)),e.forEach((function(e){publicKeyModel.clone(e)}))},isNext:function(t){var n=m.isModel(t),r=t.isValidated(),i=e.provenance.isNext(t.provenance);return n&&r&&i},getChainId:function(){return e.provenance.getAddress().getChainId()},getHeight:function(){return e.provenance.height}}}});e.exports={blockModel:m}},216:function(e,t,n){var r=(0,n(41).standardize)({schema:n(87).publicKeySchema,create:function(){throw new Error("Only the keypairModel can create publicKeyModel types")},logicize:function(e){return{}}});e.exports={publicKeyModel:r}},217:function(e,t,n){var r=n(25).covenantIdModel,i=n(948);i.covenantId=r.create("collection");var a=n(552),s=n(571);s.covenantId=r.create("dpkg");var o=n(2297);o.covenantId=r.create("shell");var c=n(572);c.covenantId=r.create("net");var u=n(573);u.covenantId=r.create("socket");var l=n(2300);l.covenantId=r.create("hyper");var d={reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}};d.covenantId=r.create("unity");var p=n(2301);p.covenantId=r.create("probe"),e.exports={collection:i,datum:a,dpkg:s,hyper:l,net:c,probe:p,shell:o,socket:u,unity:d},Object.values(e.exports).forEach(Object.freeze)},222:function(e,t,n){var r=n(12),i=(0,n(41).standardize)({schema:n(87).continuationSchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.clone({type:e,payload:t})},logicize:function(e){"@@PROMISE"===e.type&&r.strictEqual(Object.keys(e.payload).length,0,"Promises cannot have payloads");return{isPromise:function(){return"@@PROMISE"===e.type},isRejection:function(){return"@@REJECT"===e.type},isResolve:function(){return"@@RESOLVE"===e.type}}}});e.exports={continuationModel:i}},2225:function(e,t,n){var r=n(9),i=n(15),a=n(10),s=n(12),o=n(18)("interblock:dmz"),c=(n(51),n(2226)),u=c.openChildReducer,l=c.openChildReply,d=c.openPaths,p=n(560),f=p.uplinkReducer,h=p.uplinkReply,v=n(561),g=v.connect,y=v.connectReducer,m=n(2232),b=m.ping,k=m.pingReducer,x=n(562),w=x.spawn,I=x.spawnReducer,C=n(2233),M=C.listChildren,R=C.listChildrenReducer,E=n(2234),P=E.install,O=E.deploy,A=E.deployReducer,q=E.deployReply,j=n(2235),S=j.getChannel,T=j.getChannelReducer,D=n(2236),L=D.genesisReducer,N=D.genesisReply,z=n(2237),_=z.getStateReducer,B=z.getState,K=n(25),F=K.dmzModel,H=K.rxRequestModel,G=K.rxReplyModel,U={connect:g,ping:b,spawn:w,listChildren:M,install:P,deploy:O,getChannel:S,getState:B},V=function(){var e=a(r.mark((function e(t,n){var a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o("reducer( ".concat(n.type," )")),s(F.isModel(t)),s(G.isModel(n)||H.isModel(n)),a=t.network,e.t0=n.type,e.next="@@PING"===e.t0?7:"@@SPAWN"===e.t0?9:"@@CONNECT"===e.t0?13:"@@UPLINK"===e.t0?15:"@@GENESIS"===e.t0?17:"@@OPEN_CHILD"===e.t0?19:"@@LS"===e.t0?21:"@@INTRO"===e.t0?23:"@@ACCEPT"===e.t0?24:"@@INSTALL"===e.t0||"@@DEPLOY"===e.t0?25:"@@GET_CHAN"===e.t0?29:"@@CAT"===e.t0?31:"@@RESOLVE"===e.t0||"@@REJECT"===e.t0?33:45;break;case 7:return k(n),e.abrupt("break",46);case 9:return e.next=11,I(t,n);case 11:return a=e.sent,e.abrupt("break",46);case 13:return a=y(a,n),e.abrupt("break",46);case 15:return a=f(a,n),e.abrupt("break",46);case 17:return L(a,n),e.abrupt("break",46);case 19:return u(a,n),e.abrupt("break",46);case 21:return R(a),e.abrupt("break",46);case 23:case 24:return e.abrupt("break",46);case 25:return e.next=27,A(t,n);case 27:return a=e.sent,e.abrupt("break",46);case 29:return T(a,n),e.abrupt("break",46);case 31:return _(t),e.abrupt("break",46);case 33:e.t1=n.getRequest().type,e.next="@@GENESIS"===e.t1?36:"@@UPLINK"===e.t1?38:"@@OPEN_CHILD"===e.t1?40:"@@DEPLOY"===e.t1?42:44;break;case 36:return N(n),e.abrupt("break",44);case 38:return h(a,n),e.abrupt("break",44);case 40:return a=l(a,n),e.abrupt("break",44);case 42:return q(a,n),e.abrupt("break",44);case 44:return e.abrupt("break",46);case 45:throw new Error("Unrecognized type: ".concat(n.type));case 46:return e.abrupt("return",i(i({},t),{},{network:a}));case 47:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=["@@PING","@@SPAWN","@@GENESIS","@@CONNECT","@@UPLINK","@@INTRO","@@ACCEPT","@@OPEN_CHILD","@@LS","@@GET_GIVEN_NAME","@@DEPLOY","@@INSTALL","@@GET_CHAN","@@CAT"],J=["@@INIT","@@GENESIS","@@UPLINK","@@OPEN_CHILD","@@DEPLOY"];e.exports={actions:U,reducer:V,isSystemRequest:function(e){if(!H.isModel(e))return!1;var t=W.includes(e.type);return o("isSystemAction: ".concat(t," type: ").concat(e.type)),t},isSystemReply:function(e){if(!G.isModel(e))return!1;var t=e.getRequest(),n=J.includes(t.type);return o("isSystemReply: ".concat(n," type: ").concat(t.type)),n},openPaths:d}},2226:function(e,t,n){var r=n(75),i=n(80),a=n(15),s=n(12),o=n(74),c=n(18)("interblock:dmz:openChild"),u=n(25),l=u.actionModel,d=u.networkModel,p=u.rxRequestModel,f=u.rxReplyModel,h=n(88).channelProducer,v=n(55),g=v.replyPromise,y=(v.replyResolve,v.replyReject),m=(v.isReplyFor,v.effectInBand,v.interchain),b=n(560).uplink,k=n(561).connect,x=function(e,t,n){return{type:"@@OPEN_CHILD",payload:{child:e,parent:t,fullPath:n}}},w=function(e,t){return e.getOutboundPairs().some((function(e){var n=r(e,2),i=n[0],a=n[1];if((!a||a.isPromise())&&"@@OPEN_CHILD"===i.type)return i.payload.fullPath===t}))},I=function(e){var t="";return e.split("/").map((function(e){return t&&(t+="/"),t+=e}))};e.exports={openChild:x,openChildReducer:function(e,t){s(p.isModel(t));var n=t.payload,r=n.child,i=n.parent,a=n.fullPath;s.strictEqual(typeof r,"string"),c("reducer child: %o parent: %o fullPath: %o",r,i,a);var o=e[r];if(o)if(o.address.isUnknown())y(new Error("Alias unresolved: ".concat(r)));else if("./"!==o.systemRole)y(new Error("Alias found, but is not child: ".concat(r)));else{var u=t.getAddress().getChainId(),l=b(u,t);m(l,r),g()}else y(new Error("Alias not found: ".concat(r)))},openChildReply:function(e,t){s(d.isModel(e)),s(f.isModel(t));var n=t.request.payload,r=n.child,u=n.parent,l=n.fullPath;switch(s.strictEqual(typeof l,"string"),t.type){case"@@RESOLVE":var p=t.payload.chainId;c("reply received for @@OPEN_CHILD: %o",p.substring(0,9));var v=u+"/"+r;c("connecting to: ",v),m(k(v,p));break;case"@@REJECT":c("reject child: %o parent: %o fullPath: %o",r,u,l);var g=o.normalize(l);s.strictEqual(g,l);var y=h.invalidate(e[l]);e=d.clone(a(a({},e),{},i({},l,y)));break;default:throw new Error("Invalid action type: ".concat(t.type))}return e},openPaths:function(e){s(d.isModel(e));var t={};return e.getAliases().filter((function(t){return e[t].address.isUnknown()})).forEach((function(n){if(".@@io"!==n&&n.includes("/")){var r=I(n);s(r.length>1),r.some((function(i,a){var o=e[i];if(!o||o.address.isUnknown()){if(c("unresolved path: ",i),0===a&&!e[i])return t[n]=h.invalidate(e[n]),!0;var u=0===a?".":r[a-1];c("parent: ",u);var d=i.split("/").pop();if(c("child: ",d),w(e[u]))c("parent: %o was already asked to open child: %o",u,d);else{var p=e[u].address.isResolved();s(p,"unresolved parent attempted: ".concat(u)),c("sending open action from parent: %o to %o",u,d);var f=l.create(x(d,u,n));t[u]=h.txRequest(e[u],f)}return!0}}))}})),d.merge(e,t)}}},2227:function(e,t,n){var r=n(80),i=n(15),a=n(34),s=n(54),o=n(12),c=n(74),u=n(18)("interblock:producers:network"),l=n(51),d=n(25),p=d.channelModel,f=d.continuationModel,h=d.actionModel,v=d.networkModel,g=d.interblockModel,y=d.addressModel,m=d.rxRequestModel,b=d.txRequestModel,k=d.txReplyModel,x=d.configModel,w=n(556),I=function(e,t,n){o(m.isModel(t)),o(f.isModel(n));var i=t.getAddress(),a=e.getAlias(i),s=e[a];o(p.isModel(s)),o(s.address.equals(i)),o(s.rxRequest().equals(t));var c=t.getIndex();o(!s.replies[c]);var u=w.txReply(s,n);return o(u.replies[c]),v.merge(e,r({},a,u))},C=function(e,t){return Array.isArray(e)||(e=[e]),e.map(t)},M=function(e){var t=new Map;return e.forEach((function(e){var n=e.provenance.getAddress();t.get(n)||t.set(n,new Map);var r=t.get(n),i=e.provenance.height;r.has(i)?e.getOriginAlias()&&r.set(i,e):r.set(i,e)})),t};e.exports={ingestInterblocks:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;t=C(t,g.clone),o(x.isModel(n));var r,c=M(t),d={},f=s(c.keys());try{for(f.s();!(r=f.n()).done;){var y=r.value,m=e.getAlias(y),b=n.isPublicChannelOpen,k=a(c.get(y).values()),I=k[0];if(!m&&b&&I.isConnectionAttempt()){u("connection attempt accepted");var R="@@PUBLIC_".concat(y.getChainId()),E=p.create(y),P=h.create({type:"@@ACCEPT"}),O=p.clone(i(i({},E),{},{requests:{0:P}}));d[R]=O}if(m){var A=d[m]||e[m];if(o(p.isModel(A)),A=w.ingestInterblocks(A,k),I.isConnectionResponse(),!A.heavy||A.equals(e[m]))continue;d[m]=A}}}catch(q){f.e(q)}finally{f.f()}return e.getAliases().forEach((function(t){var n=e[t];if(n&&n.address.isResolved()&&n.heavy){var r=d[t]||n,s=n.lineageTip.slice(0,-1),c=l.without.apply(l,[r.lineageTip].concat(a(s))),u=r.lineage.findIndex((function(e){return e.equals(r.heavy.provenance.reflectIntegrity())})),f=r.lineage.findIndex((function(e){return e.equals(c[0].provenance.reflectIntegrity())})),h=u<f?u:f;o(h>=0,"minIndex out of bounds");var v=r.lineage.slice(h);(r=p.clone(i(i({},r),{},{lineage:v,lineageTip:c}))).equals(n)||(d[t]=r)}})),v.merge(e,d)},respondRejection:function(e,t,n){u("respondRejection %O",n);var r=f.create("@@REJECT",n);return I(e,t,r)},respondRequest:function(e,t){u("respondRequest request: %o",t.type);var n=f.create("@@RESOLVE");return I(e,t,n)},respondReply:function(e,t,n){o(y.isModel(t)),o(p.isModel(n));var i=e.getAlias(t);u("respondReply alias: ".concat(i));var a=e[i],s=w.shiftTxRequest(a,n);return v.merge(e,r({},i,s))},tx:function(e,t,n){o(v.isModel(e)),o(Array.isArray(t)),o(Array.isArray(n)),u("tx requests: ".concat(t.length," replies: ").concat(n.length));var r={};return t.forEach((function(t){o(b.isModel(t));var n=t.to;n=c.normalize(n),e[".."].address.isRoot()&&n.startsWith("/")&&(n=(n=n.substring(1))||".");var i=r[n]||e[n];if(!i){var a=".@@io"===n?"PIERCE":"DOWN_LINK",s=y.create();i=p.create(s,a),u("channel created with systemRole: ".concat(a))}r[n]=w.txRequest(i,t.getRequest())})),n.forEach((function(t){o(k.isModel(t));var n=t.getAddress(),i=t.getIndex(),a=e.getAlias(n);if(a){var s=r[a]||e[a],c=t.getReply();r[a]=w.txReply(s,c,i)}else u("No alias found for: %O",t)})),v.merge(e,r)},invalidateLocal:function(e){var t,n={},r=e.getAliases(),i=s(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(".@@io"!==a)!a.includes("/")&&e[a].address.isUnknown()&&(n[a]=w.invalidate(e[a]))}}catch(o){i.e(o)}finally{i.f()}return v.merge(e,n)},reaper:function(e){var t,n,r=e.getAliases(),a=!1,c=s(r);try{for(c.s();!(n=c.n()).done;){var u=n.value,l=e[u];l.address.isInvalid()&&(o(!l.rxRequest()),l.rxReply()||(a=!0,t||(t=i({},e)),delete t[u]))}}catch(d){c.e(d)}finally{c.f()}return a?v.clone(t):e},removeBufferPromise:function(e,t){o(v.isModel(e)),o(m.isModel(t));var n=t.getIndex(),a=t.getAddress(),s=e.getAlias(a),c=e[s],u=i({},c.replies);o(u[n].isPromise()),delete u[n];var l=p.clone(i(i({},c),{},{replies:u}));return v.clone(i(i({},e),{},r({},s,l)))}}},2228:function(e,t,n){var r=n(15),i=n(9),a=n(10),s=n(12),o=n(25),c=o.dmzModel,u=o.keypairModel,l=o.provenanceModel,d=o.blockModel,p=o.integrityModel,f=function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.create("CI"),s(p.isModel(t)),e.abrupt("return",n.sign(t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=a(i.mark((function e(t,n){var a,o,u,h,v,g,y,m,b,k=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=k.length>2&&void 0!==k[2]?k[2]:f,s(c.isModel(t)),s(d.isModel(n)),s(!t.equals(n.getDmz()),"block dmz has not changed"),s("function"===typeof a),o=t.network.isNewChannels(n.network),u={},h=0===n.provenance.height,o&&!h&&(v=p.create(),g=n.provenance.getAddress().getChainId(),y=p.clone(r(r({},v),{},{hash:g})),u[0]=y),e.next=11,l.create(t,n.provenance,u,a);case 11:return m=e.sent,b=d.clone(r(r({},t),{},{provenance:m})),s(n.isNext(b)),e.abrupt("return",b);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={generateNext:h}},2229:function(e,t,n){var r=n(15),i=n(12),a=n(25),s=a.lockModel,o=a.blockModel;e.exports={reconcile:function(e,t){i(s.isModel(e)),i(o.isModel(t));return s.clone(r(r({},e),{},{block:t,piercings:{requests:[],replies:[]},interblocks:[]}))}}},223:function(e,t,n){"use strict";(function(t){var r=n(9),i=n(10),a=n(21),s=n(27),o=n(169),c=n(37),u=n(38),l=n(116),d=n(105),p=n(2396),f=n(2399),h=n(2400),v=n(2401),g=n(76),y=n(2404),m=function(e){c(l,e);var n=u(l);function l(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(this,l),(e=n.call(this)).name=r.name,e.type=r.type,e.options=r,v(o(e)),f(o(e)),e.state=new h(o(e)),e.initial=[r.initial,r.default].find((function(e){return null!=e})),e.stdout=r.stdout||t.stdout,e.stdin=r.stdin||t.stdin,e.scale=r.scale||1,e.term=e.options.term||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).TERM_PROGRAM,e.margin=k(e.options.margin),e.setMaxListeners(0),b(o(e)),e}return s(l,[{key:"keypress",value:function(){var e=i(r.mark((function e(t){var n,i,a,s=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:{},this.keypressed=!0,i=p.action(t,p(t,n),this.options.actions),this.state.keypress=i,this.emit("keypress",t,i),this.emit("state",this.state.clone()),"function"!==typeof(a=this.options[i.action]||this[i.action]||this.dispatch)){e.next=11;break}return e.next=10,a.call(this,t,i);case 10:return e.abrupt("return",e.sent);case 11:this.alert();case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"alert",value:function(){delete this.state.alert,!1===this.options.show?this.emit("alert"):this.stdout.write(y.code.beep)}},{key:"cursorHide",value:function(){var e=this;this.stdout.write(y.cursor.hide()),g.onExit((function(){return e.cursorShow()}))}},{key:"cursorShow",value:function(){this.stdout.write(y.cursor.show())}},{key:"write",value:function(e){e&&(this.stdout&&!1!==this.state.show&&this.stdout.write(e),this.state.buffer+=e)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.state.buffer;this.state.buffer="",(t||e)&&!1!==this.options.show&&this.stdout.write(y.cursor.down(e)+y.clear(t,this.width))}},{key:"restore",value:function(){if(!this.state.closed&&!1!==this.options.show){var e=this.sections(),t=e.prompt,n=e.after,r=e.rest,i=this.cursor,a=this.initial,s=void 0===a?"":a,o=this.input,c=void 0===o?"":o,u=this.value,l=void 0===u?"":u,d={after:n,cursor:i,initial:s,input:c,prompt:t,size:this.state.size=r.length,value:l},p=y.cursor.restore(d);p&&this.stdout.write(p)}}},{key:"sections",value:function(){var e=this.state,t=e.buffer,n=e.input,r=e.prompt;r=d.unstyle(r);var i=d.unstyle(t),a=i.indexOf(r),s=i.slice(0,a),o=i.slice(a).split("\n"),c=o[0],u=o[o.length-1],l=(r+(n?" "+n:"")).length,p=l<c.length?c.slice(l+1):"";return{header:s,prompt:c,after:p,rest:o.slice(1),last:u}}},{key:"submit",value:function(){var e=i(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.submitted=!0,this.state.validating=!0,!this.options.onSubmit){e.next=5;break}return e.next=5,this.options.onSubmit.call(this,this.name,this.value,this);case 5:if(e.t0=this.state.error,e.t0){e.next=10;break}return e.next=9,this.validate(this.value,this.state);case 9:e.t0=e.sent;case 10:if(!0===(t=e.t0)){e.next=23;break}return n="\n"+this.symbols.pointer+" ",n+="string"===typeof t?t.trim():"Invalid input",this.state.error="\n"+this.styles.danger(n),this.state.submitted=!1,e.next=18,this.render();case 18:return e.next=20,this.alert();case 20:return this.state.validating=!1,this.state.error=void 0,e.abrupt("return");case 23:return this.state.validating=!1,e.next=26,this.render();case 26:return e.next=28,this.close();case 28:return e.next=30,this.result(this.value);case 30:this.value=e.sent,this.emit("submit",this.value);case 32:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.cancelled=this.state.submitted=!0,e.next=3,this.render();case 3:return e.next=5,this.close();case 5:if("function"!==typeof this.options.onCancel){e.next=8;break}return e.next=8,this.options.onCancel.call(this,this.name,this.value,this);case 8:return e.t0=this,e.next=11,this.error(t);case 11:e.t1=e.sent,e.t0.emit.call(e.t0,"cancel",e.t1);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=i(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.closed=!0;try{t=this.sections(),n=Math.ceil(t.prompt.length/this.width),t.rest&&this.write(y.cursor.down(t.rest.length)),this.write("\n".repeat(n))}catch(r){}this.emit("close");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){this.stop||!1===this.options.show||(this.stop=p.listen(this,this.keypress.bind(this)),this.once("close",this.stop))}},{key:"skip",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.skipped=!0===this.options.skip,"function"!==typeof this.options.skip){e.next=5;break}return e.next=4,this.options.skip.call(this,this.name,this.value);case 4:this.skipped=e.sent;case 5:return e.abrupt("return",this.skipped);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initialize",value:function(){var e=i(r.mark((function e(){var t,n,a,s,o,c=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.format,n=this.options,a=this.result,this.format=function(){return t.call(c,c.value)},this.result=function(){return a.call(c,c.value)},"function"!==typeof n.initial){e.next=7;break}return e.next=6,n.initial.call(this,this);case 6:this.initial=e.sent;case 7:if("function"!==typeof n.onRun){e.next=10;break}return e.next=10,n.onRun.call(this,this);case 10:return"function"===typeof n.onSubmit&&(s=n.onSubmit.bind(this),o=this.submit.bind(this),delete this.options.onSubmit,this.submit=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.name,c.value,c);case 2:return e.abrupt("return",o());case 3:case"end":return e.stop()}}),e)})))),e.next=13,this.start();case 13:return e.next=15,this.render();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){throw new Error("expected prompt to have a custom render method")}},{key:"run",value:function(){var e=this;return new Promise(function(){var t=i(r.mark((function t(n,i){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.once("submit",n),e.once("cancel",i),t.next=4,e.skip();case 4:if(!t.sent){t.next=7;break}return e.render=function(){},t.abrupt("return",e.submit());case 7:return t.next=9,e.initialize();case 9:e.emit("run");case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"element",value:function(){var e=i(r.mark((function e(t,n,i){var a,s,o,c,u,l,d,p;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.options,s=this.state,o=this.symbols,c=this.timers,u=c&&c[t],s.timer=u,l=a[t]||s[t]||o[t],!n||null==n[t]){e.next=8;break}e.t0=n[t],e.next=11;break;case 8:return e.next=10,l;case 10:e.t0=e.sent;case 11:if(""!==(d=e.t0)){e.next=14;break}return e.abrupt("return",d);case 14:return e.next=16,this.resolve(d,s,n,i);case 16:if((p=e.sent)||!n||!n[t]){e.next=19;break}return e.abrupt("return",this.resolve(l,s,n,i));case 19:return e.abrupt("return",p);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"prefix",value:function(){var e=i(r.mark((function e(){var t,n,i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("prefix");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=this.symbols;case 5:if(t=e.t0,n=this.timers&&this.timers.prefix,(i=this.state).timer=n,g.isObject(t)&&(t=t[i.status]||t.pending),g.hasColor(t)){e.next=13;break}return a=this.styles[i.status]||this.styles.pending,e.abrupt("return",a(t));case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"message",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("message");case 2:if(t=e.sent,g.hasColor(t)){e.next=5;break}return e.abrupt("return",this.styles.strong(t));case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"separator",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("separator");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=this.symbols;case 5:return t=e.t0,n=this.timers&&this.timers.separator,(i=this.state).timer=n,a=t[i.status]||t.pending||i.separator,e.next=12,this.resolve(a,i);case 12:if(s=e.sent,g.isObject(s)&&(s=s[i.status]||s.pending),g.hasColor(s)){e.next=16;break}return e.abrupt("return",this.styles.muted(s));case 16:return e.abrupt("return",s);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pointer",value:function(){var e=i(r.mark((function e(t,n){var i,a,s,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("pointer",t,n);case 2:if("string"!==typeof(i=e.sent)||!g.hasColor(i)){e.next=5;break}return e.abrupt("return",i);case 5:if(!i){e.next=14;break}return a=this.styles,s=this.index===n,o=s?a.primary:function(e){return e},e.next=11,this.resolve(i[s?"on":"off"]||i,this.state);case 11:return c=e.sent,u=g.hasColor(c)?c:o(c),e.abrupt("return",s?u:" ".repeat(c.length));case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"indicator",value:function(){var e=i(r.mark((function e(t,n){var i,a,s,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("indicator",t,n);case 2:if("string"!==typeof(i=e.sent)||!g.hasColor(i)){e.next=5;break}return e.abrupt("return",i);case 5:if(!i){e.next=11;break}return a=this.styles,s=!0===t.enabled,o=s?a.success:a.dark,c=i[s?"on":"off"]||i,e.abrupt("return",g.hasColor(c)?c:o(c));case 11:return e.abrupt("return","");case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"body",value:function(){return null}},{key:"footer",value:function(){if("pending"===this.state.status)return this.element("footer")}},{key:"header",value:function(){if("pending"===this.state.status)return this.element("header")}},{key:"hint",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"!==this.state.status||this.isValue(this.state.input)){e.next=7;break}return e.next=3,this.element("hint");case 3:if(t=e.sent,g.hasColor(t)){e.next=6;break}return e.abrupt("return",this.styles.muted(t));case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"error",value:function(e){return this.state.submitted?"":e||this.state.error}},{key:"format",value:function(e){return e}},{key:"result",value:function(e){return e}},{key:"validate",value:function(e){return!0!==this.options.required||this.isValue(e)}},{key:"isValue",value:function(e){return null!=e&&""!==e}},{key:"resolve",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return g.resolve.apply(g,[this,e].concat(n))}},{key:"base",get:function(){return l.prototype}},{key:"style",get:function(){return this.styles[this.state.status]}},{key:"height",get:function(){return this.options.rows||g.height(this.stdout,25)}},{key:"width",get:function(){return this.options.columns||g.width(this.stdout,80)}},{key:"size",get:function(){return{width:this.width,height:this.height}}},{key:"cursor",get:function(){return this.state.cursor},set:function(e){this.state.cursor=e}},{key:"input",get:function(){return this.state.input},set:function(e){this.state.input=e}},{key:"value",get:function(){var e=this.state,t=e.input,n=[e.value,t].find(this.isValue.bind(this));return this.isValue(n)?n:this.initial},set:function(e){this.state.value=e}}],[{key:"prompt",get:function(){var e=this;return function(t){return new e(t).run()}}}]),l}(l);function b(e){for(var t=function(t){return void 0===e[t]||"function"===typeof e[t]},n=["actions","choices","initial","margin","roles","styles","symbols","theme","timers","value"],r=["body","footer","error","header","hint","indicator","message","prefix","separator","skip"],i=0,a=Object.keys(e.options);i<a.length;i++){var s=a[i];if(!n.includes(s)&&!/^on[A-Z]/.test(s)){var o=e.options[s];"function"===typeof o&&t(s)?r.includes(s)||(e[s]=o.bind(e)):"function"!==typeof e[s]&&(e[s]=o)}}}function k(e){"number"===typeof e&&(e=[e,e,e,e]);for(var t=[].concat(e||[]),n=function(e){return e%2===0?"\n":" "},r=[],i=0;i<4;i++){var a=n(i);t[i]?r.push(a.repeat(t[i])):r.push("")}return r}e.exports=m}).call(this,n(20))},2230:function(e,t,n){var r=n(557),i=n(34),a=n(15),s=n(12),o=n(25),c=o.rxRequestModel,u=o.rxReplyModel,l=o.pendingModel;e.exports={raisePending:function(e,t){return s(c.isModel(t)),s(l.isModel(e)),s(!e.getIsPending()),l.clone(a(a({},e),{},{pendingRequest:t}))},bufferRequest:function(e,t){s(c.isModel(t)),s(e.getIsPending());var n=t.getAddress().getChainId(),r=t.getIndex(),o=a({},e.requests),u=e.requests[n]||[];return o[n]=[].concat(i(u),[r]),l.clone(a(a({},e),{},{requests:o}))},pushReply:function(e,t){s(u.isModel(t)),s(e.getIsPending());var n=[].concat(i(e.replies),[t]);return l.clone(a(a({},e),{},{replies:n}))},settle:function(e){return s(e.getIsPending()),delete(e=a({},e)).pendingRequest,e.replies=[],l.clone(e)},shiftRequests:function(e,t){s(!e.getIsPending()),s(!e.replies.length);var n=e.rxBufferedRequest(t).event;s(c.isModel(n));var i=n.getAddress().getChainId(),o=n.getIndex(),u=r(e.requests[i]),d=u[0],p=u.slice(1);s.strictEqual(d,o);var f=a({},e.requests);return p.length?f[i]=p:delete f[i],l.clone(a(a({},e),{},{requests:f}))}}},2231:function(e,t,n){(function(t){var r=n(34),i=n(9),a=n(10),s=n(80),o=n(12),c=n(18)("interblock:api:hooks"),u=n(149),l=n(558),d=l.request,p=l.promise,f=l.resolve,h=l.reject,v=l.isReplyFor,g=new Promise((function(){}));g.isEternal=!0,Object.freeze(g);var y=function(e){c("_promise request.type: %o",e.type);var t=x();o(Array.isArray(t));var n=e.type,r=e.payload,i=e.to,a=e.exec,s=e.inBand;o(!a||"function"===typeof a);var u={type:n,payload:r,to:i},l=t.find((function(e){return v(e,u)}));if(!l)return a&&(u.exec=a,u.inBand=s),w(u),g;var d=t.indexOf(l);if(t.splice(d,1),"@@RESOLVE"===l.type)return l.payload;throw o.strictEqual(l.type,"@@REJECT"),l.payload},m=function(){var e=a(i.mark((function e(n){var r,a,s,u,l,d,p,f,h,v,g,y,m,x=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x.length>1&&void 0!==x[1]?x[1]:[],a=x.length>2&&void 0!==x[2]?x[2]:"unsalted",o.strictEqual(typeof n,"function"),o(Array.isArray(r)),o.strictEqual(typeof a,"string"),c("hook salt:",a),e.next=8,b(r,a);case 8:if(e.prev=8,"object"===typeof(u=n())){e.next=12;break}throw new Error("Must return object from tick: ".concat(u));case 12:if(l=!1,"function"!==typeof u.then){e.next=41;break}return d=Symbol("RACECAR"),p=Promise.resolve(d),e.next=18,Promise.race([u,p]);case 18:if((f=e.sent)!==d){e.next=24;break}return h=new Promise((function(e){return t((function(){return e(d)}))})),e.next=23,Promise.race([u,h]);case 23:f=e.sent;case 24:if(v=f===d,s=k(),!v||s.requests.length){e.next=28;break}throw new Error('Non standard promise returned - use "effectInBand(...)"');case 28:if(v){e.next=37;break}return e.next=31,u;case 31:if(u=e.sent,l=!1,"object"===typeof u){e.next=35;break}throw new Error("Must resolve object from tick: ".concat(u));case 35:e.next=39;break;case 37:u=void 0,l=!0;case 39:e.next=42;break;case 41:s=k();case 42:return y=(g=s).requests,m=g.replies,e.abrupt("return",{reduction:u,isPending:l,requests:y,replies:m});case 46:throw e.prev=46,e.t0=e.catch(8),c("error: ",e.t0),!s&&k(),e.t0;case 51:case"end":return e.stop()}}),e,null,[[8,46]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=a(i.mark((function e(n,a){var s,u,l,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:globalThis["@@interblock"]=globalThis["@@interblock"]||{},s=Date.now();case 2:if(!globalThis["@@interblock"].promises){e.next=7;break}return e.next=5,new Promise(t);case 5:e.next=2;break;case 7:u="waited for global for ".concat(Date.now()-s,"ms"),c(u),o(!globalThis["@@interblock"].promises,u),l=r(n),0,d={accumulator:l,requests:[],replies:[],requestId:0,salt:a},globalThis["@@interblock"].promises=d;case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(){M();var e=globalThis["@@interblock"].promises,t=e.requests,n=e.replies;return delete globalThis["@@interblock"].promises,{requests:t,replies:n}},x=function(){M();var e=globalThis["@@interblock"].promises.accumulator;return c("_getGlobalAccumulator"),e},w=function(e){M();var t=globalThis["@@interblock"].promises.requests,n=e.type,r={type:n,payload:e.payload,to:e.to};if(t.some((function(e){return u(r,e)})))throw new Error("Duplicate request made: ".concat(n));c("_pushGlobalRequest",e.type),t.push(e)},I=function(e){M();var t=globalThis["@@interblock"].promises.replies;c("_pushGlobalReply",e.type),t.push(e)},C=function(){var e=globalThis["@@interblock"].promises.salt,t=globalThis["@@interblock"].promises.requestId++;return"".concat(t,"_").concat(e)},M=function(){o(globalThis["@@interblock"]),o(globalThis["@@interblock"].promises);var e=globalThis["@@interblock"].promises,t=e.accumulator,n=e.requests,r=e.replies,i=e.requestId;o(Array.isArray(t)),o(Array.isArray(n)),o(Array.isArray(r)),o(Number.isInteger(i)&&i>=0)},R=function(){var e=a(i.mark((function e(t){var n,s,o,u,l,d,p,h=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=h.length>1&&void 0!==h[1]?h[1]:[],s=h.length>2?h[2]:void 0,n=r(n);case 3:return e.next=5,m(t,n,s);case 5:return o=e.sent,u=o.requests.filter((function(e){return e.inBand})),d=u.map(function(){var e=a(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("inband execution of: ",t.type),e.next=3,t.exec();case 3:return n=e.sent,r=f(n,t),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=10,Promise.all(d);case 10:p=e.sent,c("inband awaits results: ",p.length),(l=n).push.apply(l,r(p));case 13:if(u.length){e.next=3;break}case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports={replyPromise:function(){return I(p())},replyResolve:function(e,t){return I(f(e,t))},replyReject:function(e,t){return I(h(e,t))},interchain:function(e,t,n){var r=d(e,t,n);return o(".@@io"!==r.to),y(r)},effect:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];o.strictEqual(typeof e,"string"),o.strictEqual(typeof t,"function");var a=C(),c=s({args:r},".@@ioRequestId",a),u=function(){return t.apply(void 0,r)};return y({type:e,payload:c,to:".@@io",exec:u,inBand:!1})},effectInBand:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a={args:r},s=function(){return t.apply(void 0,r)};return y({type:e,payload:a,exec:s,inBand:!0,to:void 0})},all:function(){},"@@GLOBAL_HOOK":m,"@@GLOBAL_HOOK_INBAND":R}}).call(this,n(148).setImmediate)},2232:function(e,t,n){var r=n(12),i=n(55).replyResolve,a=n(18)("interblock:dmz:ping"),s=n(25).rxRequestModel;e.exports={ping:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"string"===typeof e&&(e={string:e}),{type:"@@PING",payload:e}},pingReducer:function(e){r(s.isModel(e)),r.strictEqual(e.type,"@@PING");var t=e.payload;a("ping: %O",t),i(t)}}},2233:function(e,t,n){var r=n(18)("interblock:dmz:listChildren"),i=n(270).getChannelParams,a=n(55).replyResolve;e.exports={listChildren:function(){return{type:"@@LS"}},listChildrenReducer:function(e){r("listChildrenReducer");var t={};e.getAliases().filter((function(e){return"."!==e})).forEach((function(n){t[n]=i(e,n)})),a({children:t})}}},2234:function(e,t,n){var r=n(54),i=n(9),a=n(15),s=n(121),o=n(10),c=n(12),u=n(25),l=u.rxReplyModel,d=u.dmzModel,p=u.covenantIdModel,f=n(562),h=f.spawn,v=f.spawnReducerWithoutPromise,g=n(55),y=g.interchain,m=g.isReplyFor,b=g.replyResolve,k=g.replyPromise,x=function(e){return{type:"@@DEPLOY",payload:{installer:e}}},w=function(){var e=o(i.mark((function e(t,n){var r,o,c,u,l,f,g,m,b,w,I,C,M;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.payload.installer,o=r.children,c=void 0===o?{}:o,e.t0=i.keys(c);case 3:if((e.t1=e.t0()).done){e.next=19;break}return u=e.t1.value,l=c[u],l.children,f=l.covenant,g=l.state,m=void 0===g?{}:g,b=s(l,["children","covenant","state"]),f=f||"unity",w=p.create(f),b=a(a({},b),{},{covenantId:w,state:m}),I=h(u,b,[],"seed_"+u),e.next=13,v(t,I);case 13:C=e.sent,t=d.clone(a(a({},t),{},{network:C})),M=x(c[u]),y(M,u),e.next=3;break;case 19:return Object.keys(c).length&&k(),e.abrupt("return",t.network);case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={install:function(e){return{type:"@@INSTALL",payload:{installer:e}}},deploy:x,deployReducer:w,deployReply:function(e,t){c(l.isModel(t));var n,i,a=e.getResolvedAliases(),s=r(a);try{for(s.s();!(i=s.n()).done;){var o=e[i.value];if("./"===o.systemRole){var u=o.requests[1];if(u&&"@@DEPLOY"===u.type){if(n)return;n=u}}}}catch(x){s.e(x)}finally{s.f()}var d=m(t,n);c(d,"action was not round among any deploy replies");var p,f,h,v=e[".."],g=r(v.getRemoteRequestIndices());try{for(g.s();!(h=g.n()).done;){var y=h.value,k=v.rxRequest(y);"@@DEPLOY"===k.type&&(c(!f&&!p),b({},k),p=!0),"@@INSTALL"===k.type&&(c(!f&&!p),b({},k),f=!0)}}catch(x){g.e(x)}finally{g.f()}}}},2235:function(e,t,n){var r=n(12),i=n(18)("interblock:dmz:getChannel"),a=n(74),s=n(55).replyResolve,o=n(270).getChannelParams;e.exports={getChannel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";return{type:"@@GET_CHAN",payload:{alias:e}}},getChannelReducer:function(e,t){var n=t.payload.alias;if(r.strictEqual(typeof n,"string"),n=a.normalize(n),i("getChannelReducer",n),e[".."].address.isRoot()&&n.startsWith("/")&&(n=(n=n.substring(1))||"."),!e[n])throw new Error("Unknown channel: ".concat(n));s(o(e,n))}}},2236:function(e,t,n){var r=n(18)("interblock:dmz:genesis"),i=n(55),a=i.interchain,s=i.replyResolve,o=n(25).blockModel;e.exports={genesisReducer:function(e,t){a("@@INIT")},genesisReply:function(e){var t=e.getRequest().payload,n=t.genesis,i=t.alias,a=t.originAction,c={alias:i,chainId:o.clone(n).getChainId()};a.sequence&&s(c,a),r("reply received for @@GENESIS")}}},2237:function(e,t,n){var r=n(12),i=n(25).dmzModel,a=n(55).replyResolve;e.exports={getStateReducer:function(e){r(i.isModel(e)),a(e.state)},getState:function(){return{type:"@@CAT",payload:{}}}}},2246:function(e,t){},2277:function(e,t){},2297:function(e,t,n){var r=n(15),i=n(9),a=n(121),s=n(10),o=n(18)("interblock:covenants:shell"),c=n(74),u=n(12),l=n(25).covenantIdModel,d=n(103),p=n(70),f=p.Machine,h=p.assign,v=d.actions,g=v.ping,y=v.spawn,m=v.connect,b=v.listChildren,k=v.install,x=v.getChannel,w=v.getState,I=n(55).interchain,C=n(571),M=n(378),R=M.respond,E=(M.send,M.sendParent,{ping:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:"PING",payload:r(r({},t),{},{to:e})}},login:function(e,t){return{type:"LOGIN",payload:{terminalChainId:e,credentials:t}}},add:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:"ADD",payload:{alias:e,spawnOptions:t}}},ls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";return{type:"LS",payload:{path:e}}},rm:function(e){return{type:"RM",payload:{path:e}}},cd:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";return{type:"CD",payload:{path:e}}},up:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".",t=arguments.length>1?arguments[1]:void 0;return{type:"UP",payload:{path:e,remoteParent:t}}},dispatch:function(e,t){return u.strictEqual(typeof e,"object"),u.strictEqual(typeof t,"string"),{type:"DISPATCH",payload:{action:e,to:t}}},install:function(e,t){return{type:"INSTALL",payload:{dpkgPath:e,installPath:t}}},publish:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";return{type:"PUBLISH",payload:{name:e,installer:t,registry:n}}},cat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";return{type:"CAT",payload:{path:e}}}}),P=(0,M.translator)(f({id:"shell",initial:"idle",context:{root:"/",wd:"/"},strict:!0,states:{idle:{on:{PING:"ping",LOGIN:"login",ADD:"addActor",LS:"listActors",CD:"changeDirectory",RM:"removeActor",MV:"moveActor",LN:"linkActor",UP:"uplinkActor",CAT:"getState",DISPATCH:"dispatch",PUBLISH:"publish",INSTALL:"install",LOGOUT:"logout",BAL:"balance"}},ping:{invoke:{src:"ping",onDone:"idle"},exit:"respondOrigin"},login:{invoke:{src:"login",onDone:"idle"}},addActor:{invoke:{src:"addActor",onError:"idle",onDone:"idle"},exit:"respondOrigin"},listActors:{invoke:{src:"listActors",onDone:"idle",onError:"idle"},exit:"respondOrigin"},changeDirectory:{invoke:{src:"changeDirectory",onDone:{target:"idle",actions:["assignWd","respondOrigin"]},onError:"idle"}},removeActor:{invoke:{src:"removeActor",onDone:"idle",onError:"idle"}},moveActor:{},linkActor:{},uplinkActor:{},getState:{invoke:{src:"getState",onDone:{target:"idle",actions:"respondOrigin"}}},logout:{},balance:{},dispatch:{invoke:{src:"dispatch",onDone:{target:"idle",actions:"respondOrigin"}}},publish:{invoke:{src:"publish",onDone:{target:"idle",actions:"respondOrigin"}}},install:{invoke:{src:"install",onDone:{target:"idle",actions:"respondOrigin"}}},done:{id:"done",data:"info about the files ?",type:"final"},error:{id:"error",type:"final"}}},{actions:{respondOrigin:function(e,t){return o("respondOrigin",t.type),R(t.data)},assignWd:h({wd:function(e,t){var n=t.data.absolutePath;u.strictEqual(typeof n,"string");var r=c.normalize(n);return u.strictEqual(r,n),o("assignWd",n),n}})},guards:{},services:{ping:function(){var e=s(i.mark((function e(t,n){var r,s,c,l,d,p;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("ping: %O",n),r=n.type,s=n.payload,c=s.to,l=void 0===c?".":c,d=a(s,["to"]),u.strictEqual(r,"PING"),e.next=6,I(g(d),l);case 6:return p=e.sent,o("ping result: %O",p),e.abrupt("return",p);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),login:function(){var e=s(i.mark((function e(t,n){var r,a,s,c,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("login: %O",n.payload),r=n.payload,a=r.terminalChainId,s=r.credentials,c=m("terminal",a),e.next=5,invoke(c);case 5:return e.next=7,invoke("@@INTRO",s,"terminal");case 7:return u=e.sent,o("loginResult: %O",u),e.abrupt("return",{loginResult:u});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),addActor:function(){var e=s(i.mark((function e(t,n){var r,a,s,d,p,f,h,v,g,m;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.wd,a=n.payload,s=a.alias,d=a.spawnOptions,u.strictEqual(typeof s,"string"),p=c.resolve(r,s),f=c.dirname(p),!(h=c.basename(p))&&s&&o("resetting name to ".concat(h=s)),o("addActor: %O to: %O",h,f),"string"===typeof d&&(v=l.create(d),d={covenantId:v}),u.strictEqual(typeof d,"object"),g=y(h,d),e.next=13,I(g,f);case 13:return m=e.sent,e.abrupt("return",m);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),listActors:function(){var e=s(i.mark((function e(t,n){var a,s,u,l,d,p,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.wd,s=n.payload.path,u=c.resolve(a,s),o("listActors",u),l=b(u),e.next=7,I(l,u);case 7:return d=e.sent,p=d.children,e.next=11,I(x(u));case 11:return f=e.sent,e.abrupt("return",{children:r(r({},p),{},{".":f})});case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),changeDirectory:function(){var e=s(i.mark((function e(t,n){var r,a,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.wd,a=n.payload.path,u.strictEqual(typeof a,"string"),u(c.isAbsolute(r)),s=c.resolve(r,a),o("changeDirectory",s),e.next=8,I(g(),s);case 8:return e.abrupt("return",{absolutePath:s});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),removeActor:function(){var e=s(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o("removeActor",n);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),dispatch:function(){var e=s(i.mark((function e(t,n){var r,a,s,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.payload,a=r.action,s=r.to,c=a.type,u=a.payload,o("dispatch type: %o to: %o",c,s),e.next=5,I(c,u,s);case 5:return l=e.sent,e.abrupt("return",l);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),publish:function(){var e=s(i.mark((function e(t,n){var r,a,s,c,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.payload,a=r.name,s=r.installer,r.registry,o("publish: ",a),c=l.create("dpkg"),u={installer:s},e.next=6,I(y(a,{covenantId:c,state:u}));case 6:return e.abrupt("return",{dpkgPath:a});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),install:function(){var e=s(i.mark((function e(t,n){var s,c,u,d,p,f,h,v,g,m;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.payload,c=s.dpkgPath,u=s.installPath,o("install from: %o to: %o",c,u),e.next=4,I(C.actions.getInstaller(),c);case 4:return d=e.sent,d.children,p=d.covenant,f=a(d,["children","covenant"]),p=p||"unity",h=l.create(p),f=r(r({},f),{},{covenantId:h}),v=y(u,f),I(v),o("begining install"),g=k(d),e.next=15,I(g,u);case 15:m=e.sent,o("installResult: ",m);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getState:function(){var e=s(i.mark((function e(t,n){var r,a,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.payload.path,o("getState: ",r),a=w(),e.next=5,I(a,r);case 5:return s=e.sent,o("getState result: ",s),e.abrupt("return",{state:s});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}}));e.exports={actions:E,reducer:P}},2298:function(e,t,n){var r=n(9),i=n(121),a=n(15),s=n(10),o=n(12),c=n(18)("interblock:xstate:translator"),u=(n(51),n(149)),l=n(70).State,d=n(55),p=(d.request,d.promise,d.resolve,d.reject,d.isReplyFor),f=(d.replyPromise,d.replyReject,d.replyResolve),h=d.interchain,v=function(e,t){if(e&&e.message&&e.stack){c("error detected %O",e);var n=e,r=n.message,i=n.stack;e=a(a({},e),{},{stack:i,message:r})}return{type:"done.invoke."+t,data:e}},g=function(e){o(Array.isArray(e))},y=function(e,t){switch(e.type){case"@@SEND":throw c("send: %O",e),new Error("not implemented");case"@@SEND_PARENT":throw c("sendParent: %O",e),new Error("not implemented");case"@@RESPOND":c("@@RESPOND to: ",t.type),f(e.data,t);break;default:if(e.type.startsWith("done.invoke.")){var n=a(a({},e),{},{payload:e.data});return delete n.data,n}return e}},m=function(e,t){if(!e.nextEvents.includes(t.type)){var n=t&&t.type,r=e&&e.value;throw new Error("State: ".concat(r," does not accept event type: ").concat(n))}};e.exports={respond:function(e){return"string"===typeof e&&(e={type:e}),{type:"@@RESPOND",data:e}},send:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return{type:"@@SEND",payload:e,path:t}},sendParent:function(e){return{type:"@@SEND_PARENT",payload:e,path:".."}},translator:function(e){var t=e.initialState;return function(){var n=s(r.mark((function n(d,f){var b,k,x,w,I,C,M,R,E,P,O;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o.strictEqual(typeof f,"object"),"@@INIT"!==f.type){n.next=3;break}return n.abrupt("return",d);case 3:if(d&&!u(d,{})||(d=t),o(!d.actions||!d.actions.length,"uncleared xstate"),f.type.startsWith("done.invoke.")&&delete(f=a(a({},f),{},{data:f.payload})).payload,c("translator reducer action: %O",f),!p(f)){n.next=10;break}return c("ignoring reply received: ",f),n.abrupt("return",d);case 10:return c("previous machine state: ",d.value),b=l.create(d),k=e.resolveState(b),m(k,f),x=e.transition(k,f),c("next machine state: ",x.value),w=x.toJSON(),I=w.actions,C=i(w,["actions"]),M=JSON.parse(JSON.stringify(C)),R=M.context,E=M.event,g(I),P=M.history.event,c("originAction: ",P.type),O=I.map(function(){var t=s(r.mark((function t(n){var i,a,s,u,l,d,p,f,g;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.type,t.next="xstate.start"===t.t0?3:"xstate.stop"===t.t0?18:20;break;case 3:return c("xstate.start"),i=n.activity,o(i&&"xstate.invoke"===i.type),a=i.src,s=e.options.services[a],o("function"===typeof s),c("running service: ",a),t.next=12,s(R,E);case 12:return u=t.sent,c("invoke result: ",u&&u.type),l=v(u,a),d=l.type,p=l.data,c("doneInvoke",p),h(d,p),t.abrupt("break",23);case 18:return c("end of invoke"),t.abrupt("break",23);case 20:return c("default: %O",n),n.exec?(f=n.exec(R,E),c("execResult %O",f),f&&y(f,P)):(c("standard action ? %O",n),g=y(n,P),protocolActions.push(g)),t.abrupt("break",23);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n.next=26,Promise.all(O);case 26:return n.abrupt("return",M);case 27:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}}},2300:function(e,t,n){var r=n(9),i=n(15),a=n(10),s=n(18)("interblock:covenants:hyper"),o=n(55),c=o.replyResolve,u=(o.request,n(103).actions,{}),l={reducer:function(){var e=a(r.mark((function e(){var t,n,a=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]?a[0]:u,n=a.length>1?a[1]:void 0,s("hyper action: ",n.type),e.t0=n.type,e.next="PING"===e.t0?6:8;break;case 6:return c({type:"PONG"}),e.abrupt("break",8);case 8:return e.abrupt("return",i({},t));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),actions:{}};e.exports=i({},l)},2301:function(e,t,n){var r=n(9),i=n(15),a=n(10),s=n(18)("interblock:covenants:probe"),o=n(55),c=o.replyResolve,u=(o.request,n(103).actions,{}),l={reducer:function(){var e=a(r.mark((function e(){var t,n,a,o,l=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=l.length>0&&void 0!==l[0]?l[0]:u,n=l.length>1?l[1]:void 0,a=n.type,o=n.payload,s("test action: ",a),e.t0=a,e.next="PING"===e.t0?7:9;break;case 7:return c({type:"PONG",payload:o}),e.abrupt("break",9);case 9:return e.abrupt("return",i({},t));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),actions:{}};e.exports=i({},l)},2302:function(e,t,n){var r=n(12),i=n(41).standardize,a=n(383).txRequestModel,s=n(382).txReplyModel,o=n(380).rxReplyModel,c=n(381).rxRequestModel,u=n(260).registry,l=function(e,t){if(!e)throw new Error("Action cannot be interpreted: ".concat(e));if("string"===typeof e&&(e={type:e}),r(e.type,"Action must supply a type"),d(e.type)){var n,i=e,o=i.type,u=i.payload,l=void 0===u?{}:u,p=e.request;return p?n=p.sequence:(r(c.isModel(t)),n=t.sequence),s.create(o,l,n)}var f=e,h=f.type,v=f.payload,g=void 0===v?{}:v,y=f.to,m=void 0===y?".":y;return a.create(h,g,m)},d=function(e){return s.schema.properties.type.enum.includes(e)},p=i({schema:{title:"Reduction",type:"object",required:["isPending","requests","replies"],additionalProperties:!1,properties:{reduction:{type:"object"},isPending:{type:"boolean"},requests:{type:"array",uniqueItems:!0,items:a.schema},replies:{type:"array",uniqueItems:!0,items:s.schema}}},create:function(e,t,n){var i=e.reduction,a=e.isPending,s=e.requests,d=e.replies;r(Array.isArray(s)),r(Array.isArray(d)),r(c.isModel(t)||o.isModel(t)),r(u.get("Dmz").isModel(n)),s=s.map((function(e){return l(e,t)})),d=d.map((function(e){return l(e,t)})),s.forEach((function(e){".@@io"===e.to&&r(n.config.isPierced)}));var f={reduction:i,isPending:a,requests:s,replies:d};return i||delete f.reduction,p.clone(f)},logicize:function(e){var t=e.reduction,n=e.isPending,i=e.requests,o=e.replies;r(t&&!n||!t&&n),r(i.every(a.isModel)),r(o.every(s.isModel));var c=0,u=new Set;o.forEach((function(e){e.getReply().isPromise()&&c++,u.add(e.request.sequence)})),r(u.size===o.length,"Duplicate sequence detected"),n?r.strictEqual(c,0,"No promises allowed if pending"):r(c<=1,"Max one promise allowed: ".concat(c));return{getIsPending:function(){return n}}}});e.exports={reductionModel:p}},2303:function(e,t,n){var r=n(2304).txModel,i=n(577).socketModel;e.exports={socketModel:i,txModel:r}},2304:function(e,t,n){var r=n(12),i=n(41).standardize,a=n(279).interblockModel,s=n(577).socketModel,o=i({schema:{title:"Tx",description:"An interblock plus socket info, used for transmission functions",type:"object",required:["socket","interblock"],additionalProperties:!1,properties:{socket:s.schema,interblock:a.schema}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.create(),t=arguments.length>1?arguments[1]:void 0;return r(s.isModel(e)),r(a.isModel(t)),o.clone({socket:e,interblock:t})},logicize:function(e){return{}}});e.exports={txModel:o}},2305:function(e,t,n){var r=n(9),i=n(10),a=n(117),s=function(){var e=i(r.mark((function e(t){var n,s,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"===typeof t){e.next=2;break}return e.abrupt("return");case 2:if(n=t,t.interblock&&(n=t.interblock),n.provenance&&n.provenance.signatures){e.next=6;break}return e.abrupt("return");case 6:if(s=n.provenance.signatures,Array.isArray(s)){e.next=9;break}return e.abrupt("return");case 9:return c=s.map(function(){var e=i(r.mark((function e(t){var n,i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.publicKey,i=t.integrity,s=t.seal,a.verifyKeyPairSync(i.hash,s,n.key)){e.next=3;break}return e.abrupt("return",a.verifyHash(i.hash,s,n.key));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=12,Promise.all(c);case 12:if(!n.network||!n.network["."]){e.next=15;break}return e.next=15,o(n.network);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.values(t).map(function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t.heavy);case 2:return n=t.lineageTip.map(s),e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=3,Promise.all(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=i(r.mark((function e(t){var n,i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.publicKey.key,i=t.secretKey,s={publicKey:n,secretKey:i},a.verifyKeyPairSync(s)){e.next=6;break}return e.next=6,a.verifyKeyPair(s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports={cacheVerifyHash:s,cacheVerifyKeypair:c}},2306:function(e,t,n){var r=n(9),i=n(10),a=n(12),s=n(497).ioQueueFactory,o=n(25),c=o.interblockModel,u=o.addressModel,l=o.txModel,d=n(390).isolateFactory,p=n(280).cryptoFactory,f=n(123).consistencyFactory,h=n(2315).increasorConfig,v=n(2333).poolConfig,g=n(2335).receiveConfig,y=n(2337).transmitConfig,m=n(282).pure;e.exports={fsmFactory:function(){var e=s("ioIsolate"),t=s("ioCrypto"),n=s("ioConsistency"),o=s("ioPool",c),b=s("ioIncrease",u),k=s("ioReceive",l),x=s("ioTransmit",c);e.setProcessor(d()),t.setProcessor(p()),n.setProcessor(f());var w=v(t,n),I=function(){var e=i(r.mark((function e(t){var n,i,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(c.isModel(t)),n={type:"POOL_INTERBLOCK",payload:t},i=w.machine,s=w.config,e.next=5,m(n,i,s);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();o.setProcessor(I);var C=h(t,n,e),M=function(){var e=i(r.mark((function e(t){var n,i,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(u.isModel(t)),n={type:"INCREASE_CHAIN",payload:t},i=C.machine,s=C.config,e.next=5,m(n,i,s);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();b.setProcessor(M);var R=g(n),E=function(){var e=i(r.mark((function e(t){var n,i,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(l.isModel(t)),n={type:"RECEIVE_INTERBLOCK",payload:t},i=R.machine,s=R.config,e.next=5,m(n,i,s);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();k.setProcessor(E);var P=y(n),O=function(){var e=i(r.mark((function e(t){var n,i,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(c.isModel(t)),n={type:"TRANSMIT_INTERBLOCK",payload:t},i=P.machine,s=P.config,e.next=5,m(n,i,s);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return x.setProcessor(O),{ioIsolate:e,ioCrypto:t,ioConsistency:n,ioPool:o,ioIncrease:b,ioReceive:k,ioTransmit:x}}}},2307:function(e,t){var n=function(e){return{schema:{title:e,type:"object",additionalProperties:!1,properties:{address:{type:"string",faker:"address.streetAddress"}}}}},r={covenantId:{name:"crm"},install:{children:{schedule:{covenant:"datum",state:{formData:{commonDate:"2020-01-01"},uiSchema:"schedule"},children:{exceptions:{covenant:"collection",state:{datumTemplate:{}}}}},services:{covenant:"datum"},customers:{covenant:"collection",state:{datumTemplate:{schema:{title:"Details",type:"object",required:["custNo","name","isEmailVerified"],properties:{name:{title:"Name",type:"string",faker:"name.findName"},mobile:{title:"Mobile",type:"string",faker:"phone.phoneNumber"},phone:{title:"Phone",type:"string",faker:"phone.phoneNumber"},email:{title:"Email",type:"string",format:"email",faker:"internet.email"},isEmailVerified:{title:"Email Verified",type:"boolean",default:!1},custNo:{title:"Customer Number",type:"integer",minimum:1,maximum:15e3,default:555},importedHash:{type:"string",faker:"git.commitSha"}}},uiSchema:{importedHash:{"ui:widget":"hidden"},isEmailVerified:{"ui:readonly":!0},custNo:{"ui:readonly":!0}},namePath:["custNo"],children:{serviceAddress:n("Service Address"),serviceGps:{schema:{title:"Service GPS",type:"object",additionalProperties:!1,required:["latitude","longitude"],properties:{latitude:{type:"number",faker:"address.latitude"},longitude:{type:"number",faker:"address.longitude"}}}},billingAddress:n("Billing Address")}}},children:{}},banking:{covenant:"datum"},settings:{covenant:"datum",state:{schema:{title:"Settings",type:"object",required:["isTerminalVisible"],additionalProperties:!1,properties:{isTerminalVisible:{title:"Show Terminal",type:"boolean",default:!0},isGuiVisible:{title:"Show GUI",type:"boolean",default:!0},isFakeDataEnabled:{title:"Allow Fake Data",type:"boolean",default:!0}}}}},about:{covenant:"datum",state:{schema:{title:"About CRM",type:"object",properties:{title:{type:"string"},description:{type:"string"}}},formData:{title:"CRM",description:"Simple Customer Relationship Management with mapping"}}},account:{covenant:"datum",state:{schema:{title:"Account",type:"object",properties:{name:{title:"Name",type:"string"},email:{title:"Email",type:"string",format:"email"}}}}}}}};e.exports={crm:r}},2308:function(e,t,n){var r=n(34),i=n(9),a=n(10),s=n(15),o=n(12),c=n(51),u=n(25),l=(u.actionModel,u.addressModel),d=u.integrityModel,p=u.provenanceModel,f=u.lockModel,h=u.blockModel,v=u.socketModel,g=u.interblockModel,y=u.txRequestModel,m=u.txReplyModel,b=n(18)("interblock:services:consistency"),k=function(e){var t=d.create(),n=d.clone(s(s({},t),{},{hash:e})),r=l.create(n);return o.strictEqual(r.getChainId(),e),r},x=function(e){return{chainId:e.provenance.getAddress().getChainId(),height:e.provenance.height,blockHash:e.getHash(),shortestLineage:e.provenance.lineage[0]}},w=function(e){return function(t){return I(t,e)}},I=function(e,t){var n=t.getChainId(),r=e.getRemote()?"heavy":"light",i=e.provenance.getAddress().getChainId(),a=e.provenance.height;return{chainId:n,originChainId_height_type:"".concat(i,"_").concat(a,"_").concat(r),interblockHash:e.getHash(),isDeleted:!1}},C=function(e){return function(t){var n=t.getChainId(),r=e.provenance.getAddress().getChainId(),i=e.network.getAlias(t),a=e.network[i];return o(a),{chainId:n,targetChainId:r,heavyHeight:a.heavyHeight,lineageHeight:a.lineageHeight,height:e.provenance.height}}},M=n(2309).lockFactory,R=n(579).dbFactory,E=n(580),P=E.s3Factory,O=E.s3Keys,A=n(281).ramDynamoDbFactory,q=n(392).ramS3Factory;e.exports={consistencySourceFactory:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CI";e=e||A(),t=t||q();var u=M(e),d=R(e),E=P(t),j=new Map,S=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,u,p,f,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.affectedAddresses,r=t.interblock,o(n.every(l.isModel)),o(g.isModel(r)),b("poolInterblocks for ".concat(n.length," addresses")),c=r.getWithoutRemote(),u=n.map((function(e){var t=c;return e.equals(r.getTargetAddress())?(s=!0,t=r):a=!0,I(t,e)})),b("poolItems count: %O",u.length),p=[],a&&(f=O.fromInterblock(c),p.push(E.putInterblock(f,c))),s&&(h=O.fromInterblock(r),p.push(E.putInterblock(h,r))),e.next=12,d.putPool(u);case 12:return e.next=14,Promise.all(p);case 14:b("poolInterblock complete for: ".concat(n.length," addresses"));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=a(i.mark((function e(t,r){var s,p,h,v,y,m,k,x,w,I,C,M;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(l.isModel(t)),s=t.getChainId(),e.next=4,u.tryAcquire(s,n,r);case 4:if(p=e.sent){e.next=8;break}return b("lockChain could not lock ".concat(s)),e.abrupt("return");case 8:return b("locked chain: ".concat(s," with: ").concat(p)),h=W({address:t}),e.next=12,d.queryPool(s);case 12:return v=e.sent,y=v.filter((function(e){return!e.isDeleted})),b("pool total: ".concat(v.length," valid: ").concat(y.length)),m=y.map(function(){var e=a(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=O.fromPoolItem(t),e.next=3,E.getInterblock(n);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:return o(g.isModel(r)),o.strictEqual(t.interblockHash,r.getHash()),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=18,Promise.all(m);case 18:return k=e.sent,x=c.compact(k),b("interblocks fetched: ".concat(x.length)),e.next=23,h;case 23:return w=e.sent,b("block height: %O",w&&w.provenance.height),b("interblock count: %O",x.length),e.next=28,d.queryPiercings(s);case 28:return I=e.sent,C={requests:[],replies:[]},I.forEach((function(e){var t=e.txRequest,n=e.txReply;o(!t||!n),t&&C.requests.push(t),n&&C.replies.push(n)})),M=f.create(w,x,p,C),o(!j.has(s)),j.set(s,M),b("lock complete: %O",M.uuid),e.abrupt("return",M);case 36:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,l,p,h,v,g;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b("putUnlockChain"),o(f.isModel(t)),n=t.block,o(n,"cannot unlock without a block"),r=n.provenance.getAddress(),a=r.getChainId(),e.next=8,u.isValid(a,t.uuid);case 8:if(e.sent){e.next=12;break}return b("unlock rejected for ".concat(a)),e.abrupt("return");case 12:if(s=j.get(a),!(c=s.block)||c.isNext(n)){e.next=19;break}b("block is not next %O",n.provenance.height),b("no change: ",c.equals(n)),e.next=35;break;case 19:if(c||n.provenance.address.isGenesis()){e.next=23;break}throw new Error("next was not genesis: ".concat(n.height));case 23:return l=O.fromBlock(n),e.next=26,E.putBlock(l,n);case 26:return p=x(n),e.next=29,d.putBlock(p);case 29:return b("block added"),h=L(n,c),v=N(n,s.interblocks),g=_(n,s.piercings),e.next=35,Promise.all([h,v,g]);case 35:return j.delete(a),e.next=38,u.release(a,t.uuid);case 38:b("putUnlockChain complete");case 39:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=a(i.mark((function e(t,n){var r,a,s,c,u,l,p,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(h.isModel(t)),o(!n||h.isModel(n)),r=n?n.network.getAliases():[],a=r.filter((function(e){return n.network[e].address.isResolved()})),s=t.network.getAliases().filter((function(e){return t.network[e].address.isResolved()})),c=s.filter((function(e){return!a.includes(e)})).map((function(e){return t.network[e].address})),u=a.filter((function(e){return!s.includes(e)})).map((function(e){return t.network[e].address})),l=c.map((function(e){return e.getChainId()})),b("_updateRouteTable newAddresses",l),p=c.map(C(t)),f=u.map(C(t)),e.next=13,Promise.all([d.putSubscriptions(p),d.delSubscriptions(f)]);case 13:b("updateRouteTable complete");case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=a(i.mark((function e(t,n){var r,a,o,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Q(t,n),a=t.provenance.getAddress(),o=r.map(w(a)).map((function(e){return s(s({},e),{},{isDeleted:!0})})),e.next=5,d.putPool(o);case 5:return b("_purgePool isDeleted marked"),e.next=8,z(r);case 8:return c=e.sent,b("_purgePool _findOrphans found: ".concat(c.length)),u=c.map(O.fromInterblock),e.next=13,E.deleteInterblocks(u);case 13:return l=o.map((function(e){return{chainId:e.chainId,originChainId_height_type:e.originChainId_height_type}})),e.next=16,d.delPool(l);case 16:b("_purgePool complete");case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=function(){var e=a(i.mark((function e(t){var n,s,o,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filter((function(e){return e.getRemote()})),s=t.filter((function(e){return!e.getRemote()})),o=s.map(function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t);case 2:return n=e.sent,e.abrupt("return",!n&&t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.t0=c,e.next=6,Promise.all(o);case 6:return e.t1=e.sent,u=e.t0.compact.call(e.t0,e.t1),e.abrupt("return",[].concat(r(u),r(n)));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=a(i.mark((function e(t,n){var a,s,o,c,u,l,p,f,h,v,g;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.network[".@@io"]){e.next=3;break}return e.abrupt("return");case 3:return s=a.getRemote(),o=s.requests,c=s.replies,u=Object.values(o),l=Object.values(c),p=n.requests.filter((function(e){return u.some((function(t){return e.getRequest().equals(t)}))})),f=n.replies.filter((function(e){return l.some((function(t){return e.getReply().equals(t)}))})),h=t.getChainId(),v=[].concat(r(p),r(f)),g=v.map((function(e){var t=e.getHash();return{chainId:h,hash:t}})),e.abrupt("return",d.delPierce(g));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),B=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,u,l,d,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.provenance,r=t.height,b("getLineage from height: ",a=void 0===r?0:r),o(p.isModel(n)),o(Number.isInteger(a)&&a>=0),o(a<n.height),s=n.getAddress(),c=[],l=n;case 8:return u=l.getShortestHeight(),e.next=11,W({address:s,height:u});case 11:d=e.sent,o(h.isModel(d)),c.push(d),l=d.provenance;case 15:if(u>a){e.next=8;break}case 16:return f=c.map((function(e){return g.create(e)})),e.abrupt("return",f);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=a(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(g.isModel(t)),n=t.provenance.getAddress().getChainId(),!0,e.next=5,d.queryAffected(n,true);case 5:return r=e.sent,e.abrupt("return",!!r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=a(i.mark((function e(t){var n,a,s,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(g.isModel(t)),n=t.provenance.getAddress().getChainId(),a=t.provenance.height,e.next=5,d.queryAffected(n);case 5:return s=e.sent,c=s.filter((function(e){var t=e.targetChainId,n=e.heavyHeight,r=e.lineageHeight;return t.startsWith(t)?n<a:r<a})),u=c.map((function(e){var t=e.targetChainId;return k(t)})),l=new Set(u),b("dbQueryAffected items length: %O",l.size),e.abrupt("return",r(l));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=a(i.mark((function e(t){var n,r,a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(l.isModel(t)),n=t.getChainId(),b("getSockets for: %O",n),e.next=5,d.querySockets(n);case 5:return r=e.sent,o(Array.isArray(r)),o(r.every((function(e){return"object"===typeof e}))),a=r.map((function(e){var t=e.socketJson;return o(t),v.clone(t)})),b("getSockets length: ".concat(a.length)),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,u,p;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.address,r=t.socket,b("putSocket"),o(l.isModel(n)),o(v.isModel(r)),a=n.getChainId(),s=r.id,c=parseInt(Date.now()/1e3),u=r.serialize(),p={chainId:a,socketId:s,updatedTime:c,socketJson:u},e.next=11,d.putSocket(p);case 11:b("putSocket complete");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(v.isModel(t)),b("delSocket %o",t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(e){return d.queryLatest(e.getChainId())},W=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.address,r=t.height,b("getBlock",n&&n.getChainId(),r),n){e.next=5;break}return o(!r),e.abrupt("return",J());case 5:if(o(l.isModel(n)),a=n.getChainId(),Number.isInteger(r)){e.next=13;break}return e.next=10,d.queryLatest(a);case 10:s=e.sent,e.next=16;break;case 13:return e.next=15,d.getBlock({chainId:a,height:r});case 15:s=e.sent;case 16:if(s){e.next=18;break}return e.abrupt("return");case 18:return Number.isInteger(r)||(r=s.height),c=O.fromBlockItem(s),b("s3.getBlock(s3Key)",c),e.next=23,E.getBlock(c);case 23:return u=e.sent,o(h.isModel(u)),o(n.equals(u.provenance.getAddress())),o.strictEqual(u.getHash(),s.blockHash),o.strictEqual(u.provenance.height,r),b("getBlock complete"),e.abrupt("return",u);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=a(i.mark((function e(){var t,n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b("getBaseAddress"),e.next=3,d.scanBaseChainId();case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:return o(t.chainId),n=l.create(t.chainId),o.strictEqual(t.chainId,n.getChainId()),b("getBaseAddress: ".concat(n.getChainId())),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=a(i.mark((function e(t){var n,r,a,s,c;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.txRequest,o(y.isModel(n)),r=l.create(n.to),o(r.isResolved()),a=r.getChainId(),s=n.getHash(),b("putPierceRequest %o %o",a,n),c={chainId:a,hash:s,txRequest:n},e.next=10,d.putPierce(c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=a(i.mark((function e(t){var n,r,a,s,c;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.txReply,o(m.isModel(n)),r=n.getAddress(),o(r.isResolved()),a=r.getChainId(),s=n.getHash(),b("putPierceReply %o %o",a,n),c={chainId:a,hash:s,txReply:n},e.next=10,d.putPierce(c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(e,t){return t.filter((function(t){var n=e.network.includesInterblock(t),r=e.network.getAlias(t.provenance.getAddress());return n||!r}))};return{putSocket:G,getSockets:H,delSocket:U,putLockChain:T,putUnlockChain:D,getLineage:B,getIsAnyAffected:K,getAffected:F,getIsPresent:V,getBlock:W,putPoolInterblock:S,putPierceRequest:$,putPierceReply:Y}}}},2309:function(e,t,n){var r=n(9),i=n(10),a=n(2310),s=n(146).promisify,o=n(281).ramDynamoDbFactory,c=0,u=1;e.exports={lockFactory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),t=n(18)("interblock:aws:lock:id-".concat(c++)),l=new Map,d=function(){var n=i(r.mark((function n(o,c,d){var p,f,v,g,y,m,b,k,x,w,I,C;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t("attempting to lock %o %o %o",o.substring(0,16),c,d),!l.has(o)){n.next=4;break}return t("already locked to this thread: ".concat(o)),n.abrupt("return");case 4:if(!e._getTables){n.next=9;break}return p="ramLockId-"+u++,f={uuid:p,tryRelease:function(){t("ram tryRelease for uuid: %o and chainId: %o",p,o)}},l.set(o,f),n.abrupt("return",p);case 9:return l.set(o,"acquisition in progress"),v=new a.FailOpen({dynamodb:e,lockTable:"dbLocks",partitionKey:"chainId",leaseDurationMs:d||12e3,retryCount:0,owner:c,trustLocalTime:!0}),n.prev=11,n.next=14,h("dbLocks",{chainId:o});case 14:if(!(g=n.sent)||1===g.leaseDurationMs){n.next=23;break}if(y=g.lockAcquiredTimeUnixMs,m=g.leaseDurationMs,2e3,Date.now()-y>m+2e3){n.next=23;break}return t("lock not available ".concat(o)),n.abrupt("return");case 23:return b=s(v.acquireLock).bind(v),n.next=26,b(o);case 26:return k=n.sent,x=k.fencingToken,t("locked ".concat(o," with fencing token: ").concat(x)),w=function(){var e=i(r.mark((function e(){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=s(k.release).bind(k),e.next=4,n();case 4:t("released lock for ".concat(o)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t("failed to release lock for ".concat(o," ").concat(e.t0.message));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),I=k._guid.toString("base64"),C={uuid:I,tryRelease:w},l.set(o,C),t("lock complete"),n.abrupt("return",I);case 37:return n.prev=37,n.t0=n.catch(11),t("failed to lock: ".concat(o," %O"),n.t0),"string"===typeof l.get(o)&&l.delete(o),n.abrupt("return");case 43:case"end":return n.stop()}}),n,null,[[11,37]])})));return function(e,t,r){return n.apply(this,arguments)}}(),p=function(){var e=i(r.mark((function e(n,i){var a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:if(l.has(n)){e.next=5;break}return t("unknown lock for ".concat(n)),e.abrupt("return",!1);case 5:return a=l.get(n),e.abrupt("return",a.uuid===i);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=l.get(t)).uuid!==n){e.next=6;break}return e.next=4,i.tryRelease();case 4:return l.delete(t),e.abrupt("return");case 6:throw new Error("invalid lock: ".concat(t," ").concat(n));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var t=i(r.mark((function t(n,i){var a,s,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={TableName:n,Key:i,ConsistentRead:!0,ReturnConsumedCapacity:"TOTAL"},t.next=3,e.get(a).promise();case 3:return s=t.sent,s.ConsumedCapacity,o=s.Item,t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return{tryAcquire:d,isValid:p,release:f}}}},2314:function(e,t,n){var r=n(9),i=n(10);e.exports={toFunctions:function(e){return{putSocket:function(t){return e.push({type:"PUT_SOCKET",payload:t})},getSockets:function(t){return e.push({type:"GET_SOCKETS",payload:t})},delSocket:function(t){return e.push({type:"DEL_SOCKET",payload:t})},putPoolInterblock:function(t){return e.push({type:"POOL",payload:t})},putLockChain:function(t){return e.push({type:"LOCK",payload:t})},putUnlockChain:function(t){return e.push({type:"UNLOCK",payload:t})},getLineage:function(t){return e.push({type:"LINEAGE",payload:t})},getIsAnyAffected:function(t){return e.push({type:"ANY_AFFECTED",payload:t})},getAffected:function(t){return e.push({type:"AFFECTED",payload:t})},getIsPresent:function(t){return e.push({type:"IS_PRESENT",payload:t})},getBlock:function(t){return e.push({type:"GET_BLOCK",payload:t})},putPierceRequest:function(t){return e.push({type:"PIERCE_REQ",payload:t})},putPierceReply:function(t){return e.push({type:"PIERCE_REP",payload:t})}}},fromFunctions:function(e){return function(){var t=i(r.mark((function t(n){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.type,t.next="PUT_SOCKET"===t.t0?3:"GET_SOCKETS"===t.t0?4:"DEL_SOCKET"===t.t0?5:"POOL"===t.t0?6:"LOCK"===t.t0?7:"UNLOCK"===t.t0?8:"LINEAGE"===t.t0?9:"ANY_AFFECTED"===t.t0?10:"AFFECTED"===t.t0?11:"IS_PRESENT"===t.t0?12:"GET_BLOCK"===t.t0?13:"PIERCE_REQ"===t.t0?14:"PIERCE_REP"===t.t0?15:16;break;case 3:return t.abrupt("return",e.putSocket(n.payload));case 4:return t.abrupt("return",e.getSockets(n.payload));case 5:return t.abrupt("return",e.delSocket(n.payload));case 6:return t.abrupt("return",e.putPoolInterblock(n.payload));case 7:return t.abrupt("return",e.putLockChain(n.payload));case 8:return t.abrupt("return",e.putUnlockChain(n.payload));case 9:return t.abrupt("return",e.getLineage(n.payload));case 10:return t.abrupt("return",e.getIsAnyAffected(n.payload));case 11:return t.abrupt("return",e.getAffected(n.payload));case 12:return t.abrupt("return",e.getIsPresent(n.payload));case 13:return t.abrupt("return",e.getBlock(n.payload));case 14:return t.abrupt("return",e.putPierceRequest(n.payload));case 15:return t.abrupt("return",e.putPierceReply(n.payload));case 16:throw new Error("Unknown action type: ".concat(n&&n.type));case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}},2315:function(e,t,n){var r=n(9),i=n(10),a=n(15),s=n(12),o=n(18)("interblock:cfg:increasor"),c=(n(51),n(70).assign),u=n(25),l=u.channelModel,d=u.lockModel,p=u.addressModel,f=u.dmzModel,h=u.blockModel,v=u.interblockModel,g=(u.networkModel,u.rxRequestModel),y=u.txReplyModel,m=n(88),b=m.blockProducer,k=m.lockProducer,x=b.generateNext,w=n(2316).definition,I=n(123),C=n(280),M=n(390),R=n(2317).isolatorConfig,E=n(282).pure,P=function(e,t){var n=e.piercings,r=n.requests,i=n.replies,a=t.piercings,s=a.requests,o=a.replies;return{requests:r.filter((function(e){return!s.some((function(t){return t.equals(e)}))})),replies:i.filter((function(e){return!o.some((function(t){return t.equals(e)}))}))}},O=function(e,t){return e.interblocks.filter((function(e){return!t.network.includesInterblock(e)}))},A=function(e,t){if(!e[".@@io"])return!1;var n=e[".@@io"],r=t[".@@io"]||l.create();return n.isTxGreaterThan(r)};e.exports={increasorConfig:function(e,t,n){var u=I.toFunctions(t),m=C.toFunctions(e),b=M.toFunctions(n),q=R(b,u),j={actions:{assignLock:c({lock:function(e,t){o("assignLock");var n=t.data.lock;return s(d.isModel(n)),n}}),reviveCache:c({cachedDmz:function(e){var t=e.cache,n=e.lock;s(d.isModel(n)),s(n.block);var r=n.block.getChainId();s(t.has(r));var i=t.get(r).nextDmz;return o("reviveCache.nextDmz"),i},lock:function(e){var t=e.cache,n=e.lock,r=n.block.getChainId();s(t.has(r));var i=t.get(r),c=i.lock,u=i.nextDmz;s(n.block.equals(c.block));var l=O(n,u),p=P(n,c);return o("reviveCache.lock"),d.clone(a(a({},n),{},{interblocks:l,piercings:p}))}}),assignNextDmz:c({nextDmz:function(e,t){var n=t.data.dmz;return s(f.isModel(n)),n}}),assignContainerId:c({containerId:function(e,t){var n=t.data.containerId;return s(!n||"string"===typeof n),o("assignContainerId: ",n),n}}),assignBlock:c({block:function(e,t){var n=t.data.nextBlock;return s(h.isModel(n)),n}}),reconcileLock:c({nextLock:function(e){var t=e.lock,n=e.block;s(d.isModel(t)),s(h.isModel(n)),o("reconcileLock");var r=k.reconcile(t,n);return r}}),clearCache:function(e){var t=e.lock,n=e.cache;s(d.isModel(t)),s(t.block);var r=t.block.getChainId();n.delete(r),o("clearCache: ",r.substring(0,9))},repeatLock:c({nextLock:function(e){return e.lock}}),cachePartial:function(e){var t=e.cache,n=e.lock,r=e.nextDmz;s(d.isModel(n)),s(n.block),s(f.isModel(r));var i=n.block.getChainId();t.set(i,{lock:n,nextDmz:r}),o("cachePartial: ",i.substring(0,9))},assignIsRedriveRequired:c({isRedriveRequired:function(e,t){var n=e.isRedriveRequired;s(!n);var r=t.data.effectsReplyCount;s(Number.isInteger(r)),s(r>=0);var i=!!r;return o("isRedriveRequired",i),i}}),assignTxInterblocks:c({txInterblocks:function(e){var t=e.block,n=e.lock;o("txInterblocks");var r=n.block;s(h.isModel(t)),s(h.isModel(r)),s(!t.provenance.address.isGenesis());var i=r.network,a=t.network.txInterblockAliases(i).map((function(e){return v.create(t,e)}));return o("txInterblocks raw length: ".concat(a.length)),a.push(v.create(t)),a}})},guards:{isLockAcquired:function(e,t){var n=!1,r=t.data.lock;return r&&(s(d.isModel(r)),s(r.block,"Missing chain locked"),n=!!r.block),o("isLockAcquired: ",n),n},isProposer:function(){return!0},isValidator:function(){return!1},isIncreasable:function(e){var t=e.cache,n=e.lock;s(d.isModel(n)),s(n.block);var r=n.interblocks.some((function(e){return!!e.getOriginAlias()})),i=n.piercings,a=i.requests,c=i.replies;if(!(a.length||c.length)&&!r)return o("isIncreasable: ",!1),!1;var u=n.block.getChainId();if(!t.has(u))return o("isIncreasable: ",!0),!0;var l=t.get(u),p=l.lock,h=l.nextDmz;s(d.isModel(p)),s(p.block),s(f.isModel(h));var v=P(n,p),g=v.requests.length,y=v.replies.length;return g||y||O(n,h).some((function(e){return!!e.getOriginAlias()}))?(o("isIncreasable: ",!0),!0):(o("isIncreasable: ",!1),!1)},isCacheEmpty:function(e){var t=e.cache,n=e.lock;s(d.isModel(n)),s(n.block);var r=!t.has(n.block.getChainId());return o("isCacheEmpty: ",r),r},isIsolationComplete:function(e){var t=!!e.nextDmz;return o("isIsolationComplete: ".concat(t)),t},isDmzTransmitting:function(e){var t=e.lock,n=e.nextDmz;s(d.isModel(t)),s(f.isModel(n));var r=n.network;s(t.block,"increasor never makes a new chain");var i=t.block.network,a=r.txInterblockAliases(i),c=A(r,i),u=a.length||c;return o("isDmzTransmitting: ".concat(u)),u},isNewBlock:function(e){var t=e.block,n=!!t&&h.isModel(t);return o("isNewBlock: ".concat(n)),n},isNoNextDmz:function(e){return!e.nextDmz},isEffectable:function(e){var t=e.block,n=e.containerId;s(h.isModel(t)),s.strictEqual(typeof n,"string");var r=t.config.isPierced&&n;return o("isEffectable %o",r),r}},services:{lockChain:function(){var e=i(r.mark((function e(t,n){var i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.payload,o("lockChain ".concat(i.getChainId().substring(0,9))),s(p.isModel(i)),e.next=5,u.putLockChain(i);case 5:return a=e.sent,e.abrupt("return",{lock:a});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),isolatedExecution:function(){var e=i(r.mark((function e(t){var n,i,a,o,c,u,l,d,p;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lock,i=t.cachedDmz,a={type:"EXECUTE_COVENANT",payload:{lock:n,cachedDmz:i}},o=q.machine,c=q.config,u=function(){return E(a,o,c)},e.next=6,u();case 6:return l=e.sent,d=l.dmz,p=l.containerId,s(f.isModel(d)),e.abrupt("return",{dmz:d,containerId:p});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),signBlock:function(){var e=i(r.mark((function e(t){var n,i,a,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lock,i=t.nextDmz,s(f.isModel(i)),s(d.isModel(n)),a=n.block,s(a),e.next=7,x(i,a,m.sign);case 7:return o=e.sent,e.abrupt("return",{nextBlock:o});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),effects:function(){var e=i(r.mark((function e(t){var n,a,c,d,p,f,h,v;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.containerId,a=t.nextLock,c=t.lock,s.strictEqual(typeof n,"string"),s(a.block),s(!a.block.equals(c.block)),o("effects"),d=l.create(),c.block&&c.block.network[".@@io"]&&(d=c.block.network[".@@io"]),p=a.block.network[".@@io"]||d,f=p.getRequestIndices().filter((function(e){return!d.requests[e]})),o("nextIoIndices: ",f),3e4,h=f.map(function(){var e=i(r.mark((function e(t){var i,c,l,d,f,h,v,m,k;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=p.requests[t],s(i&&i.payload),c=i.payload[".@@ioRequestId"],s.strictEqual(typeof c,"string"),l=i.type,d=i.payload,f=a.block.provenance.getAddress(),h=g.create(l,d,f,t),v=h.sequence,e.prev=8,e.next=11,b.executeEffect({containerId:n,effectId:c,timeout:3e4});case 11:k=e.sent,o("effects payload: ",k),m=y.create("@@RESOLVE",k,v),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),m=y.create("@@REJECT",e.t0,v);case 19:return e.next=21,u.putPierceReply({txReply:m});case 21:return o("reply address:",m.getAddress().getChainId()),e.abrupt("return",m);case 23:case"end":return e.stop()}}),e,null,[[8,16]])})));return function(t){return e.apply(this,arguments)}}()),e.next=14,Promise.all(h);case 14:return v=e.sent,o("settlements: ",v),e.next=18,b.unloadCovenant(n);case 18:return e.abrupt("return",{effectsReplyCount:v.length});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unlockChain:function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.nextLock,s(d.isModel(n)),o("unlockChain"),e.next=5,u.putUnlockChain(n);case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};return{machine:w,config:j}}}},2316:function(e,t,n){var r={id:"increasor",initial:"idle",context:{cache:new Map,lock:void 0,nextLock:void 0,block:void 0,nextDmz:void 0,txInterblocks:[],containerId:"",isRedriveRequired:!1,cachedDmz:void 0},strict:!0,states:{idle:{on:{INCREASE_CHAIN:"lockChain"}},lockChain:{invoke:{src:"lockChain",onDone:[{target:"execute",cond:"isLockAcquired",actions:"assignLock"},{target:"done"}]}},execute:{initial:"isProposer",states:{isProposer:{always:[{target:"proposeNext",cond:"isProposer"},{target:"validateNext",cond:"isValidator"},{target:"done"}]},proposeNext:{initial:"isIncreasable",states:{isIncreasable:{always:[{target:"reviveCache",cond:"isIncreasable"},{target:"done"}]},reviveCache:{always:[{target:"isIsolationComplete",cond:"isCacheEmpty"},{target:"isIsolationComplete",actions:"reviveCache"}]},isIsolationComplete:{always:[{target:"isDmzTransmitting",cond:"isIsolationComplete"},{target:"isolate"}]},isolate:{invoke:{src:"isolatedExecution",onDone:{target:"isIsolationComplete",actions:["assignNextDmz","assignContainerId"]}}},isDmzTransmitting:{always:[{target:"signBlock",cond:"isDmzTransmitting"},{target:"done"}]},signBlock:{invoke:{src:"signBlock",onDone:{target:"done",actions:"assignBlock"}}},done:{type:"final"}},onDone:"done"},validateNext:{},done:{type:"final"}},onDone:"unlockChain"},unlockChain:{initial:"isNewBlock",states:{isNewBlock:{always:[{target:"effects",cond:"isNewBlock",actions:["reconcileLock","clearCache"]},{target:"isNextDmz",actions:"repeatLock"}]},isNextDmz:{always:[{target:"unlockChain",cond:"isNoNextDmz"},{target:"unlockChain",actions:"cachePartial"}]},effects:{initial:"isEffectable",states:{isEffectable:{always:[{target:"executeEffects",cond:"isEffectable"},{target:"done"}]},executeEffects:{invoke:{src:"effects",onDone:{target:"done",actions:"assignIsRedriveRequired"}}},done:{type:"final"}},onDone:"unlockChain"},unlockChain:{invoke:{src:"unlockChain",onDone:"done"}},done:{type:"final"}},onDone:[{target:"done",cond:"isNewBlock",actions:"assignTxInterblocks"},{target:"done"}]},done:{data:function(e){return{txInterblocks:e.txInterblocks,isRedriveRequired:e.isRedriveRequired}},type:"final"}}};e.exports={definition:r}},2317:function(e,t,n){var r=n(9),i=n(10),a=n(15),s=n(12),o=n(51),c=n(18)("interblock:cfg:isolator"),u=n(70).assign,l=n(282).pure,d=n(25),p=d.channelModel,f=d.interblockModel,h=d.blockModel,v=d.provenanceModel,g=d.dmzModel,y=d.lockModel,m=d.keypairModel,b=d.pierceSigner,k=n(88),x=k.networkProducer,w=k.channelProducer,I=n(2319).interpreterConfig,C=n(2332).definition,M=n(117),R=m.create("PIERCE",M.pierceKeypair),E=function(e){var t=e.dmz;s(g.isModel(t));var n=t.rx();return c("isReduceable",n&&n.event.type),!!n},P=function(e){var t=e.dmz,n=e.hasPierced;s(g.isModel(t));var r=t.config.isPierced&&!n;return c("isPiercable: %O",r),r},O=o.memoize((function(e){var t=R.getValidatorEntry(),n=g.create({validators:t}),r=e.provenance.getAddress(),i=p.create(r,"PIERCE");if(e.network[".@@io"]&&e.network[".@@io"].address.isResolved()){var o=e.network[".@@io"],c=o.getRemote();s(c&&c.address.equals(r));var u=c.requests,l=c.replies,d=o.getRemoteRequestIndices(),h=d.length?d.pop()+1:0,v=a(a({},i),{},{requests:u,replies:l,requestsLength:h});i=p.clone(v);var y=f.create(e,".@@io");for(i=w.ingestPierceInterblock(i,y);i.rxReply();)i=w.shiftTxRequest(i)}var m=a(a({},n.network),{},{"@@PIERCE_TARGET":i});return g.clone(a(a({},n),{},{network:m}))})),A=function(e){var t=e.network[".@@io"];if(t){var n=t.heavy.provenance;return s(v.isModel(n)),n}},q=function(e,t){return function(n,r,i){return t({containerId:e,state:n,action:r,accumulator:i,timeout:3e4})}};e.exports={isolatorConfig:function(e,t){c("isolatorConfig");var n=function(e,t){return{actions:{assignLock:u({lock:function(e,t){var n=t.payload.lock;return s(y.isModel(n)),s(n.block,"can only isolate for existing chains"),n}}),assignDmz:u({dmz:function(e,t){var n=e.lock;s(y.isModel(n)),s(n.block);var r=t.payload.cachedDmz;return r?(s(g.isModel(r)),c("assignDmz using cache"),r):(c("assignDmz using lock"),n.block.getDmz())}}),ingestInterblocks:u({dmz:function(e){var t=e.lock,n=e.dmz;s(y.isModel(t)),s(g.isModel(n));var r=t.interblocks,i=t.block.config,o=x.ingestInterblocks(n.network,r,i);return g.clone(a(a({},n),{},{network:o}))}}),assignGenesisInterblock:u({interblock:function(e){var t=e.lock;s(y.isModel(t));var n=t.interblocks[0];return s(n.isGenesisAttempt(),"Not genesis attempt"),c("assignGenesisInterblock"),n}}),connectToParent:u({dmz:function(e){var t=e.dmz,n=e.interblock;s(g.isModel(t)),s(t.network[".."].address.isUnknown(),"Target connected"),c("connectToParent");var r=n.provenance.getAddress(),i=t.network[".."];i=w.setAddress(i,r);var o=a(a({},t.network),{},{"..":i});return g.clone(a(a({},t),{},{network:o}))}}),ingestParentLineage:u({dmz:function(e,t){var n=e.dmz,r=t.data.lineage;s(Array.isArray(r)),s(r.every(f.isModel)),c("ingestParentLineage length: ".concat(r.length));var i=x.ingestInterblocks(n.network,r,n.config);return g.clone(a(a({},n),{},{network:i}))}}),assignContainerId:u({containerId:function(e,t){var n=t.data.containerId;return s(n),n}}),updateDmz:u({dmz:function(e,t){c("updateDmz");var n=t.data.nextDmz;return s(g.isModel(n)),n}}),generatePierceDmz:u({pierceDmz:function(e){var t=e.lock;s(y.isModel(t)),s(t.block);var n=t.block,r=t.piercings,i=O(t.block),o=i.network["@@PIERCE_TARGET"];return s(o.address.equals(n.provenance.getAddress())),s.strictEqual(o.systemRole,"PIERCE"),c("generatePierceDmz piercings.length: ",r.length),r.requests.forEach((function(e){var t=e.getRequest();o=w.txRequest(o,t)})),r.replies.forEach((function(e){s(e.getAddress().equals(o.address));var t=e.getReply(),n=e.getIndex();o=w.txReply(o,t,n)})),network=a(a({},i.network),{},{"@@PIERCE_TARGET":o}),i=g.clone(a(a({},i),{},{network:network}))}}),assignHasPierced:u({hasPierced:function(){return!0}}),openPierceChannel:u({dmz:function(e,t){var n=e.dmz;c("openPierceChannel");var r=t.data.pierceBlock;s(h.isModel(r)),s(g.isModel(n));var i=r.provenance.getAddress(),o=n.network[".@@io"]||p.create(i,"PIERCE");o.address.isUnknown()&&(o=w.setAddress(o,i));var u=o.address;s(u.equals(i)),s.strictEqual(o.systemRole,"PIERCE");var l=a(a({},n.network),{},{".@@io":o});return g.clone(a(a({},n),{},{network:l}))}}),ingestPierceBlock:u({dmz:function(e,t){var n=e.dmz;c("ingestPierceBlock");var r=t.data.pierceBlock;s(h.isModel(r)),s(g.isModel(n));var i=f.create(r,"@@PIERCE_TARGET"),o=x.ingestInterblocks(n.network,[i],n.config);return s(i.equals(o[".@@io"].heavy)),g.clone(a(a({},n),{},{network:o}))}}),unassignContainerId:u({containerId:function(){return""}})},guards:{isGenesis:function(e){var t=e.lock;s(y.isModel(t)),s(t.block);var n=t.block,r=!n.network[".."].address.isRoot(),i=n.provenance.address.isGenesis()&&r;return c("isGenesis: ",i),i},verifyLineage:function(e,t){var n=e.interblock,r=t.data.lineage;return s(r.length),s.strictEqual(n.getChainId(),r[0].getChainId()),s(!r[0].provenance.height),c("verifyLineage"),!0},isDmzChangeable:function(e){var t=e.lock;s(y.isModel(t)),s(t.block);var n=P(e)&&t.isPiercingsPresent(),r=E(e)||n;return c("isDmzChangeable: ".concat(r)),r},isReduceable:E,isPiercable:P,isPierceDmzChanged:function(e){var t=e.lock,n=e.pierceDmz;if(!n)return c("isPierceDmzChanged: ",n),!1;s(y.isModel(t)),s(t.block),s(g.isModel(n));var r=O(t.block).network["@@PIERCE_TARGET"],i=n.network["@@PIERCE_TARGET"].isTxGreaterThan(r);return c("isPierceDmzChanged: %o",i),i},isPierceChannelUnopened:function(e){var t=e.dmz;s(g.isModel(t));var n=t.network[".@@io"],r=n&&!n.address.isResolved();return c("isPierceChannelUnopened",r),r},isCovenantEffectable:function(e){var t=e.lock,n=e.dmz;s(y.isModel(t)),s(g.isModel(n));var r=p.create();t.block&&t.block.network[".@@io"]&&(r=t.block.network[".@@io"]);var i=(n.network[".@@io"]||r).getRequestIndices().filter((function(e){return!r.requests[e]})).length;return c("isCovenantEffectable",i),i}},services:{fetchParentLineage:function(){var e=i(r.mark((function e(n){var i,a,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(f.isModel(i)),a=i.provenance,e.next=5,t.getLineage({provenance:a});case 5:return o=e.sent,s(Array.isArray(o)),s(o.every(f.isModel)),s.strictEqual(o[0].provenance.height,0),c("fetchParentLineage length: ".concat(o.length)),e.abrupt("return",{lineage:o});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),loadCovenant:function(){var t=i(r.mark((function t(n){var i,a;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.lock,s(y.isModel(i)),t.next=4,e.loadCovenant(i.block);case 4:return a=t.sent,c("loadCovenant containerId: ".concat(a.substring(0,9))),t.abrupt("return",{containerId:a});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),reduce:function(){var t=i(r.mark((function t(n){var i,a,o,u,d,p,f,h,v,y,m,b,k;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.dmz,a=n.containerId,s(g.isModel(i)),s(i.rx()),o=i.rx(),u=o.event,d=o.channel,c("reduce: ",u.type),p=d.address,s(!p.isUnknown()),f=q(a,e.tick),h=I(f),v=h.machine,y=h.config,m={type:"TICK",payload:{dmz:i,externalAction:u,address:p}},b=function(){return l(m,v,y)},t.next=14,b();case 14:return k=t.sent,s(g.isModel(k)),t.abrupt("return",{nextDmz:k});case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),signPierceDmz:function(){var e=i(r.mark((function e(t){var n,i,o,u,l,d,p;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pierceDmz,i=t.lock,s(g.isModel(n)),s(y.isModel(i)),o=i.block,s(o),u=A(o),c("signPierceDmz with previous: %O",!!u),l={},e.next=10,v.create(n,u,l,b);case 10:return d=e.sent,p=h.clone(a(a({},n),{},{provenance:d})),e.abrupt("return",{pierceBlock:p});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unloadCovenant:function(){var t=i(r.mark((function t(n){var i;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.containerId,c("unloadCovenant containerId: %o",i.substring(0,9)),t.next=4,e.unloadCovenant(i);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}}(e,t);return{machine:C,config:n}}}},2318:function(e,t,n){var r=n(54),i=n(121),a=n(9),s=n(15),o=n(34),c=n(10),u=n(12),l=n(51),d=n(18)("interblock:xstate:pure"),p=function(e){var t=e||{};return{getContext:function(){return t},setContext:function(e){t=e}}},f=function(){var e=c(a.mark((function e(t,n){var l,f,v,g,y,m,b,k,x,w,I,C,M,R,E,P,O,A,q,j,S,T,D,L,N,z,_,B,K,F=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=F.length>2&&void 0!==F[2]?F[2]:{},u.strictEqual(typeof l,"object"),"string"===typeof t&&(t={type:t}),f=p(n.context),v=function(e){return m(e).grandparent},g=function(e){return m(e).parent},y=function(e){return m(e).node},m=function(e){var t,r,i=o(h(e.value)),a=n;do{r=t,t=a,a=a.states[i.shift()]}while(i.length);return{grandparent:r,parent:t,node:a}},b=function(e,t){return x(e,t,"entry")},k=function(e,t){return x(e,t,"exit")},x=function(e,t,n){var r=y(e)[n];return d("actions property:",n),w(e,t,r)},w=function(e,t,n){if(!n)return e;var r=[];"string"===typeof n?r.push(n):(u(Array.isArray(n)),r.push.apply(r,o(n))),d("execActions: ",r);for(var i=0,a=r;i<a.length;i++){var c=a[i],p=l.actions[c];if(u(p,"No action found for: ".concat(c)),"xstate.assign"===p.type){var h=s({},f.getContext());if("function"===typeof p.assignment)h=p.assignment(h,t);else{u("object"===typeof p.assignment);for(var v=0,g=Object.keys(p.assignment);v<g.length;v++){var y=g[v];h[y]=p.assignment[y](h,t)}}f.setContext(h)}else u.strictEqual(typeof p,"function"),p(f.getContext(),t)}return e},I=function(e){return!!y(e).invoke},C=function(){var e=c(a.mark((function e(t,n){var r,i,s,o;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=y(t),!(i=r.invoke)){e.next=21;break}return d("asyncFunction name: %o",r.invoke.src),s=l.services[i.src],u.strictEqual(typeof s,"function"),e.prev=6,e.next=9,s(f.getContext(),n);case 9:return o=e.sent,n={type:"done.invoke.".concat(i.src),data:o},t=R(t,n),e.abrupt("return",{state:t,event:n});case 15:return e.prev=15,e.t0=e.catch(6),d("invoke error: %o",e.t0.message),n={type:"error.invoke.".concat(i.src),data:e.t0},t=R(t,n),e.abrupt("return",{state:t,event:n});case 21:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t,n){return e.apply(this,arguments)}}(),M=function(e){u(q(e));var t=y(e),n={target:e.value+"."+t.initial};return d("resolveNestedState",n),s(s({},e),{},{transition:n})},R=function(e,t){u(!e.transition);var n,a=y(e);if(I(e)){if(t.type.startsWith("done.invoke"))n=a.invoke.onDone;else if(!(n=a.invoke.onError))throw t.data}else if(a.always)n=a.always;else if(O(e)&&!j(e)){u(e.value.includes(".")),n=g(e).onDone}else if(A(e))u(a.onDone),n=a.onDone;else{if(!a.on)return e;if(!(n=a.on[t.type]))throw new Error("State ".concat(e.value," does not accept ").concat(t.type))}if(!n){e.transition;return i(e,["transition"])}"string"===typeof n&&(n={target:n}),Array.isArray(n)||(n=[n]),n=n.map((function(t){return E(e,t)})),d("resolveTransition",n);var o,c=r(n);try{for(c.s();!(o=c.n()).done;){var p=o.value,h=p.cond;if(!h)return s(s({},e),{},{transition:p});var v=l.guards[h];if(u.strictEqual(typeof v,"function",h),v(f.getContext(),t))return s(s({},e),{},{transition:p})}}catch(m){c.e(m)}finally{c.f()}throw new Error("No transition possible - event swallowed")},E=function(e,t){"string"===typeof t&&(t={target:t});var n=t.target;if(!n.startsWith(".")&&e.value.includes(".")){var r=o(h(e.value));r.pop(),O(e)&&r.pop(),r.push(n),n=r.join("."),t=s(s({},t),{},{target:n})}return n.startsWith(".")&&(n=e.value+n,t=s(s({},t),{},{target:n})),t},P=function(e){return!!e.transition},O=function(e){return"final"===y(e).type},A=function(e){return"parallel"===y(e).type},q=function(e){return y(e).initial},j=function(e){return O(e)&&!e.value.includes(".")},S=function(e){var t=v(e);return t&&"parallel"===t.type},T=function(e,t){d("doneData");var n=y(e).data||function(){};return u.strictEqual(typeof n,"function"),n(f.getContext(),t)},D=d.extend("parallel"),L=function(){var e=c(a.mark((function e(t,n){var r,i,s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s in D("parallel start",t.value),r=y(t),u.strictEqual(typeof r.states,"object"),D("node: ",r),i=[],r.states)i.push(N(t,s));return e.next=8,Promise.all(i);case 8:return n={type:"done.parallel.(".concat(t.value,")")},t=R(t,n),D("parallel complete: ",t.value),e.abrupt("return",{state:t,event:n});case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=c(a.mark((function e(n,r){var i,o;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=z(n,r),D("transition: ",i),o=s(s({},n),{},{transition:i}),o=B(o,t),D("substate prior: ",o.value),e.next=7,_(o,t);case 7:o=e.sent,D("substate settled: ",o.value),u(O(o));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=function(e,t){"string"===typeof t&&(t={target:t});var n=t.target;return u(A(e)),t=s(s({},t),{},{target:e.value+"."+n})},_=function(){var e=c(a.mark((function e(t,n){var r,i,o;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.value,!((i=t.watchdog)>500)){e.next=4;break}throw new Error("endless loop: ".concat(i));case 4:if(d("loop ".concat(++i," stateValue: %o"),r),t=s(s({},t),{},{watchdog:i}),!I(t)){e.next=14;break}return e.next=9,C(t,n);case 9:o=e.sent,t=o.state,n=o.event,e.next=23;break;case 14:if(!A(t)){e.next=22;break}return e.next=17,L(t,n);case 17:result=e.sent,t=result.state,n=result.event,e.next=23;break;case 22:t=q(t)?M(t):R(t,n);case 23:if(!P(t)){e.next=27;break}return t=k(t,n),t=B(t,n),e.abrupt("return",_(t,n));case 27:if(!j(t)){e.next=32;break}if("error"!==t.value){e.next=30;break}throw n.data;case 30:return d("isDone",t),e.abrupt("return",T(t,n));case 32:if(!S(t)){e.next=34;break}return e.abrupt("return",t);case 34:throw d("Error state: ",t),d("Error event: ",n),new Error("Settled on not final state: ".concat(t.value));case 37:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),B=function(e,t){u(e.transition),d("makeTransition event: %o trans: %o",t.type,e.transition),e=s(s({},e),{},{value:e.transition.target}),u(y(e),"missing state node: ".concat(e.value));var n=e.transition.actions;return delete e.transition,e=w(e,t,n),e=b(e,t),d("transition complete to: %o",e.value),e},K={value:void 0,transition:{target:n.initial},watchdog:0},K=B(K,{type:"xstate.init"}),e.abrupt("return",_(K,t));case 34:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=l.memoize((function(e){return e.split(".")}));e.exports={pure:f}},2319:function(e,t,n){var r=n(9),i=n(10),a=n(15),s=n(12),o=n(18)("interblock:cfg:heart"),c=(n(2320).detailedDiff,n(282).pure),u=n(25),l=u.rxReplyModel,d=u.rxRequestModel,p=u.addressModel,f=u.dmzModel,h=n(88).networkProducer,v=n(103),g=n(2323).definition,y=n(2324).directConfig,m=n(2326).pendingConfig,b=n(2328).autoResolvesConfig,k=n(2330).dmzConfig,x=n(70).assign,w={actions:{assignExternalAction:x({externalAction:function(e,t){var n=t.payload.externalAction;return n}}),assignDmz:x({dmz:function(e,t){var n=t.payload,r=n.dmz,i=n.address;return s(f.isModel(r)),s(r.network.getAlias(i)),r},initialPending:function(e,t){var n=t.payload.dmz;return s(f.isModel(n)),n.pending}}),assignAnvil:x({anvil:function(e,t){var n=t.payload,r=n.externalAction,i=n.address,a=r;s(d.isModel(a)||l.isModel(a)),s(p.isModel(i)),d.isModel(a)&&s(a.getAddress().equals(i));var c=i.isInvalid()?"INVALID":i.getChainId();return o("interpreterConfig type: %o chainId: %o",a.type,c),a},address:function(e,t){var n=t.payload.address;s(p.isModel(n));var r=n.isInvalid();return s(n.isResolved()||n.isLoopback()||r),n}}),loadSelfAnvil:x({anvil:function(e){var t=e.dmz.network.rxSelf();return o("loadSelfAnvil anvil: %o",t.type),t},address:function(e){var t=e.dmz.network["."].address;return s(t.isLoopback()),o("loadSelfAnvil selfAddress: %o",t.getChainId()),t}}),openPaths:x({dmz:function(e){var t=e.dmz;s(f.isModel(t)),o("openPaths");var n=v.openPaths(t.network);return f.clone(a(a({},t),{},{network:n}))}}),invalidateLocalPaths:x({dmz:function(e){var t=e.dmz;s(f.isModel(t)),o("invalidateLocalPaths");var n=h.invalidateLocal(t.network);return f.clone(a(a({},t),{},{network:n}))}}),removeEmptyInvalidChannels:x({dmz:function(e){var t=e.dmz;s(f.isModel(t));var n=h.reaper(t.network),r=Object.keys(t.network).length,i=Object.keys(n).length;return o("removeEmptyInvalidChannels removed: ".concat(r-i)),f.clone(a(a({},t),{},{network:n}))}}),assertLoopbackEmpty:function(e){var t=e.dmz;o("assertLoopbackEmpty");var n=t.network["."];s(!n.rxRequest()),s(!n.rxReply())},assignDirectMachine:x((function(e,t){s(!t.data.then);var n=a(a({},e),t.data);return o("assignDirectMachine"),n}))},guards:{isSelfExhausted:function(e){var t=!e.dmz.network.rxSelf();return o("isSelfExhausted: ".concat(t)),t},isSystem:function(e){var t=e.anvil;s(d.isModel(t)||l.isModel(t));var n=v.isSystemReply(t)||v.isSystemRequest(t);return o("isSystem: ".concat(n)),n},isPending:function(e){var t=e.dmz.pending.getIsPending();return o("isPending",t),t}},services:{direct:function(){var e=i(r.mark((function e(t){var n,i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("direct machine"),n=y(t),i=n.machine,a=n.config,e.next=4,c("EXEC",i,a);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pending:function(){var e=i(r.mark((function e(t){var n,i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("pending machine"),n=m(t),i=n.machine,a=n.config,e.next=4,c("EXEC",i,a);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),autoResolves:function(){var e=i(r.mark((function e(t){var n,i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("autoResolves machine"),n=b(t),i=n.machine,a=n.config,e.next=4,c("EXEC",i,a);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),dmz:function(){var e=i(r.mark((function e(t){var n,i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("dmz machine"),n=k(t),i=n.machine,a=n.config,e.next=4,c("EXEC",i,a);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};e.exports={interpreterConfig:function(e){return s.strictEqual(typeof e,"function"),{machine:a(a({},g),{},{context:{isolatedTick:e}}),config:w}}}},2323:function(e,t,n){var r={id:"interpreter",initial:"idle",context:{isolatedTick:void 0,externalAction:void 0,anvil:void 0,address:void 0,dmz:void 0,initialPending:void 0,covenantAction:void 0,reduceRejection:void 0,reduceResolve:void 0,isExternalPromise:void 0,isOriginPromise:void 0},strict:!0,states:{idle:{on:{TICK:{target:"interpret",actions:["assignExternalAction","assignDmz","assignAnvil"]}}},loopback:{always:[{target:"autoResolves",cond:"isSelfExhausted"},{target:"interpret",actions:"loadSelfAnvil"}]},interpret:{always:[{target:"interpretDmz",cond:"isSystem"},{target:"interpretCovenant"}]},interpretDmz:{invoke:{src:"dmz",onDone:{target:"loopback",actions:"assignDirectMachine"}}},interpretCovenant:{initial:"isPending",states:{isPending:{always:[{target:"pending",cond:"isPending"},{target:"direct"}]},pending:{invoke:{src:"pending",onDone:{target:"done",actions:"assignDirectMachine"}}},direct:{invoke:{src:"direct",onDone:{target:"done",actions:"assignDirectMachine"}}},done:{type:"final"}},onDone:"loopback"},autoResolves:{invoke:{src:"autoResolves",onDone:{target:"openPaths",actions:"assignDirectMachine"}}},openPaths:{entry:["openPaths","invalidateLocalPaths","removeEmptyInvalidChannels"],always:"done"},done:{entry:"assertLoopbackEmpty",data:function(e){return e.dmz},type:"final"}}};e.exports={definition:r}},2324:function(e,t,n){var r=n(15),i=n(12),a=n(18)("interblock:cfg:heart.direct"),s=n(25),o=s.txReplyModel,c=s.rxReplyModel,u=s.rxRequestModel,l=s.dmzModel,d=(s.channelModel,s.reductionModel),p=n(88),f=p.networkProducer,h=p.pendingProducer,v=n(2325).definition,g=n(70).assign,y=(0,n(393).common)(a),m=y.transmit,b=y.respondReply,k=y.assignResolve,x=y.reduceCovenant,w=y.respondRejection,I=y.assignRejection,C=y.isLoopbackResponseDone,M=y.respondLoopbackRequest,R=y.mergeState,E=y.isAnvilNotLoopback,P={actions:{assignDirectCovenantAction:g({covenantAction:function(e){var t=e.dmz,n=e.anvil;return i(l.isModel(t)),i(u.isModel(n)||c.isModel(n)),i(!t.pending.getIsPending()),i(!t.pending.getAccumulator().length),a("assignDirectCovenantAction",n.type),n}}),warnReplyRejection:function(e){e.reduceRejection;a("warnReplyRejection")},raisePending:g({dmz:function(e){var t=e.dmz,n=e.anvil;i(l.isModel(t)),i(u.isModel(n)),i(!t.pending.getIsPending()),a("raisePending",n.type);var s=h.raisePending(t.pending,n);return l.clone(r(r({},t),{},{pending:s}))}}),assignInitialPending:g({initialPending:function(e){var t=e.dmz;return i(l.isModel(t)),i(t.pending.getIsPending()),a("assignInitialPending"),t.pending}}),promiseOriginRequest:g({dmz:function(e){var t=e.dmz,n=e.anvil,s=e.covenantAction;i(l.isModel(t)),i(u.isModel(n)),i(!s||n.equals(s));var c=n.sequence,d=o.create("@@PROMISE",{},c),p=f.tx(t.network,[],[d]);return a("promiseOriginRequest",n.type),l.clone(r(r({},t),{},{network:p}))},isExternalPromise:function(){return!0}}),shiftBufferedRequest:g({dmz:function(e){var t=e.dmz,n=e.covenantAction;a("shiftBufferedRequest",n.type),i(l.isModel(t)),i(u.isModel(n)),i(t.pending.getIsBuffered(n));var s=t.pending.rxBufferedRequest(t.network),o=s.alias,c=s.event,d=s.channel;i(t.network[o].equals(d)),i(c.equals(n));var p=n.getIndex();i(d.replies[p].isPromise());var v=f.removeBufferPromise(t.network,n),g=h.shiftRequests(t.pending,t.network);return l.clone(r(r({},t),{},{pending:g,network:v}))}}),assignResolve:k,transmit:m,mergeState:R,respondReply:b,assignRejection:I,respondRejection:w,respondLoopbackRequest:M},guards:{isPending:function(e){var t=e.dmz.pending.getIsPending();return a("isPending",t),t},isReductionPending:function(e){var t=e.reduceResolve;i(d.isModel(t));var n=t.getIsPending();return a("isReductionPending",n),n},isReply:function(e){var t=e.anvil,n=c.isModel(t);return n||i(u.isModel(t)),a("isReply: %o",n),n},isUnbufferedRequest:function(e){var t=e.dmz,n=e.covenantAction;i(l.isModel(t)),i(u.isModel(n)),i(l.isModel(t));var r=!t.pending.getIsBuffered(n);return a("isUnbufferedRequest",r),r},isAnvilNotLoopback:E,isLoopbackResponseDone:C},services:{reduceCovenant:x}};e.exports={directConfig:function(e){return i.strictEqual(typeof e,"object"),{machine:r(r({},v),{},{context:e}),config:P}}}},2325:function(e,t,n){e.exports={definition:{id:"interpreter.direct",initial:"isReply",context:{},strict:!0,states:{isReply:{entry:"assignDirectCovenantAction",always:[{target:"reply",cond:"isReply"},{target:"request"}]},reply:{initial:"reduce",states:{reduce:{invoke:{src:"reduceCovenant",onDone:{target:"isPending",actions:"assignResolve"},onError:{target:"reject",actions:"assignRejection"}}},isPending:{always:[{target:"reject",cond:"isReductionPending",actions:"assignRejection"},{target:"transmit"}]},transmit:{entry:"transmit",always:"done"},reject:{entry:"warnReplyRejection",always:"done"},done:{entry:"respondReply",type:"final"}},onDone:"done"},request:{initial:"isUnbufferedRequest",states:{isUnbufferedRequest:{always:[{target:"reduce",cond:"isUnbufferedRequest"},{target:"reduce",actions:"shiftBufferedRequest"}]},reduce:{invoke:{src:"reduceCovenant",onDone:{target:"transmit",actions:"assignResolve"},onError:{target:"reject",actions:"assignRejection"}}},transmit:{entry:"transmit",always:[{target:"raisePending",cond:"isReductionPending"},{target:"respondLoopbackRequest"}]},respondLoopbackRequest:{entry:"mergeState",always:[{target:"done",cond:"isAnvilNotLoopback"},{target:"done",cond:"isLoopbackResponseDone"},{target:"done",actions:"respondLoopbackRequest"}]},raisePending:{entry:["raisePending","promiseOriginRequest","assignInitialPending"],always:"done"},reject:{entry:"respondRejection",always:"done"},done:{type:"final"}},onDone:"done"},done:{data:function(e){return e},type:"final"}}}}},2326:function(e,t,n){var r=n(15),i=n(12),a=n(18)("interblock:cfg:heart:pending"),s=n(25),o=s.txReplyModel,c=s.rxReplyModel,u=s.rxRequestModel,l=(s.addressModel,s.dmzModel),d=(s.channelModel,s.reductionModel),p=(s.pendingModel,s.txRequestModel),f=n(88),h=f.networkProducer,v=f.pendingProducer,g=n(2327).definition,y=n(70).assign,m=(0,n(393).common)(a),b=m.transmit,k=m.assignResolve,x=m.respondReply,w=m.reduceCovenant,I=m.assignRejection,C=m.mergeState,M={actions:{bufferRequest:y({dmz:function(e){var t=e.dmz,n=e.anvil;i(l.isModel(t)),i(u.isModel(n)),a("bufferRequest: ",n.type);var s=v.bufferRequest(t.pending,n);return l.clone(r(r({},t),{},{pending:s}))}}),accumulateReply:y({dmz:function(e){var t=e.dmz,n=e.anvil;i(l.isModel(t)),i(c.isModel(n));var s=n.getRequest().type;a("accumulateReply reply: %o request: %o",n.type,s);var o=v.pushReply(t.pending,n);return l.clone(r(r({},t),{},{pending:o}))}}),shiftCovenantAction:y({covenantAction:function(e){var t=e.dmz,n=e.anvil;i(l.isModel(t)),i(c.isModel(n));var r=t.pending;i(r.getIsPending());var s=r.pendingRequest;return i(u.isModel(s)),a("shiftCovenantAction: %o",s.type),s}}),deduplicatePendingReplyTx:y({reduceResolve:function(e){var t=e.dmz,n=e.reduceResolve;i(l.isModel(t)),i(d.isModel(n));var s=n.requests,c=n.replies,u=t.network[".."].address.isRoot();return s=s.filter((function(e){i(p.isModel(e));var n=u?R(e.to):e.to,r=t.network[n];if(!r)return!0;var a=e.getRequest();return!Object.values(r.requests).some((function(e){return a.equals(e)}))})),c=c.filter((function(e){i(o.isModel(e));var n=e.getAddress(),r=e.getIndex(),a=t.network.getAlias(n);if(!a)return!0;var s=t.network[a].replies[r];return!e.getReply().equals(s)})),a("deduplicatePendingReplyTx dedupes: ",n.requests.length-s.length),d.clone(r(r({},n),{},{requests:s,replies:c}))}}),rejectOriginRequest:y({dmz:function(e){var t=e.dmz,n=e.anvil,s=e.reduceRejection,d=e.covenantAction;i(l.isModel(t)),i(c.isModel(n)),i(u.isModel(d)),i.strictEqual(typeof s,"object"),a("rejectOriginRequest",n.type,s);var p=d.sequence,f=o.create("@@REJECT",s,p),v=h.tx(t.network,[],[f]);return l.clone(r(r({},t),{},{network:v}))}}),promiseAnvil:y({dmz:function(e){var t=e.dmz,n=e.anvil;i(l.isModel(t)),i(u.isModel(n)),a("promiseanvil",n.type);var s=n.sequence,c=o.create("@@PROMISE",{},s),d=h.tx(t.network,[],[c]);return l.clone(r(r({},t),{},{network:d}))}}),settlePending:y({dmz:function(e){var t=e.dmz;i(l.isModel(t)),i(t.pending.getIsPending()),a("settlePending");var n=v.settle(t.pending);return l.clone(r(r({},t),{},{pending:n}))}}),mergeState:C,respondReply:x,assignResolve:k,transmit:b,assignRejection:I},guards:{isReply:function(e){var t=e.anvil,n=c.isModel(t);return n||i(u.isModel(t)),a("isReply: %o",n),n},isReductionPending:function(e){var t=e.reduceResolve;i(d.isModel(t));var n=t.getIsPending();return a("isReductionPending",n),n}},services:{reduceCovenant:w}},R=function(e){return e.startsWith("/")?(i.notStrictEqual(e,"/"),e.substring(1)):e};e.exports={pendingConfig:function(e){return i.strictEqual(typeof e,"object"),{machine:r(r({},g),{},{context:e}),config:M}}}},2327:function(e,t,n){e.exports={definition:{id:"interpreter.pending",initial:"isReply",context:{},strict:!0,states:{isReply:{always:[{target:"reducePendingReply",cond:"isReply"},{target:"bufferRequest"}]},bufferRequest:{entry:["bufferRequest","promiseAnvil"],always:"done"},reducePendingReply:{entry:["accumulateReply","shiftCovenantAction"],invoke:{src:"reduceCovenant",onDone:{target:"deduplicatePendingReplyTx",actions:"assignResolve"},onError:{target:"rejectPending",actions:"assignRejection"}},exit:"respondReply"},deduplicatePendingReplyTx:{entry:"deduplicatePendingReplyTx",always:"transmit"},transmit:{entry:"transmit",always:[{target:"done",cond:"isReductionPending"},{target:"settlePending"}]},rejectPending:{entry:["rejectOriginRequest","settlePending"],always:"done"},settlePending:{entry:["settlePending","mergeState"],always:"done"},done:{data:function(e){return e},type:"final"}}}}},2328:function(e,t,n){var r=n(15),i=n(12),a=n(18)("interblock:cfg:heart.autoResolves"),s=n(25),o=s.txReplyModel,c=s.rxReplyModel,u=s.rxRequestModel,l=s.dmzModel,d=s.pendingModel,p=n(88).networkProducer,f=n(2329).definition,h=n(70).assign,v={actions:{resolveExternalAction:h({dmz:function(e){var t=e.dmz,n=e.externalAction;a("resolveExternalAction"),i(l.isModel(t)),i(u.isModel(n)),i(t.network.getAlias(n.getAddress()));var s=t.network.getResponse(n);i(!s,"existing response: ".concat(s&&s.type));var c=n.sequence,d=o.create("@@RESOLVE",{},c),f=p.tx(t.network,[],[d]);return l.clone(r(r({},t),{},{network:f}))}}),settleOrigin:h({dmz:function(e){var t=e.initialPending,n=e.dmz;i(d.isModel(t)),i(t.getIsPending()),i(l.isModel(n)),i(!n.pending.getIsPending());var s=t.pendingRequest;i(u.isModel(s)),i(n.network.getAlias(s.getAddress())),a("settleOrigin",s);var c=s.sequence,f=o.create("@@RESOLVE",{},c),h=p.tx(n.network,[],[f]);return l.clone(r(r({},n),{},{network:h}))}})},guards:{isNotPending:function(e){var t=e.initialPending;i(d.isModel(t));var n=!t.getIsPending();return a("isNotPending",n),n},isOriginSettled:function(e){var t=e.initialPending,n=e.dmz;i(d.isModel(t)),i(l.isModel(n));var r=t.pendingRequest;i(u.isModel(r));var s=n.network.getResponse(r),o=s&&!s.isPromise();return a("isOriginSettled",o),o},isStillPending:function(e){var t=e.initialPending,n=e.dmz;i(d.isModel(t)),i(l.isModel(n));var r=t.getIsPending()&&n.pending.getIsPending();return a("isStillPending",r),r},isExternalActionTypeReply:function(e){var t=e.externalAction,n=c.isModel(t);return a("isExternalActionTypeReply",n),n},isChannelRemoved:function(e){var t=e.dmz,n=e.externalAction;i(l.isModel(t)),i(u.isModel(n));var r=n.getAddress(),s=!t.network.getAlias(r);return a("isChannelRemoved",s),s},isRequestRemoved:function(e){var t=e.dmz,n=e.externalAction;i(l.isModel(t)),i(u.isModel(n));var r=n.getAddress(),s=t.network.getAlias(r),o=t.network[s].getRemote(),c=n.getIndex(),d=!o.requests[c];return a("isRequestRemoved: ",d),d},isExternalRequestSettled:function(e){var t=e.dmz,n=e.externalAction;i(l.isModel(t)),i(u.isModel(n));var r=t.network.getResponse(n),s=r&&!r.isPromise(),o=n.type;return a("isExternalRequestSettled",s,o),s},isTxExternalActionPromise:function(e){var t=!!e.isExternalPromise;return a("isTxExternalActionPromise",t),t},isExternalRequestBuffered:function(e){var t=e.dmz,n=e.externalAction;i(l.isModel(t)),i(u.isModel(n));var r=t.pending.getIsBuffered(n);return a("isExternalRequestBuffered",r),r}},services:{}};e.exports={autoResolvesConfig:function(e){return i.strictEqual(typeof e,"object"),{machine:r(r({},f),{},{context:e}),config:v}}}},2329:function(e,t,n){e.exports={definition:{id:"interpreter.autoResolves",context:{},strict:!0,initial:"settleOrigin",states:{settleOrigin:{always:[{target:"resolveExternalAction",cond:"isNotPending"},{target:"resolveExternalAction",cond:"isStillPending"},{target:"resolveExternalAction",cond:"isOriginSettled"},{target:"resolveExternalAction",actions:"settleOrigin"}]},resolveExternalAction:{always:[{target:"done",cond:"isExternalActionTypeReply"},{target:"done",cond:"isChannelRemoved"},{target:"done",cond:"isRequestRemoved"},{target:"done",cond:"isExternalRequestSettled"},{target:"done",cond:"isTxExternalActionPromise"},{target:"done",cond:"isExternalRequestBuffered"},{target:"done",actions:"resolveExternalAction"}]},done:{data:function(e){return e},type:"final"}}}}},2330:function(e,t,n){var r=n(15),i=n(9),a=n(10),s=n(12),o=n(18)("interblock:cfg:heart:dmz"),c=n(25),u=c.rxReplyModel,l=c.rxRequestModel,d=c.dmzModel,p=c.reductionModel,f=c.addressModel,h=n(103),v=n(55)["@@GLOBAL_HOOK_INBAND"],g=n(2331).definition,y=(0,n(393).common)(o),m=y.transmit,b=y.respondReply,k=y.assignResolve,x=y.isReply,w=y.assignRejection,I=y.respondRejection,C=y.respondLoopbackRequest,M=y.isLoopbackResponseDone,R=y.isAnvilNotLoopback,E={actions:{mergeSystemState:(0,n(70).assign)({dmz:function(e){var t=e.dmz,n=e.reduceResolve;return s(d.isModel(t)),s(p.isModel(n)),o("mergeSystemState"),d.clone(n.reduction)}}),respondLoopbackRequest:C,assignResolve:k,transmit:m,respondReply:b,assignRejection:w,respondRejection:I},guards:{isChannelUnavailable:function(e){var t=e.dmz,n=e.address;s(d.isModel(t)),s(f.isModel(n)),s(!n.isUnknown(),"Address unknown");var r=t.network.getAlias(n);return o("isChannelUnavailable: ",!r),!r},isReply:x,isLoopbackResponseDone:M,isAnvilNotLoopback:R},services:{reduceSystem:function(){var e=a(i.mark((function e(t){var n,r,a,c,p,f,g;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dmz,r=t.anvil,s(d.isModel(n)),s(l.isModel(r)||u.isModel(r)),o("reduceSystem anvil: %o",r.type),a=function(){return h.reducer(n,r)},c=[],"TODO",e.next=9,v(a,c,"TODO");case 9:return p=e.sent,s(p,"System returned: ".concat(p)),s(!p.isPending,"System can never raise pending"),f=p.requests,g=p.replies,o("reduceSystem tx: ".concat(f.length," rx: ").concat(g.length)),e.abrupt("return",{reduceResolve:p});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};e.exports={dmzConfig:function(e){return s.strictEqual(typeof e,"object"),{machine:r(r({},g),{},{context:e}),config:E}}}},2331:function(e,t,n){e.exports={definition:{id:"interpreter.dmz",initial:"reduceSystem",context:{},strict:!0,states:{reduceSystem:{invoke:{src:"reduceSystem",onDone:{target:"merge",actions:"assignResolve"},onError:{target:"respondRejection",actions:"assignRejection"}}},respondRejection:{entry:"respondRejection",always:"done"},merge:{entry:["mergeSystemState","transmit"],always:[{target:"done",cond:"isChannelUnavailable"},{target:"respondReply",cond:"isReply"},{target:"respondLoopbackRequest"}]},respondReply:{entry:"respondReply",always:"done"},respondLoopbackRequest:{always:[{target:"done",cond:"isAnvilNotLoopback"},{target:"done",cond:"isLoopbackResponseDone"},{target:"done",actions:"respondLoopbackRequest"}]},done:{data:function(e){return e},type:"final"}}}}},2332:function(e,t,n){var r={id:"isolator",initial:"idle",context:{lock:void 0,dmz:void 0,interblock:void 0,containerId:void 0,isolation:function(){return"isolation function"},pierceDmz:void 0,hasPierced:!1},strict:!0,states:{idle:{on:{EXECUTE_COVENANT:{target:"isGenesis",actions:["assignLock","assignDmz"]}}},isGenesis:{always:[{target:"attachParentLineage",cond:"isGenesis"},{target:"isDmzChangeable"}]},attachParentLineage:{entry:["assignGenesisInterblock","connectToParent"],invoke:{src:"fetchParentLineage",onDone:{target:"isDmzChangeable",cond:"verifyLineage"}},exit:"ingestParentLineage"},isDmzChangeable:{entry:"ingestInterblocks",always:[{target:"loadCovenant",cond:"isDmzChangeable"},{target:"done"}]},loadCovenant:{invoke:{src:"loadCovenant",onDone:{target:"isReduceable",actions:"assignContainerId"},onError:"error"}},isReduceable:{always:[{target:"reduce",cond:"isReduceable"},{target:"pierce",cond:"isPiercable"},{target:"isCovenantUnloadable"}]},reduce:{invoke:{src:"reduce",onDone:{target:"isReduceable",actions:"updateDmz"},onError:"error"}},pierce:{initial:"generatePierceDmz",states:{generatePierceDmz:{entry:["assignHasPierced","generatePierceDmz"],always:[{target:"signPierceDmz",cond:"isPierceDmzChanged"},{target:"signPierceDmz",cond:"isPierceChannelUnopened"},{target:"done"}]},signPierceDmz:{invoke:{src:"signPierceDmz",onDone:{target:"done",actions:["openPierceChannel","ingestPierceBlock"]}}},done:{type:"final"}},onDone:"isReduceable"},isCovenantUnloadable:{always:[{target:"done",cond:"isCovenantEffectable"},{target:"unloadCovenant"}]},unloadCovenant:{invoke:{src:"unloadCovenant",onDone:{target:"done",actions:"unassignContainerId"},onError:"error"}},done:{data:function(e){return{dmz:e.dmz,containerId:e.containerId}},type:"final"},error:{type:"final"}}};e.exports={definition:r}},2333:function(e,t,n){var r=n(9),i=n(10),a=n(34),s=n(15),o=n(12),c=n(18)("interblock:cfg:pool"),u=(n(51),n(70).assign),l=n(2334).definition,d=n(25),p=d.channelModel,f=d.networkModel,h=d.blockModel,v=d.lockModel,g=d.interblockModel,y=d.addressModel,m=d.dmzModel,b=d.covenantIdModel,k=d.publicKeyModel,x=n(88).lockProducer,w=n(123),I=n(280);e.exports={poolConfig:function(e,t){var n=w.toFunctions(t),d=I.toFunctions(e),C={actions:{dumpAffected:u({affectedAddresses:function(e){var t=e.affectedAddresses,n=e.interblock;return o(Array.isArray(t)),o(g.isModel(n)),n.getOriginAlias()?[n.getTargetAddress()]:[]}}),assignInterblock:u({interblock:function(e,t){var n=t.payload;return o(g.isModel(n)),n}}),assignLock:u({lock:function(e,t){return o(v.isModel(t.data)),t.data}}),mergeGenesis:u({nextBlock:function(e){var t=e.interblock;c("mergeGenesis"),o(g.isModel(t));var n=t.extractGenesis();return n}}),mergeBlockToLock:u({lock:function(e){var t=e.lock,n=e.nextBlock;return o(v.isModel(t)),o(h.isModel(n)),c("mergeBlockToLock increased: ".concat(!n.equals(t.block))),x.reconcile(t,n)}}),assignGeneratedBlock:u({nextBlock:function(e,t){return o(h.isModel(t.data)),c("assignGeneratedBlock"),t.data}}),unassignLock:u({lock:function(){}}),createBaseDmz:u({baseDmz:function(e){var t=e.validators,n=b.create("hyper"),r=y.create("ROOT"),i=p.create(r),a=s(s({},f.create()),{},{"..":i});return m.create({covenantId:n,validators:t,network:a,config:{isPierced:!0,isPublicChannelOpen:!0}})}}),assignValidatorKey:u({validators:function(e,t){c("assignValidatorKey: %o",t.data);var n=Object.values(t.data)[0];return o(k.isModel(n)),t.data}}),assignAffectedAddresses:u({affectedAddresses:function(e,t){var n=e.affectedAddresses;c("assignAffectedAddresses");var r=t.data;return o(Array.isArray(r)),[].concat(a(r),a(n))}}),assignConnectionAttempt:u({affectedAddresses:function(e){var t=e.interblock,n=e.affectedAddresses;o(Array.isArray(n)),o(g.isModel(t));var r=t.getTargetAddress();return[].concat(a(n),[r])}})},guards:{isStorageEmpty:function(e,t){var n=t.data.isStorageEmpty;return c("isStorageEmpty: ".concat(n)),n},isInitialConditions:function(e){return!!e.baseDmz},isGenesis:function(e){var t=e.interblock;o(g.isModel(t));var n=!1;try{t.extractGenesis(),n=!0}catch(r){}return c("isGenesis: ".concat(n)),n},isOriginPresent:function(e,t){var n=t.data;return o("boolean"===typeof n),c("isOriginPresent: ".concat(n)),n},isLockFailed:function(e,t){var n=!t.data&&!v.isModel(t.data);return c("isLockFailed: ".concat(n)),n},isBirthingCompleted:function(e){var t=e.lock;o(v.isModel(t));var n=!!t.block;return c("isBirthingCompleted: ".concat(n)),n},isConnectionAttempt:function(e){return e.interblock.isConnectionAttempt()},isConnectable:function(e,t){return t.data}},services:{isStorageEmpty:function(){var e=i(r.mark((function e(){var t,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0,e.next=3,n.getBlock({address:undefined});case 3:return t=e.sent,c("isStorageEmpty: ".concat(i=!t)),e.abrupt("return",{isStorageEmpty:i});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),checkIsOriginPresent:function(){var e=i(r.mark((function e(t){var i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,a=i.provenance.getAddress(),e.next=4,n.getIsPresent(a);case 4:return s=e.sent,c("checkIsOriginPresent: %O",!!s),e.abrupt("return",!!s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lockChildChain:function(){var e=i(r.mark((function e(t){var i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,o(g.isModel(i)),a=i.extractGenesis().provenance.getAddress(),e.next=5,n.putLockChain(a);case 5:return s=e.sent,c("lockChildChain for ".concat(i.getOriginAlias(),": ").concat(!!s)),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unlockChain:function(){var e=i(r.mark((function e(t){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.lock,o(v.isModel(i)),c("unlockChain"),e.next=5,n.putUnlockChain(i);case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchValidatorKey:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("fetchValidatorKey"),e.next=3,d.getValidatorEntry();case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),signBlock:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.baseDmz,c("signBlock"),e.next=4,h.create(n,d.sign);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lockBaseChain:function(){var e=i(r.mark((function e(t){var i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.nextBlock,c("lockBaseChain"),a=i.provenance.getAddress(),e.next=5,n.putLockChain(a);case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchAffectedAddresses:function(){var e=i(r.mark((function e(t){var i,a,s,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,e.next=3,n.getAffected(i);case 3:return a=e.sent,i.isGenesisAttempt()&&(s=i.extractGenesis(),o(h.isModel(s)),u=s.provenance.getAddress(),o(a.every((function(e){return!e.equals(u)}))),a.push(u)),c("fetchAffectedAddresses: ".concat(a.length)),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isConnectable:function(){var e=i(r.mark((function e(t){var i,a,s,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,o(g.isModel(i)),a=i.getTargetAddress(),o(a),e.next=6,n.getBlock({address:a});case 6:return(s=e.sent)&&o(h.isModel(s)),u=s&&s.config.isPublicChannelOpen,c("isConnectable: ",u),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),storeInPools:function(){var e=i(r.mark((function e(t){var i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,a=t.affectedAddresses,o(Array.isArray(a)),o(g.isModel(i)),c("storeInPools"),e.next=6,n.putPoolInterblock({affectedAddresses:a,interblock:i});case 6:c("storeInPools completed on ".concat(a.length," items"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};return{machine:l,config:C}}}},2334:function(e,t,n){var r={id:"pool",initial:"idle",context:{interblock:void 0,lock:void 0,dmz:void 0,nextBlock:void 0,affectedAddresses:[],baseDmz:void 0,validators:void 0},strict:!0,states:{idle:{on:{POOL_INTERBLOCK:{target:"initializeStorage",actions:"assignInterblock"}}},done:{entry:"dumpAffected",data:function(e){return e.affectedAddresses},type:"final"},initializeStorage:{initial:"isStorageEmpty",states:{isStorageEmpty:{invoke:{src:"isStorageEmpty",onDone:[{target:"fetchValidatorKey",cond:"isStorageEmpty"},{target:"done"}]}},fetchValidatorKey:{invoke:{src:"fetchValidatorKey",onDone:{target:"createBaseBlock",actions:"assignValidatorKey"}}},createBaseBlock:{entry:"createBaseDmz",invoke:{src:"signBlock",onDone:{target:"lockBaseChain",actions:"assignGeneratedBlock"}}},lockBaseChain:{invoke:{src:"lockBaseChain",onDone:{target:"unlockChain",actions:"assignLock"}}},unlockChain:{entry:"mergeBlockToLock",invoke:{src:"unlockChain",onDone:"done"}},done:{type:"final"}},onDone:[{target:"done",cond:"isInitialConditions"},{target:"poolInterblock"}]},poolInterblock:{initial:"isGenesis",states:{done:{type:"final"},isGenesis:{always:[{target:"birthChild",cond:"isGenesis"},{target:"poolAffectedChains"}]},poolAffectedChains:{initial:"fetchAffectedAddresses",states:{fetchAffectedAddresses:{invoke:{src:"fetchAffectedAddresses",onDone:{target:"isConnectionAttempt",actions:"assignAffectedAddresses"}}},isConnectionAttempt:{always:[{target:"isConnectable",cond:"isConnectionAttempt"},{target:"storeInPools"}]},isConnectable:{invoke:{src:"isConnectable",onDone:[{target:"storeInPools",cond:"isConnectable",actions:"assignConnectionAttempt"},{target:"storeInPools"}]}},storeInPools:{invoke:{src:"storeInPools",onDone:{target:"done"}}},done:{type:"final"}},onDone:"done"},birthChild:{initial:"checkIsOriginPresent",states:{checkIsOriginPresent:{invoke:{src:"checkIsOriginPresent",onDone:[{target:"lockChildChain",cond:"isOriginPresent"},{target:"done"}]}},done:{type:"final"},lockChildChain:{entry:"unassignLock",invoke:{src:"lockChildChain",onDone:[{target:"done",cond:"isLockFailed"},{target:"increaseGenesisChain"}]}},increaseGenesisChain:{entry:"assignLock",always:[{target:"unlockChain",cond:"isBirthingCompleted"},{target:"mergeGenesis"}]},mergeGenesis:{entry:"mergeGenesis",always:"unlockChain"},unlockChain:{entry:"mergeBlockToLock",invoke:{src:"unlockChain",onDone:"done"}}},onDone:"poolAffectedChains"}},onDone:"done"}}};e.exports={definition:r}},2335:function(e,t,n){var r=n(9),i=n(10),a=n(12),s=n(18)("interblock:cfg:receive"),o=(n(51),n(70).assign),c=n(25),u=(c.lockModel,c.addressModel,c.txModel),l=c.blockModel,d=c.interblockModel,p=n(88),f=(p.blockProducer,p.lockProducer,p.networkProducer,n(2336).definition),h=n(123);e.exports={receiveConfig:function(e){var t=h.toFunctions(e),n={actions:{assignInterblock:o({interblock:function(e,t){var n=t.payload;return a(u.isModel(n)),n.interblock}}),assignSocket:o({socket:function(e,t){var n=t.payload;return a(u.isModel(n)),n.socket}}),assignIsPoolable:o({isPoolable:function(e,t){return!0}})},guards:{isInitialConditions:function(e,t){var n=t.data;return s("isInitialConditions: ".concat(n)),n},isPoolable:function(e,t){var n=t.data;return a("boolean"===typeof n),s("isPoolable: ".concat(n)),n},isConnectionAttempt:function(e){return e.interblock.isConnectionAttempt()},isConnectable:function(e,t){return t.data}},services:{isInitialConditions:function(){var e=i(r.mark((function e(){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0,e.next=3,t.getBlock({address:undefined});case 3:return n=e.sent,s("isInitialConditions: ".concat(!n)),e.abrupt("return",!n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),isAnyAffected:function(){var e=i(r.mark((function e(n){var i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,e.next=3,t.getIsAnyAffected(i);case 3:return a=e.sent,s("isAnyAffected: ".concat(a)),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isConnectable:function(){var e=i(r.mark((function e(n){var i,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a(d.isModel(i)),o=i.getTargetAddress(),a(o),e.next=6,t.getBlock({address:o});case 6:return(c=e.sent)&&a(l.isModel(c)),u=c&&c.config.isPublicChannelOpen,s("isConnectable: ",u),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),storeConnection:function(){var e=i(r.mark((function e(n){var i,a,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a=n.socket,s("storeConnection"),o=i.provenance.getAddress(),e.next=5,t.putSocket({address:o,socket:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};return{machine:f,config:n}}}},2336:function(e,t,n){var r={id:"receive",initial:"idle",context:{socket:void 0,interblock:void 0,isPoolable:!1,isCatchupable:!1},strict:!0,states:{idle:{on:{RECEIVE_INTERBLOCK:{target:"isInitialConditions",actions:["assignInterblock","assignSocket"]}}},isInitialConditions:{invoke:{src:"isInitialConditions",onDone:[{target:"done",actions:"assignIsPoolable",cond:"isInitialConditions"},{target:"isAnyAffected"}]}},isAnyAffected:{invoke:{src:"isAnyAffected",onDone:[{target:"storeConnection",actions:"assignIsPoolable",cond:"isPoolable"},{target:"isConnectable",cond:"isConnectionAttempt"},{target:"done"}]}},storeConnection:{invoke:{src:"storeConnection",onDone:"done"}},isConnectable:{invoke:{src:"isConnectable",onDone:[{target:"storeConnection",actions:"assignIsPoolable",cond:"isConnectable"},{target:"done"}]}},done:{data:function(e){return{isPoolable:e.isPoolable,isCatchupable:e.isCatchupable}},type:"final"},error:{type:"final"}}};e.exports={definition:r}},2337:function(e,t,n){var r=n(9),i=n(10),a=n(34),s=n(12),o=n(18)("interblock:cfg:transmit"),c=n(51),u=n(70).assign,l=n(25),d=l.interblockModel,p=l.blockModel,f=l.socketModel,h=l.txModel,v=l.addressModel,g=n(2338).definition,y=n(123);e.exports={transmitConfig:function(e){var t=y.toFunctions(e),n={actions:{assignInterblock:u({interblock:function(e,t){var n=t.payload;return o("assignInterblock"),s(d.isModel(n)),n}}),assignBlock:u({block:function(e,t){var n=t.data.block;return s(p.isModel(n)),n}}),extendListeningTxs:u({listeningTxs:function(e,t){var n=e.interblock,r=e.listeningTxs;o("extendListeningTxs");var i=t.data.sockets;s(i.every(f.isModel));var c=n.getWithoutRemote(),u=i.map((function(e){return h.create(e,c)}));return[].concat(a(r),a(u))}}),extendTargetTxs:u({targetTxs:function(e,t){var n=e.interblock,r=e.targetTxs;o("extendTargetTxs");var i=t.data;s(i.every(f.isModel));var c=i.map((function(e){return h.create(e,n)}));return[].concat(a(r),a(c))}}),assignLineage:u({lineage:function(e,t){return t.data}}),extendLineageTxs:u({lineageTxs:function(e){var t=e.targetTxs,n=e.lineage;o("extendLineageTxs"),s(n.every(d.isModel)),s(n.every((function(e){return!e.getTargetAddress()})));var r=[];return t.forEach((function(e){n.forEach((function(t){s(h.isModel(e));var n=e.socket;s(f.isModel(n)),r.push(h.create(n,t))}))})),o("extendLineageTxs generated ".concat(r.length," extensions")),r}}),extendGenesisAttempt:u({targetTxs:function(e){var t=e.interblock,n=e.targetTxs;s(d.isModel(t)),s(t.isGenesisAttempt());var r=h.create(f.create(),t);return n=[].concat(a(n),[r])}}),removeListeningTxs:u({listeningTxs:function(e){var t=e.listeningTxs,n=e.targetTxs;o("removeListeningTxs");var r=n.map((function(e){return e.socket})),i=t.filter((function(e){var t=e.socket;return!r.some((function(e){return e.equals(t)}))}));return o("filter removed: ".concat(r.length-i.length)),i}}),mergeTransmissions:u({transmissions:function(e){var t=e.listeningTxs,n=e.targetTxs,r=e.lineageTxs;return[].concat(a(t),a(r),a(n))}})},guards:{isBlockFetched:function(e,t){return p.isModel(t.data.block)},isLineageInterblock:function(e){return!e.interblock.getRemote()},isInitiatingAction:function(e){var t=e.interblock;s(d.isModel(t));var n=t.isConnectionResponse(),r=t.isConnectionResolve(),i=t.isDownlinkInit(),a=t.isUplinkInit();return n||r||i||a},isGenesisAttempt:function(e){return e.interblock.isGenesisAttempt()},isOriginPresent:function(e,t){return t.data.isOriginPresent}},services:{fetchBlock:function(){var e=i(r.mark((function e(n){var i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(d.isModel(i)),e.next=4,t.getBlock(i.provenance);case 4:return a=e.sent,s(p.isModel(a)),s(a.provenance.equals(i.provenance)),o("fetchBlock height: ".concat(a.provenance.height)),e.abrupt("return",{block:a});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchRemoteListeners:function(){var e=i(r.mark((function e(n){var i,u,l,h,v,g,y,m;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,u=n.block,s(d.isModel(i)),s(!i.getRemote()),s(p.isModel(u)),l=u.network,h=l.getResolvedAliases().map((function(e){var n=l[e].address;return t.getSockets(n)})),e.next=8,Promise.all(h);case 8:return v=e.sent,g=c.flatten(v),y=new Set(g),o("fetchListeningSockets length: ".concat(y.size)),m=a(y),s(m.every(f.isModel)),e.abrupt("return",{sockets:m});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchSelfListener:function(){var e=i(r.mark((function e(n){var i,a,c,u,l,h,v;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a=n.block,s(d.isModel(i)),s(p.isModel(a)),c=a.network,u=c.getResolvedAliases().map((function(e){var n=c[e].address;return t.getIsPresent(n)})),e.next=7,Promise.all(u);case 7:return l=e.sent,h=l.some((function(e){return e})),o("fetchSelfListener: ".concat(h)),v=h?[f.create()]:[],e.abrupt("return",{sockets:v});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchRemoteTargets:function(){var e=i(r.mark((function e(n){var i,a,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(d.isModel(i)),a=i.getTargetAddress(),s(v.isModel(a)),e.next=6,t.getSockets(a);case 6:return c=e.sent,o("fetchTargetSockets length: ".concat(c.length)),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchSelfTarget:function(){var e=i(r.mark((function e(n){var i,a,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(d.isModel(i)),a=i.getTargetAddress(),s(a),e.next=6,t.getIsPresent(a);case 6:return c=e.sent,o("fetchSelfTarget: ".concat(c)),e.abrupt("return",c?[f.create()]:[]);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchLineageToGenesis:function(){var e=i(r.mark((function e(n){var i,a,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(d.isModel(i)),0,o("fetchLineage from height: ".concat(0)),a=i.provenance,c={provenance:a,height:0},e.next=8,t.getLineage(c);case 8:return u=e.sent,o("fetchLineage length: ".concat(u.length)),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isOriginPresent:function(){var e=i(r.mark((function e(n){var i,a,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(d.isModel(i)),a=i.provenance.getAddress(),e.next=5,t.getIsPresent(a);case 5:return c=e.sent,o("isOriginPresent: ",c),e.abrupt("return",{isOriginPresent:c});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};return{machine:g,config:n}}}},2338:function(e,t,n){var r={id:"transmit",initial:"idle",context:{interblock:void 0,listeningTxs:[],targetTxs:[],lineage:[],lineageTxs:[],transmissions:[]},strict:!0,states:{idle:{on:{TRANSMIT_INTERBLOCK:{target:"isLineageInterblock",actions:"assignInterblock"}}},done:{entry:["removeListeningTxs","mergeTransmissions"],data:function(e){return e.transmissions},type:"final"},isLineageInterblock:{always:[{target:"fetchLineageSockets",cond:"isLineageInterblock"},{target:"fetchTargetSockets"}]},fetchLineageSockets:{initial:"fetchBlock",states:{fetchBlock:{invoke:{src:"fetchBlock",onDone:[{target:"fetchListeners",actions:"assignBlock",cond:"isBlockFetched"},{target:"done"}]}},done:{type:"final"},fetchListeners:{type:"parallel",states:{fetchRemoteListeners:{initial:"promise",states:{promise:{invoke:{src:"fetchRemoteListeners",onDone:{target:"done",actions:"extendListeningTxs"}}},done:{type:"final"}}},fetchSelfListener:{initial:"promise",states:{promise:{invoke:{src:"fetchSelfListener",onDone:{target:"done",actions:"extendListeningTxs"}}},done:{type:"final"}}}},onDone:"done"}},onDone:"done"},fetchTargetSockets:{type:"parallel",states:{isGenesisAttempt:{initial:"isGenesisAttempt",states:{isGenesisAttempt:{always:[{target:"isOriginPresent",cond:"isGenesisAttempt"},{target:"done"}]},isOriginPresent:{invoke:{src:"isOriginPresent",onDone:[{target:"done",cond:"isOriginPresent",actions:"extendGenesisAttempt"},{target:"done"}]}},done:{type:"final"}}},fetchRemoteTargets:{initial:"promise",states:{promise:{invoke:{src:"fetchRemoteTargets",onDone:{target:"done",actions:"extendTargetTxs"}}},done:{type:"final"}}},fetchSelfTarget:{initial:"promise",states:{promise:{invoke:{src:"fetchSelfTarget",onDone:{target:"done",actions:"extendTargetTxs"}}},done:{type:"final"}}},addLineage:{initial:"isLineageRequired",states:{isLineageRequired:{always:[{target:"fetchLineageToGenesis",cond:"isInitiatingAction"},{target:"done"}]},fetchLineageToGenesis:{invoke:{src:"fetchLineageToGenesis",onDone:{target:"done",actions:"assignLineage"}}},done:{type:"final"}}}},onDone:{target:"done",actions:"extendLineageTxs"}}}};e.exports={definition:r}},2339:function(e,t,n){var r=n(9),i=n(10),a=n(25),s=a.blockModel,o=a.interblockModel,c=function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(n),e.next=3,l(t);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.create();case 2:n=e.sent,i=o.create(n),t.push(i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(e){var t,n=new Promise((function(e){return t=e})),a=e.subscribe(function(){var e=i(r.mark((function e(n,i){var s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("UNLOCK"!==n.type){e.next=6;break}return s=n.payload.block,e.next=4,i;case 4:t(s.provenance.getAddress()),a();case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());return n};e.exports={createBase:c}},2340:function(e,t,n){var r=n(34),i=n(12),a=n(51),s=(n(584),n(268),n(587)),o=n(588),c=o.blockPrint,u=o.interPrint,l=o.headerPrint,d=o.networkPrint,p=o.print,f=n(25),h=f.blockModel,v=f.interblockModel,g=n(2361);e.exports={createTap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"interblock:blocktap",t=!1,o=function(){return t=!0},f=function(){return t=!1},y=n(18)(e),m={},b=(s.gray("undefined"),y.extend("t")),k=function(e){if(t){var n=I(e);b(n)}},x=y.extend("p"),w=function(e){if(t){var n=I(e);x(n)}},I=function(e){i(v.isModel(e));var t=s.yellow("LIGHT"),n=s.gray(q(e,m));return e.getRemote()&&(t=s.yellow("HEAVY")),u(e,t,n,"bgYellow","yellow")},C=new Map,M=function(e,t){var n=e.getChainId(),r=Date.now();C.set(n,{lockStart:t,workStart:r})},R=y.extend("b"),E=function(e){i(h.isModel(e));var n=e.provenance.getAddress().getChainId(),r=!m[n],a=m[n]&&m[n].some((function(t){return t.equals(e)}));if(A(e,m),t&&!a){var s=q(e,m),o=c(e,s,r,a),u=C.get(e.getChainId()),l=u.lockStart,d=u.workStart;Date.now(),Date.now();R(o)}},P=0,O=0,A=function(e,t){var n=e.provenance.getAddress().getChainId();t[n]||(t[n]=[],O++),t[n].some((function(t){return t.equals(e)}))||(t[n].push(e),P++)},q=function(e,t){var n="(unknown)";if(!(e=a.last(t[e.provenance.getAddress().getChainId()])))return n;for(var r=[],s=e,o=0;s&&o<10;){o++;var c=s.network[".."].address;if(c.isRoot())s=void 0,r.unshift("");else if(c.isUnknown())r.unshift(n),s=void 0;else{var u=c.getChainId(),l=a.last(t[u]);i(h.isModel(l),"Hole in pedigree");var d=l.network.getAlias(s.provenance.getAddress());r.unshift(d),s=l}}o>=10&&y("Path over loopCount");var p=r.join("/");return p||"/"},j=function(e){var t;return Object.values(m).some((function(n){var r=a.last(n),s=r.network[".."];if(s.address.isRoot()&&"/"===e)return i(!t),t=r,!0;var o=s.heavy;return o&&o.getOriginAlias()===e?(i(!t),t=r,!0):void 0})),t},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NEEDLEBLOCK",n="UNKNOWN";e[".."].address.isRoot()?n="/":e[".."].heavy&&(n=e[".."].heavy.getOriginAlias());var i=j(n),a=[l(i,n)];return a[0].msg=s.green(t),a.push.apply(a,r(d(e))),p(a)},T=function(){return P},D=function(){return O},L={on:o,off:f,lock:M,block:E,interblockTransmit:k,interblockPool:w,getLatest:j,printNetwork:S,getBlockCount:T,getChainCount:D};return g.setTap(L),L}}},2361:function(e,t,n){var r,i=n(12),a=n(18)("ib:needle");e.exports={test:function(e,t,n,o){i(r,"tap not set");var c=r.getLatest(t),u=c.network[".."].address,l=e[".."].address.equals(u),d=s(c.network[".."],e[".."]),p=n===c.provenance.height;l&&d&&p&&o(a)},setTap:function(e){r=e},printNetwork:function(e,t){var n=r.printNetwork(e,t);a(n)},print:function(){return a.apply(void 0,arguments)}};var s=function(e,t){return!(!e.address.isRoot()||!t.address.isRoot())||!(!e.heavy||!t.heavy)&&e.heavy.getOriginAlias()===t.heavy.getOriginAlias()}},2362:function(e,t,n){(function(t){var r=n(15),i=n(9),a=n(121),s=n(10),o=n(12),c=n(559).deserializeError,u=n(245).v4,l=n(18)("interblock:engine:piercerFactory"),d=n(55).request,p=n(25).txRequestModel,f=n(123).toFunctions,h=function(){var e={},t=new Promise((function(t,n){e.settled={resolve:t,reject:n}}));return t.pending=new Promise((function(t,n){e.pending={resolve:t,reject:n}})),{promise:t,callbacks:e}};e.exports={piercerFactory:function(e,n,v){var g=new Map,y=u(),m=0,b=f(n);n.subscribe(function(){var n=s(i.mark((function n(r,s){var u,l;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("UNLOCK"!==r.type){n.next=10;break}return n.next=3,s;case 3:if((u=r.payload.block).getChainId()!==e.getChainId()){n.next=10;break}if(l=u.network[".@@io"]){n.next=8;break}return n.abrupt("return");case 8:l.getRemoteRequestIndices().forEach((function(e){var n=l.getRemote().requests[e];o(n);var r=n.payload["__@@ioSequence"];if(o(r.endsWith(y)),g.has(r)){var i=g.get(r);i.pending.resolve();var s=l.replies[e];if(s&&!s.isPromise()){var u=i.settled,d=u.resolve,p=u.reject;if(s.isResolve()){var f=s.payload,h=(f["__@@ioSequence"],a(f,["__@@ioSequence"]));o.strictEqual(typeof h,"object"),t((function(){return d(h)}))}else t((function(){return p(c(s.payload))}));g.delete(r)}}}));case 10:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}());var k=0,x=function(){var t=s(i.mark((function t(n,a){var c,u,f,x,I,C,M,R,E,P;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=d(n,a),u=c.type,f=c.payload,o(!(x=void 0===f?{}:f)["__@@ioSequence"]),I="".concat(m++," ").concat(y),l("pierce: %s id: %o",u,I),x=r(r({},x),{},{"__@@ioSequence":I}),C=e.getChainId(),M=p.create(u,x,C),R=h(),E=R.promise,P=R.callbacks,g.set(I,P),function(){var e=s(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k||w.forEach((function(e){return e(!0)})),k++,e.prev=2,e.next=5,E;case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:k--,o(k>=0),0===k&&w.forEach((function(e){return e(!1)}));case 12:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(){return e.apply(this,arguments)}}()(),t.next=13,b.putPierceRequest({txRequest:M});case 13:return t.next=15,v.push(e);case 15:return t.abrupt("return",E);case 16:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),w=new Set;return x.subscribePending=function(e){return w.add(e),e(k>0),function(){return w.delete(e)}},x}}}).call(this,n(148).setImmediate)},2363:function(e,t,n){var r=n(15),i=n(9),a=n(10),s=n(12),o=n(70).interpret,c=n(2364).machineLogger,u=function(){var e=a(i.mark((function e(t,n){var s,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c(t.type||t,n.id),u=o(n,{execute:!1}),l=new Promise((function(e,t){var n=!1;u.onTransition(function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("error"===t.value&&(n=t.event),"error"===t.value||"done"===t.value){e.next=4;break}return e.next=4,s.writeTransition(t.value,t.event,t.context);case 4:u.execute(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u.onDone(function(){var o=a(i.mark((function a(o){var c,u,l;return i.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!n){i.next=11;break}return(c=n).type,u=c.data,(l=r(r({},new Error),u)).message=u.message,l.stack=u.stack,l.name=u.name,i.next=8,s.writeTermination(l);case 8:t(l),i.next=14;break;case 11:return i.next=13,s.writeTermination();case 13:e(o.data);case 14:case"end":return i.stop()}}),a)})));return function(e){return o.apply(this,arguments)}}())})),u.start(),u.send(t),e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={thread:u,setLogger:function(e){s.strictEqual(typeof e,"function"),c=e}}},2364:function(e,t,n){var r=n(245).v4,i=n(18);e.exports={machineLogger:function(e,t){var n=r(),a=i("interblock:machines:".concat(t));a("INVOCATION: ".concat(t," -> ").concat(e));var s=[],o=!1,c=function(e){a("TRANSITION: %O",e)},u=function(e){a("TERMINATOR: ".concat(e.machine," -> ").concat(e.type," execution ended after ").concat(e.elapsedTime,"ms"))};return{writeTransition:function(e,t,n){var r=e;if(s.push(r),o)return c(r);o=!0},writeTermination:function(r){return u({invocation:n,type:e,machine:t,state:"TERMINATION",event:s})}}}}},2365:function(e,t,n){var r=n(9),i=n(15),a=n(10),s=n(354).metrologyFactory,o=n(217).hyper,c=function(){var e=a(r.mark((function e(){var t,n,a,c,u,l,d,p=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:"aws",n=p.length>1?p[1]:void 0,n=i(i({},n),{},{hyper:o}),e.next=5,s(t,n);case 5:return a=e.sent,c=a.getEngine(),u=c.sqsTx,l=c.sqsRx,d=a.getState().provenance.getAddress(),e.next=10,a.settle();case 10:return e.abrupt("return",{sqsTx:u,sqsRx:l,hyperAddress:d,engine:a});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e.exports={awsFactory:c}},2366:function(e,t,n){var r=n(9),i=n(10),a=n(495).effectorFactory,s=n(18)("interblock:browser"),o=n(2367),c=function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.config({name:"@dreamcatcher/interblock_".concat(t)}),s("loading browser module"),e.next=4,a("web");case 4:return n=e.sent,s("browser client ready"),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports={browserFactory:c}},2370:function(e,t,n){var r=n(9),i=n(34),a=n(557),s=n(10),o=n(47)("dos:repl"),c=n(590),u=n(323),l=u.effectorFactory,d=u.apps,p=n(2394).read,f=n(396).evaluate,h=n(2479).withAutoComplete,v=n(398).withSpin,g=n(602),y=n(2480);function m(e){return b.apply(this,arguments)}function b(){return(b=s(r.mark((function e(t){var n,i,a,s,o,u,p,f,h,v;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.blockchain,t.evaluate,(i=c({spinner:"aesthetic"}).start()).info("System font check: \ud83d\udea6\ud83d\udea6\ud83d\udea6\ud83c\udf08\ud83c\udf08\ud83c\udf08\u274c\ufe0f\u274c\ufe0f\u274c\ufe0f"),i.info("begining boot sequence Ctrl+C to cancel and drop to local shell"),i.text='checking for new app version on server "this webpage"',i.info("current build version: 0.0.0").start(),i.text='looking for previous chains under the domain "this webpage"',i.info("no previous chains found").start(),n){e.next=13;break}return i.text="Initializing blockchain...",e.next=12,l("console");case 12:n=e.sent;case 13:return a=n.getState().getChainId(),i.info("Blockchain initialized with chainId: ".concat(a)).start(),i.text="connecting to mainnet...",i.info("connection to mainnet established").start(),i.info("mainnet latency: 543 ms"),i.info("peer connection count: 1").start(),i.text="benchmarking local system",i.info("local blockrate 23 blocks per second / 53 ms per block"),i.text="Provisioning app store",i.start(),s=Date.now(),e.next=26,n.publish("crmApp",d.crm.install);case 26:return o=e.sent,u=o.dpkgPath,p=Date.now(),f=p-s,i.info("app store set up at: /".concat(u," in ").concat(f,"ms")),i.text="installing crm app at /crm",i.start(),e.next=35,n.install(u,"crm");case 35:return h=Date.now()-p,v=Date.now()-s,i.info("crm app installed at /crm in ".concat(h,"ms")),i.info("total deployment time: ".concat(v,"ms")),i.stop(),e.next=42,g('Welcome to the HyperNet\n  Blockchain core: v0.0.5\n  Terminal:        v0.0.12\n  type "help" to get started');case 42:return"root","local",i.stop(),e.abrupt("return",{user:"root",machineId:"local",blockchain:n});case 46:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.exports=function(){var e=s(r.mark((function e(t){var n,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("repl"),(t=t||{}).read=t.read||h(p),t.evaluate=t.evaluate||v(f),o("opts: ",Object.keys(t)),e.next=7,m(t);case 7:return n=e.sent,c=function(){var e=s(r.mark((function e(c){var u,l,d,p;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=c.split(" ").filter(Boolean),l=a(u),d=l[0],p=l.slice(1),o("command: ",d,p),e.next=4,g(s(r.mark((function e(){var a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.includes(d)||(p=[d].concat(i(p)),d="time"),e.next=3,t.evaluate(n,d,p);case 3:return(a=e.sent)&&a.ctx&&Object.assign(n,a.ctx),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o("changing to home directory"),e.next=12,c("cd /crm/customers");case 12:return e.next=14,c("./add --isTestData");case 14:return u=n.blockchain.crm.customers.getChildren(),Object.keys(u)[0],e.abrupt("return",y(function(){var e=s(r.mark((function e(){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="exit",e.prev=1,e.next=4,t.read(n);case 4:i=e.sent,e.next=12;break;case 7:if(e.prev=7,e.t0=e.catch(1),!e.t0.message){e.next=11;break}throw e.t0;case 11:o("treating error as request to exit: ",e.t0);case 12:return e.next=14,c(i);case 14:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}()));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var k=["time","clear","help"]},2394:function(e,t,n){var r=n(9),i=n(10),a=n(104).Input,s=n(47)("dos:read"),o=n(90),c=n(2427);t.read=function(){var e=i(r.mark((function e(t){var n,i,u,l,d,p,f,h,v,g;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.autoComplete,n=t.user,i=t.machineId,u=t.blockchain,l=u.getContext(),d=l.wd,p="".concat(o.green("".concat(n,"@").concat(i))),f="".concat(p,":").concat(o.blue(d)).concat(o.reset("$")),h={type:"input",name:"result",message:f,symbols:{prefix:"",separator:""},styles:{success:o.noop}},v=new a(h),c||(v.blink={off:!0}),e.next=10,v.run();case 10:return g=e.sent,s("prompt result: ",g),e.abrupt("return",g);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},2396:function(e,t,n){"use strict";(function(t,r){var i=n(34),a=n(15),s=n(2397),o=n(2398),c=/^(?:\x1b)([a-zA-Z0-9])$/,u=/^(?:\x1b+)(O|N|\[|\[\[)(?:(\d+)(?:;(\d+))?([~^$])|(?:1;)?(\d+)?([a-zA-Z]))/,l={OP:"f1",OQ:"f2",OR:"f3",OS:"f4","[11~":"f1","[12~":"f2","[13~":"f3","[14~":"f4","[[A":"f1","[[B":"f2","[[C":"f3","[[D":"f4","[[E":"f5","[15~":"f5","[17~":"f6","[18~":"f7","[19~":"f8","[20~":"f9","[21~":"f10","[23~":"f11","[24~":"f12","[A":"up","[B":"down","[C":"right","[D":"left","[E":"clear","[F":"end","[H":"home",OA:"up",OB:"down",OC:"right",OD:"left",OE:"clear",OF:"end",OH:"home","[1~":"home","[2~":"insert","[3~":"delete","[4~":"end","[5~":"pageup","[6~":"pagedown","[[5~":"pageup","[[6~":"pagedown","[7~":"home","[8~":"end","[a":"up","[b":"down","[c":"right","[d":"left","[e":"clear","[2$":"insert","[3$":"delete","[5$":"pageup","[6$":"pagedown","[7$":"home","[8$":"end",Oa:"up",Ob:"down",Oc:"right",Od:"left",Oe:"clear","[2^":"insert","[3^":"delete","[5^":"pageup","[6^":"pagedown","[7^":"home","[8^":"end","[Z":"tab"};function d(e){return["[a","[b","[c","[d","[e","[2$","[3$","[5$","[6$","[7$","[8$","[Z"].includes(e)}function p(e){return["Oa","Ob","Oc","Od","Oe","[2^","[3^","[5^","[6^","[7^","[8^"].includes(e)}var f=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a({name:r.name,ctrl:!1,meta:!1,shift:!1,option:!1,sequence:n,raw:n},r);if(t.isBuffer(n)?n[0]>127&&void 0===n[1]?(n[0]-=128,n="\x1b"+String(n)):n=String(n):void 0!==n&&"string"!==typeof n?n=String(n):n||(n=s.sequence||""),s.sequence=s.sequence||n||s.name,"\r"===n)s.raw=void 0,s.name="return";else if("\n"===n)s.name="enter";else if("\t"===n)s.name="tab";else if("\b"===n||"\x7f"===n||"\x1b\x7f"===n||"\x1b\b"===n)s.name="backspace",s.meta="\x1b"===n.charAt(0);else if("\x1b"===n||"\x1b\x1b"===n)s.name="escape",s.meta=2===n.length;else if(" "===n||"\x1b "===n)s.name="space",s.meta=2===n.length;else if(n<="\x1a")s.name=String.fromCharCode(n.charCodeAt(0)+"a".charCodeAt(0)-1),s.ctrl=!0;else if(1===n.length&&n>="0"&&n<="9")s.name="number";else if(1===n.length&&n>="a"&&n<="z")s.name=n;else if(1===n.length&&n>="A"&&n<="Z")s.name=n.toLowerCase(),s.shift=!0;else if(e=c.exec(n))s.meta=!0,s.shift=/^[A-Z]$/.test(e[1]);else if(e=u.exec(n)){var o=i(n);"\x1b"===o[0]&&"\x1b"===o[1]&&(s.option=!0);var f=[e[1],e[2],e[4],e[6]].filter(Boolean).join(""),h=(e[3]||e[5]||1)-1;s.ctrl=!!(4&h),s.meta=!!(10&h),s.shift=!!(1&h),s.code=f,s.name=l[f],s.shift=d(f)||s.shift,s.ctrl=p(f)||s.ctrl}return s};f.listen=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.stdin;if(!n||n!==r.stdin&&!n.isTTY)throw new Error("Invalid stream passed");s(n);var i=function(e,n){return t(e,f(e,n))},a=n.isRaw;n.isTTY&&n.setRawMode(!0),n.on("keypress",i),n.resume();var o=function(){n.isTTY&&n.setRawMode(a),n.removeListener("keypress",i),n.emit("close")};return o},f.action=function(e,t,n){var r=a(a({},o),n);return t.ctrl?(t.action=r.ctrl[t.name],t):t.option&&r.option?(t.action=r.option[t.name],t):t.shift?(t.action=r.shift[t.name],t):(t.action=r.keys[t.name],t)},e.exports=f}).call(this,n(17).Buffer,n(20))},2398:function(e,t,n){"use strict";t.ctrl={a:"first",b:"backward",c:"cancel",d:"deleteForward",e:"last",f:"forward",g:"reset",i:"tab",k:"cutForward",l:"reset",n:"newItem",m:"cancel",j:"submit",p:"search",r:"remove",s:"save",u:"undo",w:"cutLeft",x:"toggleCursor",v:"paste"},t.shift={up:"shiftUp",down:"shiftDown",left:"shiftLeft",right:"shiftRight",tab:"prev"},t.fn={up:"pageUp",down:"pageDown",left:"pageLeft",right:"pageRight",delete:"deleteForward"},t.option={b:"backward",f:"forward",d:"cutRight",left:"cutLeft",up:"altUp",down:"altDown"},t.keys={pageup:"pageUp",pagedown:"pageDown",home:"home",end:"end",cancel:"cancel",delete:"deleteForward",backspace:"delete",down:"down",enter:"submit",escape:"cancel",left:"left",space:"space",number:"number",return:"submit",right:"right",tab:"next",up:"up"}},2399:function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.timers[t]={name:t,start:Date.now(),ms:0,tick:0},i=n.interval||120;r.frames=n.frames||[],r.loading=!0;var a=setInterval((function(){r.ms=Date.now()-r.start,r.tick++,e.render()}),i);return r.stop=function(){r.loading=!1,clearInterval(a)},Reflect.defineProperty(r,"interval",{value:a}),e.once("close",(function(){return r.stop()})),r.stop}e.exports=function(e){e.timers=e.timers||{};var t=e.options.timers;if(t)for(var n=0,i=Object.keys(t);n<i.length;n++){var a=i[n],s=t[a];"number"===typeof s&&(s={interval:s}),r(e,a,s)}}},2400:function(e,t,n){"use strict";(function(t,r){var i=n(15),a=n(21),s=n(27),o=n(76),c=o.define,u=o.width,l=function(){function e(n){a(this,e);var r=n.options;c(this,"_prompt",n),this.type=n.type,this.name=n.name,this.message="",this.header="",this.footer="",this.error="",this.hint="",this.input="",this.cursor=0,this.index=0,this.lines=0,this.tick=0,this.prompt="",this.buffer="",this.width=u(r.stdout||t.stdout),Object.assign(this,r),this.name=this.name||this.message,this.message=this.message||this.name,this.symbols=n.symbols,this.styles=n.styles,this.required=new Set,this.cancelled=!1,this.submitted=!1}return s(e,[{key:"clone",value:function(){var e=i({},this);return e.status=this.status,e.buffer=r.from(e.buffer),delete e.clone,e}},{key:"color",get:function(){var e=this.prompt.styles;if(this.cancelled)return e.cancelled;if(this.submitted)return e.submitted;var t=this._color||e[this.status];return"function"===typeof t?t:e.pending},set:function(e){this._color=e}},{key:"loading",get:function(){return"boolean"===typeof this._loading?this._loading:!!this.loadingChoices&&"choices"},set:function(e){this._loading=e}},{key:"status",get:function(){return this.cancelled?"cancelled":this.submitted?"submitted":"pending"}}]),e}();e.exports=l}).call(this,n(20),n(17).Buffer)},2401:function(e,t,n){"use strict";var r=n(2402),i=n(2403),a=n(76);e.exports=function(e){e.options=a.merge({},e.options.theme,e.options),e.symbols=i.merge(e.options),e.styles=r.merge(e.options)}},2402:function(e,t,n){"use strict";var r=n(76),i=n(105),a={default:i.noop,noop:i.noop,set inverse(e){this._inverse=e},get inverse(){return this._inverse||r.inverse(this.primary)},set complement(e){this._complement=e},get complement(){return this._complement||r.complement(this.primary)},primary:i.cyan,success:i.green,danger:i.magenta,strong:i.bold,warning:i.yellow,muted:i.dim,disabled:i.gray,dark:i.dim.gray,underline:i.underline,set info(e){this._info=e},get info(){return this._info||this.primary},set em(e){this._em=e},get em(){return this._em||this.primary.underline},set heading(e){this._heading=e},get heading(){return this._heading||this.muted.underline},set pending(e){this._pending=e},get pending(){return this._pending||this.primary},set submitted(e){this._submitted=e},get submitted(){return this._submitted||this.success},set cancelled(e){this._cancelled=e},get cancelled(){return this._cancelled||this.danger},set typing(e){this._typing=e},get typing(){return this._typing||this.dim},set placeholder(e){this._placeholder=e},get placeholder(){return this._placeholder||this.primary.dim},set highlight(e){this._highlight=e},get highlight(){return this._highlight||this.inverse},merge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.styles&&"boolean"===typeof e.styles.enabled&&(i.enabled=e.styles.enabled),e.styles&&"boolean"===typeof e.styles.visible&&(i.visible=e.styles.visible);var t=r.merge({},a,e.styles);delete t.merge;for(var n=function(){var e=o[s];t.hasOwnProperty(e)||Reflect.defineProperty(t,e,{get:function(){return i[e]}})},s=0,o=Object.keys(i);s<o.length;s++)n();for(var c=function(){var e=l[u];t.hasOwnProperty(e)||Reflect.defineProperty(t,e,{get:function(){return i[e]}})},u=0,l=Object.keys(i.styles);u<l.length;u++)c();return t}};e.exports=a},2403:function(e,t,n){"use strict";(function(t){var r=n(15),i="win32"===t.platform,a=n(105),s=n(76),o=r(r({},a.symbols),{},{upDownDoubleArrow:"\u21d5",upDownDoubleArrow2:"\u2b0d",upDownArrow:"\u2195",asterisk:"*",asterism:"\u2042",bulletWhite:"\u25e6",electricArrow:"\u2301",ellipsisLarge:"\u22ef",ellipsisSmall:"\u2026",fullBlock:"\u2588",identicalTo:"\u2261",indicator:a.symbols.check,leftAngle:"\u2039",mark:"\u203b",minus:"\u2212",multiplication:"\xd7",obelus:"\xf7",percent:"%",pilcrow:"\xb6",pilcrow2:"\u2761",pencilUpRight:"\u2710",pencilDownRight:"\u270e",pencilRight:"\u270f",plus:"+",plusMinus:"\xb1",pointRight:"\u261e",rightAngle:"\u203a",section:"\xa7",hexagon:{off:"\u2b21",on:"\u2b22",disabled:"\u2b22"},ballot:{on:"\u2611",off:"\u2610",disabled:"\u2612"},stars:{on:"\u2605",off:"\u2606",disabled:"\u2606"},folder:{on:"\u25bc",off:"\u25b6",disabled:"\u25b6"},prefix:{pending:a.symbols.question,submitted:a.symbols.check,cancelled:a.symbols.cross},separator:{pending:a.symbols.pointerSmall,submitted:a.symbols.middot,cancelled:a.symbols.middot},radio:{off:i?"( )":"\u25ef",on:i?"(*)":"\u25c9",disabled:i?"(|)":"\u24be"},numbers:["\u24ea","\u2460","\u2461","\u2462","\u2463","\u2464","\u2465","\u2466","\u2467","\u2468","\u2469","\u246a","\u246b","\u246c","\u246d","\u246e","\u246f","\u2470","\u2471","\u2472","\u2473","\u3251","\u3252","\u3253","\u3254","\u3255","\u3256","\u3257","\u3258","\u3259","\u325a","\u325b","\u325c","\u325d","\u325e","\u325f","\u32b1","\u32b2","\u32b3","\u32b4","\u32b5","\u32b6","\u32b7","\u32b8","\u32b9","\u32ba","\u32bb","\u32bc","\u32bd","\u32be","\u32bf"]});o.merge=function(e){var t=s.merge({},a.symbols,o,e.symbols);return delete t.merge,t},e.exports=o}).call(this,n(20))},2404:function(e,t,n){"use strict";(function(r){var i=n(54),a=n(34),s="Apple_Terminal"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).TERM_PROGRAM,o=n(105),c=n(76),u=e.exports=t,l="\x1b[",d=!1,p=u.code={bell:"\x07",beep:"\x07",beginning:"".concat(l,"G"),down:"".concat(l,"J"),esc:l,getPosition:"".concat(l,"6n"),hide:"".concat(l,"?25l"),line:"".concat(l,"2K"),lineEnd:"".concat(l,"K"),lineStart:"".concat(l,"1K"),restorePosition:l+(s?"8":"u"),savePosition:l+(s?"7":"s"),screen:"".concat(l,"2J"),show:"".concat(l,"?25h"),up:"".concat(l,"1J")},f=u.cursor={get hidden(){return d},hide:function(){return d=!0,p.hide},show:function(){return d=!1,p.show},forward:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l).concat(e,"C")},backward:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l).concat(e,"D")},nextLine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l,"E").repeat(e)},prevLine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l,"F").repeat(e)},up:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"A"):""},down:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"B"):""},right:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"C"):""},left:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"D"):""},to:function(e,t){return t?"".concat(l).concat(t+1,";").concat(e+1,"H"):"".concat(l).concat(e+1,"G")},move:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n="";return n+=e<0?f.left(-e):e>0?f.right(e):"",n+=t<0?f.up(-t):t>0?f.down(t):""},restore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.after,n=e.cursor,r=e.initial,i=e.input,a=e.prompt,s=e.size,o=e.value;if(r=c.isPrimitive(r)?String(r):"",i=c.isPrimitive(i)?String(i):"",o=c.isPrimitive(o)?String(o):"",s){var l=u.cursor.up(s)+u.cursor.to(a.length),d=i.length-n;return d>0&&(l+=u.cursor.left(d)),l}if(o||t){var p=!i&&r?-r.length:-i.length+n;return t&&(p-=t.length),""===i&&r&&!a.includes(r)&&(p+=r.length),u.cursor.move(p)}}},h=u.erase={screen:p.screen,up:p.up,down:p.down,line:p.line,lineEnd:p.lineEnd,lineStart:p.lineStart,lines:function(e){for(var t="",n=0;n<e;n++)t+=u.erase.line+(n<e-1?u.cursor.up(1):"");return e&&(t+=u.code.beginning),t}};u.clear=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.stdout.columns;if(!t)return h.line+f.to(0);var n,s=function(e){return a(o.unstyle(e)).length},c=e.split(/\r?\n/),u=0,l=i(c);try{for(l.s();!(n=l.n()).done;){var d=n.value;u+=1+Math.floor(Math.max(s(d)-1,0)/t)}}catch(p){l.e(p)}finally{l.f()}return(h.line+f.prevLine()).repeat(u-1)+h.line+f.to(0)}}).call(this,n(20))},2405:function(e,t,n){"use strict";var r=n(76),i=function(e,n){r.defineExport(t,e,n),r.defineExport(t,e.toLowerCase(),n)};i("AutoComplete",(function(){return n(2406)})),i("BasicAuth",(function(){return n(2408)})),i("Confirm",(function(){return n(2409)})),i("Editable",(function(){return n(2410)})),i("Form",(function(){return n(394)})),i("Input",(function(){return n(596)})),i("Invisible",(function(){return n(2412)})),i("List",(function(){return n(2413)})),i("MultiSelect",(function(){return n(2414)})),i("Numeral",(function(){return n(2415)})),i("Password",(function(){return n(2416)})),i("Scale",(function(){return n(2417)})),i("Select",(function(){return n(150)})),i("Snippet",(function(){return n(2418)})),i("Sort",(function(){return n(2420)})),i("Survey",(function(){return n(2421)})),i("Text",(function(){return n(2422)})),i("Toggle",(function(){return n(2423)})),i("Quiz",(function(){return n(2424)}))},2406:function(e,t,n){"use strict";var r=n(15),i=n(9),a=n(10),s=n(21),o=n(27),c=n(66),u=n(59),l=n(37),d=n(38),p=n(150),f=function(e,t){var n=e.toLowerCase();return function(e){var r=e.toLowerCase().indexOf(n),i=t(e.slice(r,r+n.length));return r>=0?e.slice(0,r)+i+e.slice(r+n.length):e}},h=function(e){l(n,e);var t=d(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).cursorShow(),r}return o(n,[{key:"moveCursor",value:function(e){this.state.cursor+=e}},{key:"dispatch",value:function(e){return this.append(e)}},{key:"space",value:function(e){return this.options.multiple?c(u(n.prototype),"space",this).call(this,e):this.append(e)}},{key:"append",value:function(e){var t=this.state,n=t.cursor,r=t.input;return this.input=r.slice(0,n)+e+r.slice(n),this.moveCursor(1),this.complete()}},{key:"delete",value:function(){var e=this.state,t=e.cursor,n=e.input;return n?(this.input=n.slice(0,t-1)+n.slice(t),this.moveCursor(-1),this.complete()):this.alert()}},{key:"deleteForward",value:function(){var e=this.state,t=e.cursor,n=e.input;return void 0===n[t]?this.alert():(this.input="".concat(n).slice(0,t)+"".concat(n).slice(t+1),this.complete())}},{key:"number",value:function(e){return this.append(e)}},{key:"complete",value:function(){var e=a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.completing=!0,e.next=3,this.suggest(this.input,this.state._choices);case 3:return this.choices=e.sent,this.state.limit=void 0,this.index=Math.min(Math.max(this.visible.length-1,0),this.index),e.next=8,this.render();case 8:this.completing=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"suggest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state._choices;if("function"===typeof this.options.suggest)return this.options.suggest.call(this,e,t);var n=e.toLowerCase();return t.filter((function(e){return e.message.toLowerCase().includes(n)}))}},{key:"pointer",value:function(){return""}},{key:"format",value:function(){var e=this;if(!this.focused)return this.input;if(this.options.multiple&&this.state.submitted)return this.selected.map((function(t){return e.styles.primary(t.message)})).join(", ");if(this.state.submitted){var t=this.value=this.input=this.focused.value;return this.styles.primary(t)}return this.input}},{key:"render",value:function(){var e=a(i.mark((function e(){var t,a,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"===this.state.status){e.next=2;break}return e.abrupt("return",c(u(n.prototype),"render",this).call(this));case 2:return t=this.options.highlight?this.options.highlight.bind(this):this.styles.placeholder,a=f(this.input,t),s=this.choices,this.choices=s.map((function(e){return r(r({},e),{},{message:a(e.message)})})),e.next=8,c(u(n.prototype),"render",this).call(this);case 8:this.choices=s;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){return this.options.multiple&&(this.value=this.selected.map((function(e){return e.name}))),c(u(n.prototype),"submit",this).call(this)}}]),n}(p);e.exports=h},2407:function(e,t,n){"use strict";var r=n(76),i={default:function(e,t){return t},checkbox:function(e,t){throw new Error("checkbox role is not implemented yet")},editable:function(e,t){throw new Error("editable role is not implemented yet")},expandable:function(e,t){throw new Error("expandable role is not implemented yet")},heading:function(e,t){return t.disabled="",t.indicator=[t.indicator," "].find((function(e){return null!=e})),t.message=t.message||"",t},input:function(e,t){throw new Error("input role is not implemented yet")},option:function(e,t){return i.default(e,t)},radio:function(e,t){throw new Error("radio role is not implemented yet")},separator:function(e,t){return t.disabled="",t.indicator=[t.indicator," "].find((function(e){return null!=e})),t.message=t.message||e.symbols.line.repeat(5),t},spacer:function(e,t){return t}};e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.merge({},i,t.roles);return n[e]||n.default}},2408:function(e,t,n){"use strict";var r=n(15),i=n(21),a=n(27),s=n(37),o=n(38),c=n(594);function u(e,t){return e.username===this.options.username&&e.password===this.options.password}e.exports=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=[{name:"username",message:"username"},{name:"password",message:"password",format:function(e){return this.options.showPassword?e:(this.state.submitted?this.styles.primary:this.styles.muted)(this.symbols.asterisk.repeat(e.length))}}],l=function(t){s(u,t);var c=o(u);function u(e){return i(this,u),c.call(this,r(r({},e),{},{choices:n}))}return a(u,null,[{key:"create",value:function(t){return e(t)}}]),u}(c.create(t));return l}()},2409:function(e,t,n){"use strict";var r=n(21),i=n(37),a=n(38),s=function(e){i(n,e);var t=a(n);function n(e){var i;return r(this,n),(i=t.call(this,e)).default=i.options.default||(i.initial?"(Y/n)":"(y/N)"),i}return n}(n(395));e.exports=s},2410:function(e,t,n){"use strict";var r=n(54),i=n(9),a=n(10),s=n(15),o=n(21),c=n(27),u=n(66),l=n(59),d=n(37),p=n(38),f=n(150),h=n(394).prototype,v=function(e){d(n,e);var t=p(n);function n(e){var r;return o(this,n),(r=t.call(this,s(s({},e),{},{multiple:!0}))).align=[r.options.align,"left"].find((function(e){return null!=e})),r.emptyError="",r.values={},r}return c(n,[{key:"dispatch",value:function(e,t){var r=this.focused,i=r.parent||{};return r.editable||i.editable||"a"!==e&&"i"!==e?h.dispatch.call(this,e,t):u(l(n.prototype),e,this).call(this)}},{key:"append",value:function(e,t){return h.append.call(this,e,t)}},{key:"delete",value:function(e,t){return h.delete.call(this,e,t)}},{key:"space",value:function(e){return this.focused.editable?this.append(e):u(l(n.prototype),"space",this).call(this)}},{key:"number",value:function(e){return this.focused.editable?this.append(e):u(l(n.prototype),"number",this).call(this,e)}},{key:"next",value:function(){return this.focused.editable?h.next.call(this):u(l(n.prototype),"next",this).call(this)}},{key:"prev",value:function(){return this.focused.editable?h.prev.call(this):u(l(n.prototype),"prev",this).call(this)}},{key:"indicator",value:function(){var e=a(i.mark((function e(t,r){var a,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.indicator||"",s=t.editable?a:u(l(n.prototype),"indicator",this).call(this,t,r),e.next=4,this.resolve(s,this.state,t,r);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0="";case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"indent",value:function(e){return"heading"===e.role?"":e.editable?" ":"  "}},{key:"renderChoice",value:function(){var e=a(i.mark((function e(t,r){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.indent="",!t.editable){e.next=3;break}return e.abrupt("return",h.renderChoice.call(this,t,r));case 3:return e.abrupt("return",u(l(n.prototype),"renderChoice",this).call(this,t,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"error",value:function(){return""}},{key:"footer",value:function(){return this.state.error}},{key:"validate",value:function(){var e=a(i.mark((function e(){var t,n,a,s,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=r(this.choices),e.prev=2,n.s();case 4:if((a=n.n()).done){e.next=19;break}if("function"===typeof(s=a.value).validate){e.next=8;break}return e.abrupt("continue",17);case 8:if("heading"!==s.role){e.next=10;break}return e.abrupt("continue",17);case 10:return o=s.parent?this.value[s.parent.name]:this.value,s.editable?o=s.value===s.name?s.initial||"":s.value:this.isDisabled(s)||(o=!0===s.enabled),e.next=14,s.validate(o,this.state);case 14:if(!0===(t=e.sent)){e.next=17;break}return e.abrupt("break",19);case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),n.e(e.t0);case 24:return e.prev=24,n.f(),e.finish(24);case 27:return!0!==t&&(this.state.error="string"===typeof t?t:"Invalid Input"),e.abrupt("return",t);case 29:case"end":return e.stop()}}),e,this,[[2,21,24,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){if(!0===this.focused.newChoice)return u(l(n.prototype),"submit",this).call(this);if(this.choices.some((function(e){return e.newChoice})))return this.alert();this.value={};var e,t=r(this.choices);try{for(t.s();!(e=t.n()).done;){var i=e.value,a=i.parent?this.value[i.parent.name]:this.value;"heading"!==i.role?i.editable?a[i.name]=i.value===i.name?i.initial||"":i.value:this.isDisabled(i)||(a[i.name]=!0===i.enabled):this.value[i.name]={}}}catch(s){t.e(s)}finally{t.f()}return this.base.submit.call(this)}}]),n}(f);e.exports=v},2411:function(e,t,n){"use strict";var r=n(34),i=function(e){return function(e){return e.filter((function(t,n){return e.lastIndexOf(t)===n}))}(e).filter(Boolean)};e.exports=function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=a.past,c=void 0===o?[]:o,u=a.present,l=void 0===u?"":u;switch(e){case"prev":case"undo":return t=c.slice(0,c.length-1),n=c[c.length-1]||"",{past:i([s].concat(r(t))),present:n};case"next":case"redo":return t=c.slice(1),n=c[0]||"",{past:i([].concat(r(t),[s])),present:n};case"save":return{past:i([].concat(r(c),[s])),present:""};case"remove":return l="",(n=i(c.filter((function(e){return e!==s})))).length&&(l=n.pop()),{past:n,present:l};default:throw new Error('Invalid action: "'.concat(e,'"'))}}},2412:function(e,t,n){"use strict";var r=n(21),i=n(27),a=n(37),s=n(38),o=function(e){a(n,e);var t=s(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"format",value:function(){return""}}]),n}(n(179));e.exports=o},2413:function(e,t,n){"use strict";var r=n(9),i=n(10),a=n(21),s=n(27),o=n(66),c=n(59),u=n(37),l=n(38),d=function(e){u(n,e);var t=l(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(this,n),(e=t.call(this,r)).sep=e.options.separator||/, */,e.initial=r.initial||"",e}return s(n,[{key:"split",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.value;return e?String(e).split(this.sep):[]}},{key:"format",value:function(){var e=this.state.submitted?this.styles.primary:function(e){return e};return this.list.map(e).join(", ")}},{key:"submit",value:function(){var e=i(r.mark((function e(t){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.state.error,e.t0){e.next=5;break}return e.next=4,this.validate(this.list,this.state);case 4:e.t0=e.sent;case 5:if(!0===(i=e.t0)){e.next=9;break}return this.state.error=i,e.abrupt("return",o(c(n.prototype),"submit",this).call(this));case 9:return this.value=this.list,e.abrupt("return",o(c(n.prototype),"submit",this).call(this));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"list",get:function(){return this.split()}}]),n}(n(179));e.exports=d},2414:function(e,t,n){"use strict";var r=n(15),i=n(21),a=n(37),s=n(38),o=function(e){a(n,e);var t=s(n);function n(e){return i(this,n),t.call(this,r(r({},e),{},{multiple:!0}))}return n}(n(150));e.exports=o},2415:function(e,t,n){e.exports=n(597)},2416:function(e,t,n){"use strict";var r=n(21),i=n(27),a=n(37),s=n(38),o=function(e){a(n,e);var t=s(n);function n(e){var i;return r(this,n),(i=t.call(this,e)).cursorShow(),i}return i(n,[{key:"format",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input;if(!this.keypressed)return"";var t=this.state.submitted?this.styles.primary:this.styles.muted;return t(this.symbols.asterisk.repeat(e.length))}}]),n}(n(179));e.exports=o},2417:function(e,t,n){"use strict";var r=n(34),i=n(54),a=n(9),s=n(10),o=n(21),c=n(27),u=n(66),l=n(59),d=n(37),p=n(38),f=n(105),h=n(284),v=n(76),g=function(e){d(n,e);var t=p(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,n),(e=t.call(this,r)).widths=[].concat(r.messageWidth||50),e.align=[].concat(r.align||"left"),e.linebreak=r.linebreak||!1,e.edgeLength=r.edgeLength||3,e.newline=r.newline||"\n   ";var i=r.startNumber||1;return"number"===typeof e.scale&&(e.scaleKey=!1,e.scale=Array(e.scale).fill(0).map((function(e,t){return{name:t+i}}))),e}return c(n,[{key:"reset",value:function(){var e=s(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tableized=!1,e.next=3,u(l(n.prototype),"reset",this).call(this);case 3:return e.abrupt("return",this.render());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"tableize",value:function(){if(!0!==this.tableized){this.tableized=!0;var e,t=0,n=i(this.choices);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=Math.max(t,r.message.length),r.scaleIndex=r.initial||2,r.scale=[];for(var a=0;a<this.scale.length;a++)r.scale.push({index:a})}}catch(s){n.e(s)}finally{n.f()}this.widths[0]=Math.min(this.widths[0],t+3)}}},{key:"dispatch",value:function(){var e=s(a.mark((function e(t,r){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.multiple){e.next=11;break}if(!this[r.name]){e.next=7;break}return e.next=4,this[r.name](t,r);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,u(l(n.prototype),"dispatch",this).call(this,t,r);case 9:e.t0=e.sent;case 10:return e.abrupt("return",e.t0);case 11:this.alert();case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"heading",value:function(e,t,n){return this.styles.strong(e)}},{key:"separator",value:function(){return this.styles.muted(this.symbols.ellipsis)}},{key:"right",value:function(){var e=this.focused;return e.scaleIndex>=this.scale.length-1?this.alert():(e.scaleIndex++,this.render())}},{key:"left",value:function(){var e=this.focused;return e.scaleIndex<=0?this.alert():(e.scaleIndex--,this.render())}},{key:"indent",value:function(){return""}},{key:"format",value:function(){var e=this;return this.state.submitted?this.choices.map((function(t){return e.styles.info(t.index)})).join(", "):""}},{key:"pointer",value:function(){return""}},{key:"renderScaleKey",value:function(){var e=this;if(!1===this.scaleKey)return"";if(this.state.submitted)return"";var t=this.scale.map((function(e){return"   ".concat(e.name," - ").concat(e.message)}));return[""].concat(r(t)).map((function(t){return e.styles.muted(t)})).join("\n")}},{key:"renderScaleHeading",value:function(e){var t=this,n=this.scale.map((function(e){return e.name}));"function"===typeof this.options.renderScaleHeading&&(n=this.options.renderScaleHeading.call(this,e));var r=this.scaleLength-n.join("").length,i=Math.round(r/(n.length-1)),a=n.map((function(e){return t.styles.strong(e)})).join(" ".repeat(i)),s=" ".repeat(this.widths[0]);return this.margin[3]+s+this.margin[1]+a}},{key:"scaleIndicator",value:function(e,t,n){if("function"===typeof this.options.scaleIndicator)return this.options.scaleIndicator.call(this,e,t,n);var r=e.scaleIndex===t.index;return t.disabled?this.styles.hint(this.symbols.radio.disabled):r?this.styles.success(this.symbols.radio.on):this.symbols.radio.off}},{key:"renderScale",value:function(e,t){var n=this,r=e.scale.map((function(r){return n.scaleIndicator(e,r,t)})),i="Hyper"===this.term?"":" ";return r.join(i+this.symbols.line.repeat(this.edgeLength))}},{key:"renderChoice",value:function(){var e=s(a.mark((function e(t,n){var r,i,s,o,c,u,l,d,p,h,g,y=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return r=this.index===n,e.next=5,this.pointer(t,n);case 5:return i=e.sent,e.next=8,t.hint;case 8:return(s=e.sent)&&!v.hasColor(s)&&(s=this.styles.muted(s)),o=function(e){return y.margin[3]+e.replace(/\s+$/,"").padEnd(y.widths[0]," ")},c=this.newline,u=this.indent(t),e.next=15,this.resolve(t.message,this.state,t,n);case 15:return l=e.sent,e.next=18,this.renderScale(t,n);case 18:return d=e.sent,p=this.margin[1]+this.margin[3],this.scaleLength=f.unstyle(d).length,this.widths[0]=Math.min(this.widths[0],this.width-this.scaleLength-p.length),h=v.wordWrap(l,{width:this.widths[0],newline:c}),g=h.split("\n").map((function(e){return o(e)+y.margin[1]})),r&&(d=this.styles.info(d),g=g.map((function(e){return y.styles.info(e)}))),g[0]+=d,this.linebreak&&g.push(""),e.abrupt("return",[u+i,g.join("\n")].filter(Boolean));case 28:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoices",value:function(){var e=s(a.mark((function e(){var t,n,i,o=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.submitted){e.next=2;break}return e.abrupt("return","");case 2:return this.tableize(),t=this.visible.map(function(){var e=s(a.mark((function e(t,n){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.renderChoice(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=6,Promise.all(t);case 6:return n=e.sent,e.next=9,this.renderScaleHeading();case 9:return i=e.sent,e.abrupt("return",this.margin[0]+[i].concat(r(n.map((function(e){return e.join(" ")})))).join("\n"));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=s(a.mark((function e(){var t,n,r,i,s,o,c,u,l,d,p,f,h,v;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.submitted,r=t.size,e.next=3,this.prefix();case 3:return i=e.sent,e.next=6,this.separator();case 6:return s=e.sent,e.next=9,this.message();case 9:return o=e.sent,c="",!1!==this.options.promptLine&&(c=[i,o,s,""].join(" "),this.state.prompt=c),e.next=14,this.header();case 14:return u=e.sent,e.next=17,this.format();case 17:return l=e.sent,e.next=20,this.renderScaleKey();case 20:return d=e.sent,e.next=23,this.error();case 23:if(e.t0=e.sent,e.t0){e.next=28;break}return e.next=27,this.hint();case 27:e.t0=e.sent;case 28:return p=e.t0,e.next=31,this.renderChoices();case 31:return f=e.sent,e.next=34,this.footer();case 34:h=e.sent,v=this.emptyError,l&&(c+=l),p&&!c.includes(p)&&(c+=" "+p),n&&!l&&!f.trim()&&this.multiple&&null!=v&&(c+=this.styles.danger(v)),this.clear(r),this.write([u,c,d,f,h].filter(Boolean).join("\n")),this.state.submitted||this.write(this.margin[2]),this.restore();case 43:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){this.value={};var e,t=i(this.choices);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.value[n.name]=n.scaleIndex}}catch(r){t.e(r)}finally{t.f()}return this.base.submit.call(this)}}]),n}(h);e.exports=g},2418:function(e,t,n){"use strict";var r=n(34),i=n(75),a=n(54),s=n(9),o=n(10),c=n(21),u=n(27),l=n(66),d=n(59),p=n(37),f=n(38),h=n(105),v=n(2419),g=function(e){p(n,e);var t=f(n);function n(e){var r;return c(this,n),(r=t.call(this,e)).cursorHide(),r.reset(!0),r}return u(n,[{key:"initialize",value:function(){var e=o(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(this);case 2:return this.interpolate=e.sent,e.next=5,l(d(n.prototype),"initialize",this).call(this);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=o(s.mark((function e(t){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.keys=[],this.state.invalid=new Map,this.state.missing=new Set,this.state.completed=0,this.state.values={},!0===t){e.next=10;break}return e.next=8,this.initialize();case 8:return e.next=10,this.render();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"moveCursor",value:function(e){var t=this.getItem();this.cursor+=e,t.cursor+=e}},{key:"dispatch",value:function(e,t){t.code||t.ctrl||null==e||!this.getItem()?this.alert():this.append(e,t)}},{key:"append",value:function(e,t){var n=this.getItem(),r=n.input.slice(0,this.cursor),i=n.input.slice(this.cursor);this.input=n.input="".concat(r).concat(e).concat(i),this.moveCursor(1),this.render()}},{key:"delete",value:function(){var e=this.getItem();if(this.cursor<=0||!e.input)return this.alert();var t=e.input.slice(this.cursor),n=e.input.slice(0,this.cursor-1);this.input=e.input="".concat(n).concat(t),this.moveCursor(-1),this.render()}},{key:"increment",value:function(e){return e>=this.state.keys.length-1?0:e+1}},{key:"decrement",value:function(e){return e<=0?this.state.keys.length-1:e-1}},{key:"first",value:function(){this.state.index=0,this.render()}},{key:"last",value:function(){this.state.index=this.state.keys.length-1,this.render()}},{key:"right",value:function(){if(this.cursor>=this.input.length)return this.alert();this.moveCursor(1),this.render()}},{key:"left",value:function(){if(this.cursor<=0)return this.alert();this.moveCursor(-1),this.render()}},{key:"prev",value:function(){this.state.index=this.decrement(this.state.index),this.getItem(),this.render()}},{key:"next",value:function(){this.state.index=this.increment(this.state.index),this.getItem(),this.render()}},{key:"up",value:function(){this.prev()}},{key:"down",value:function(){this.next()}},{key:"format",value:function(e){var t=this.state.completed<100?this.styles.warning:this.styles.success;return!0===this.state.submitted&&100!==this.state.completed&&(t=this.styles.danger),t("".concat(this.state.completed,"% completed"))}},{key:"render",value:function(){var e=o(s.mark((function e(){var t,n,r,i,a,o,c,u,l,d,p,f,h,v,g,y,m,b,k;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.index,r=t.keys,i=void 0===r?[]:r,a=t.submitted,o=t.size,c=[this.options.newline,"\n"].find((function(e){return null!=e})),e.next=4,this.prefix();case 4:return u=e.sent,e.next=7,this.separator();case 7:return l=e.sent,e.next=10,this.message();case 10:return d=e.sent,p=[u,d,l].filter(Boolean).join(" "),this.state.prompt=p,e.next=15,this.header();case 15:return f=e.sent,e.next=18,this.error();case 18:if(e.t0=e.sent,e.t0){e.next=21;break}e.t0="";case 21:return h=e.t0,e.next=24,this.hint();case 24:if(e.t1=e.sent,e.t1){e.next=27;break}e.t1="";case 27:if(v=e.t1,!a){e.next=32;break}e.t2="",e.next=35;break;case 32:return e.next=34,this.interpolate(this.state);case 34:e.t2=e.sent;case 35:return g=e.t2,y=this.state.key=i[n]||"",e.next=39,this.format(y);case 39:return m=e.sent,e.next=42,this.footer();case 42:b=e.sent,m&&(p+=" "+m),v&&!m&&0===this.state.completed&&(p+=" "+v),this.clear(o),k=[f,p,g,b,h.trim()],this.write(k.filter(Boolean).join(c)),this.restore();case 49:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getItem",value:function(e){var t=this.state,n=t.items,r=t.keys,i=t.index,a=n.find((function(e){return e.name===r[i]}));return a&&null!=a.input&&(this.input=a.input,this.cursor=a.cursor),a}},{key:"submit",value:function(){var e=o(s.mark((function e(){var t,o,c,u,p,f,v,g,y,m,b,k,x;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"===typeof this.interpolate){e.next=3;break}return e.next=3,this.initialize();case 3:return e.next=5,this.interpolate(this.state,!0);case 5:if(t=this.state,o=t.invalid,c=t.missing,u=t.output,p=t.values,!o.size){e.next=12;break}f="",v=a(o);try{for(v.s();!(g=v.n()).done;)y=i(g.value,2),m=y[0],b=y[1],f+="Invalid ".concat(m,": ").concat(b,"\n")}catch(f){v.e(f)}finally{v.f()}return this.state.error=f,e.abrupt("return",l(d(n.prototype),"submit",this).call(this));case 12:if(!c.size){e.next=15;break}return this.state.error="Required: "+r(c.keys()).join(", "),e.abrupt("return",l(d(n.prototype),"submit",this).call(this));case 15:return k=h.unstyle(u).split("\n"),x=k.map((function(e){return e.slice(1)})).join("\n"),this.value={values:p,result:x},e.abrupt("return",l(d(n.prototype),"submit",this).call(this));case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(n(223));e.exports=g},2419:function(e,t,n){"use strict";var r=n(54),i=n(15),a=n(9),s=n(10),o=n(21),c=n(105),u=function e(t){o(this,e),this.name=t.key,this.field=t.field||{},this.value=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"string"===typeof e?e.replace(/^['"]|['"]$/g,""):""}(t.initial||this.field.initial||""),this.message=t.message||this.name,this.cursor=0,this.input="",this.lines=[]},l=function(){var e=s(a.mark((function e(){var t,n,r,i,s,o,c,l,d,p,f,h,v,g,y,m,b=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=b.length>0&&void 0!==b[0]?b[0]:{},n=b.length>1&&void 0!==b[1]?b[1]:{},r=b.length>2&&void 0!==b[2]?b[2]:function(e){return e},i=new Set,s=t.fields||[],o=t.template,c=[],l=[],d=[],p=1,"function"!==typeof o){e.next=14;break}return e.next=13,o();case 13:o=e.sent;case 14:f=-1,h=function(){return o[++f]},v=function(){return o[f+1]},(g=function(e){e.line=p,c.push(e)})({type:"bos",value:""});case 19:if(!(f<o.length-1)){e.next=40;break}if(y=h(),!/^[^\S\n ]$/.test(y)){e.next=24;break}return g({type:"text",value:y}),e.abrupt("continue",19);case 24:if("\n"!==y){e.next=28;break}return g({type:"newline",value:y}),p++,e.abrupt("continue",19);case 28:if("\\"!==y){e.next=32;break}return y+=h(),g({type:"text",value:y}),e.abrupt("continue",19);case 32:if("$"!==y&&"#"!==y&&"{"!==y||"{"!==v()){e.next=36;break}if("continue"!==function(){for(var e=h(),t={type:"template",open:y+=e,inner:"",close:"",value:y},a=void 0;a=h();){if("}"===a){"}"===v()&&(a+=h()),t.value+=a,t.close=a;break}":"===a?(t.initial="",t.key=t.inner):void 0!==t.initial&&(t.initial+=a),t.value+=a,t.inner+=a}t.template=t.open+(t.initial||t.inner)+t.close,t.key=t.key||t.inner,n.hasOwnProperty(t.key)&&(t.initial=n[t.key]),t=r(t),g(t),d.push(t.key),i.add(t.key);var o=l.find((function(e){return e.name===t.key}));return t.field=s.find((function(e){return e.name===t.key})),o||(o=new u(t),l.push(o)),o.lines.push(t.line-1),"continue"}()){e.next=36;break}return e.abrupt("continue",19);case 36:"text"===(m=c[c.length-1]).type&&m.line===p?m.value+=y:g({type:"text",value:y}),e.next=19;break;case 40:return g({type:"eos",value:""}),e.abrupt("return",{input:o,tabstops:c,unique:i,keys:d,items:l});case 42:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function d(e,t,n,r){return function(n,i,a,s){return"function"===typeof a.field[e]?a.field[e].call(t,n,i,a,s):[r,n].find((function(e){return t.isValue(e)}))}}e.exports=function(){var e=s(a.mark((function e(t){var n,o,u,p,f,h,v,g,y,m,b;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.options,o=new Set(!0===n.required?[]:n.required||[]),u=i(i({},n.values),n.initial),e.next=5,l(n,u);case 5:return p=e.sent,f=p.tabstops,h=p.items,v=p.keys,g=d("result",t,n),y=d("format",t,n),m=d("validate",t,n,!0),b=t.isValue.bind(t),e.abrupt("return",s(a.mark((function e(){var i,u,l,d,p,k,x,w,I,C,M,R,E,P=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=P.length>0&&void 0!==P[0]?P[0]:{},u=P.length>1&&void 0!==P[1]&&P[1],l=0,i.required=o,i.items=h,i.keys=v,i.output="",d=function(){var e=s(a.mark((function e(t,n,r,i){var s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t,n,r,i);case 2:if(!1!==(s=e.sent)){e.next=5;break}return e.abrupt("return","Invalid field "+r.name);case 5:return e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),p=r(f),e.prev=9,x=a.mark((function e(){var r,s,o,p,f,v,m,x,w,I;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=k.value,s=r.value,o=r.key,"template"===r.type){e.next=6;break}return s&&(i.output+=s),e.abrupt("return","continue");case 6:if("template"!==r.type){e.next=35;break}if(p=h.find((function(e){return e.name===o})),!0===n.required&&i.required.add(p.name),f=[p.input,i.values[p.value],p.value,s].find(b),v=p.field||{},m=v.message||r.inner,!u){e.next=25;break}return e.next=15,d(i.values[o],i,p,l);case 15:if(!((x=e.sent)&&"string"===typeof x||!1===x)){e.next=19;break}return i.invalid.set(o,x),e.abrupt("return","continue");case 19:return i.invalid.delete(o),e.next=22,g(i.values[o],i,p,l);case 22:return w=e.sent,i.output+=c.unstyle(w),e.abrupt("return","continue");case 25:return p.placeholder=!1,I=s,e.next=29,y(s,i,p,l);case 29:s=e.sent,f!==s?(i.values[o]=f,s=t.styles.typing(f),i.missing.delete(m)):(i.values[o]=void 0,f="<".concat(m,">"),s=t.styles.primary(f),p.placeholder=!0,i.required.has(o)&&i.missing.add(m)),i.missing.has(m)&&i.validating&&(s=t.styles.warning(f)),i.invalid.has(o)&&i.validating&&(s=t.styles.danger(f)),l===i.index&&(s=I!==s?t.styles.underline(s):t.styles.heading(c.unstyle(s))),l++;case 35:s&&(i.output+=s);case 36:case"end":return e.stop()}}),e)})),p.s();case 12:if((k=p.n()).done){e.next=19;break}return e.delegateYield(x(),"t0",14);case 14:if("continue"!==e.t0){e.next=17;break}return e.abrupt("continue",17);case 17:e.next=12;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(9),p.e(e.t1);case 24:return e.prev=24,p.f(),e.finish(24);case 27:w=i.output.split("\n").map((function(e){return" "+e})),I=h.length,C=0,M=r(h);try{for(M.s();!(R=M.n()).done;)E=R.value,i.invalid.has(E.name)&&E.lines.forEach((function(e){" "===w[e][0]&&(w[e]=i.styles.danger(i.symbols.bullet)+w[e].slice(1))})),t.isValue(i.values[E.name])&&C++}catch(O){M.e(O)}finally{M.f()}return i.completed=(C/I*100).toFixed(0),i.output=w.join("\n"),e.abrupt("return",i.output);case 35:case"end":return e.stop()}}),e,null,[[9,21,24,27]])}))));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},2420:function(e,t,n){"use strict";var r=n(9),i=n(10),a=n(15),s=n(21),o=n(27),c=n(169),u=n(66),l=n(59),d=n(37),p=n(38),f="(Use <shift>+<up/down> to sort)",h=function(e){d(n,e);var t=p(n);function n(e){var r;return s(this,n),(r=t.call(this,a(a({},e),{},{reorder:!1,sort:!0,multiple:!0}))).state.hint=[r.options.hint,f].find(r.isValue.bind(c(r))),r}return o(n,[{key:"indicator",value:function(){return""}},{key:"renderChoice",value:function(){var e=i(r.mark((function e(t,i){var a,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(l(n.prototype),"renderChoice",this).call(this,t,i);case 2:if(a=e.sent,s=this.symbols.identicalTo+" ",o=this.index===i&&this.sorting?this.styles.muted(s):"  ",!1===this.options.drag&&(o=""),!0!==this.options.numbered){e.next=8;break}return e.abrupt("return",o+"".concat(i+1," - ")+a);case 8:return e.abrupt("return",o+a);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"selected",get:function(){return this.choices}},{key:"submit",value:function(){return this.value=this.choices.map((function(e){return e.value})),u(l(n.prototype),"submit",this).call(this)}}]),n}(n(150));e.exports=h},2421:function(e,t,n){"use strict";var r=n(15),i=n(9),a=n(54),s=n(10),o=n(21),c=n(27),u=n(66),l=n(59),d=n(37),p=n(38),f=function(e){d(n,e);var t=p(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o(this,n),(e=t.call(this,r)).emptyError=r.emptyError||"No items were selected",e.term=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).TERM_PROGRAM,!e.options.header){var i=["","4 - Strongly Agree","3 - Agree","2 - Neutral","1 - Disagree","0 - Strongly Disagree",""];i=i.map((function(t){return e.styles.muted(t)})),e.state.header=i.join("\n   ")}return e}return c(n,[{key:"toChoices",value:function(){var e=s(i.mark((function e(){var t,r,s,o,c,d,p,f,v=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.createdScales){e.next=2;break}return e.abrupt("return",!1);case 2:for(this.createdScales=!0,r=v.length,s=new Array(r),o=0;o<r;o++)s[o]=v[o];return e.next=6,(t=u(l(n.prototype),"toChoices",this)).call.apply(t,[this].concat(s));case 6:c=e.sent,d=a(c);try{for(d.s();!(p=d.n()).done;)(f=p.value).scale=h(5,this.options),f.scaleIdx=2}catch(i){d.e(i)}finally{d.f()}return e.abrupt("return",c);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatch",value:function(){this.alert()}},{key:"space",value:function(){var e=this.focused,t=e.scale[e.scaleIdx],n=t.selected;return e.scale.forEach((function(e){return e.selected=!1})),t.selected=!n,this.render()}},{key:"indicator",value:function(){return""}},{key:"pointer",value:function(){return""}},{key:"separator",value:function(){return this.styles.muted(this.symbols.ellipsis)}},{key:"right",value:function(){var e=this.focused;return e.scaleIdx>=e.scale.length-1?this.alert():(e.scaleIdx++,this.render())}},{key:"left",value:function(){var e=this.focused;return e.scaleIdx<=0?this.alert():(e.scaleIdx--,this.render())}},{key:"indent",value:function(){return"   "}},{key:"renderChoice",value:function(){var e=s(i.mark((function e(t,n){var r,a,s,o,c,u,l,d,p,f,h,v,g,y,m,b,k=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return r=this.index===n,a="Hyper"===this.term,s=a?9:8,o=a?"":" ",c=this.symbols.line.repeat(s),u=" ".repeat(s+(a?0:1)),l=function(e){return(e?k.styles.success("\u25c9"):"\u25ef")+o},d=n+1+".",p=r?this.styles.heading:this.styles.noop,e.next=13,this.resolve(t.message,this.state,t,n);case 13:return f=e.sent,h=this.indent(t),v=h+t.scale.map((function(e,n){return l(n===t.scaleIdx)})).join(c),g=function(e){return e===t.scaleIdx?p(e):e},y=h+t.scale.map((function(e,t){return g(t)})).join(u),m=function(){return[d,f].filter(Boolean).join(" ")},b=function(){return[m(),v,y," "].filter(Boolean).join("\n")},r&&(v=this.styles.cyan(v),y=this.styles.cyan(y)),e.abrupt("return",b());case 22:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoices",value:function(){var e=s(i.mark((function e(){var t,n,r=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.submitted){e.next=2;break}return e.abrupt("return","");case 2:return t=this.visible.map(function(){var e=s(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.renderChoice(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=5,Promise.all(t);case 5:return(n=e.sent).length||n.push(this.styles.danger("No matching choices")),e.abrupt("return",n.join("\n"));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"format",value:function(){var e=this;return this.state.submitted?this.choices.map((function(t){return e.styles.info(t.scaleIdx)})).join(", "):""}},{key:"render",value:function(){var e=s(i.mark((function e(){var t,n,r,a,s,o,c,u,l,d,p,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.submitted,r=t.size,e.next=3,this.prefix();case 3:return a=e.sent,e.next=6,this.separator();case 6:return s=e.sent,e.next=9,this.message();case 9:return o=e.sent,c=[a,o,s].filter(Boolean).join(" "),this.state.prompt=c,e.next=14,this.header();case 14:return u=e.sent,e.next=17,this.format();case 17:return l=e.sent,e.next=20,this.error();case 20:if(e.t0=e.sent,e.t0){e.next=25;break}return e.next=24,this.hint();case 24:e.t0=e.sent;case 25:return d=e.t0,e.next=28,this.renderChoices();case 28:return p=e.sent,e.next=31,this.footer();case 31:f=e.sent,!l&&d||(c+=" "+l),d&&!c.includes(d)&&(c+=" "+d),n&&!l&&!p&&this.multiple&&"form"!==this.type&&(c+=this.styles.danger(this.emptyError)),this.clear(r),this.write([c,u,p,f].filter(Boolean).join("\n")),this.restore();case 38:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){this.value={};var e,t=a(this.choices);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.value[n.name]=n.scaleIdx}}catch(r){t.e(r)}finally{t.f()}return this.base.submit.call(this)}}]),n}(n(284));function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(t.scale))return t.scale.map((function(e){return r({},e)}));for(var n=[],i=1;i<e+1;i++)n.push({i:i,selected:!1});return n}e.exports=f},2422:function(e,t,n){e.exports=n(596)},2423:function(e,t,n){"use strict";var r=n(9),i=n(10),a=n(21),s=n(27),o=n(66),c=n(59),u=n(37),l=n(38),d=function(e){u(n,e);var t=l(n);function n(){return a(this,n),t.apply(this,arguments)}return s(n,[{key:"initialize",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(c(n.prototype),"initialize",this).call(this);case 2:return this.value=this.initial=!!this.options.initial,this.disabled=this.options.disabled||"no",this.enabled=this.options.enabled||"yes",e.next=7,this.render();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.value=this.initial,this.render()}},{key:"delete",value:function(){this.alert()}},{key:"toggle",value:function(){this.value=!this.value,this.render()}},{key:"enable",value:function(){if(!0===this.value)return this.alert();this.value=!0,this.render()}},{key:"disable",value:function(){if(!1===this.value)return this.alert();this.value=!1,this.render()}},{key:"up",value:function(){this.toggle()}},{key:"down",value:function(){this.toggle()}},{key:"right",value:function(){this.toggle()}},{key:"left",value:function(){this.toggle()}},{key:"next",value:function(){this.toggle()}},{key:"prev",value:function(){this.toggle()}},{key:"dispatch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(e.toLowerCase()){case" ":return this.toggle();case"1":case"y":case"t":return this.enable();case"0":case"n":case"f":return this.disable();default:return this.alert()}}},{key:"format",value:function(){var e=this,t=function(t){return e.styles.primary.underline(t)};return[this.value?this.disabled:t(this.disabled),this.value?t(this.enabled):this.enabled].join(this.styles.muted(" / "))}},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s,o,c,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.size,e.next=3,this.header();case 3:return n=e.sent,e.next=6,this.prefix();case 6:return i=e.sent,e.next=9,this.separator();case 9:return a=e.sent,e.next=12,this.message();case 12:return s=e.sent,e.next=15,this.format();case 15:return o=e.sent,e.next=18,this.error();case 18:if(e.t0=e.sent,e.t0){e.next=23;break}return e.next=22,this.hint();case 22:e.t0=e.sent;case 23:return c=e.t0,e.next=26,this.footer();case 26:u=e.sent,l=[i,s,a,o].join(" "),this.state.prompt=l,c&&!l.includes(c)&&(l+=" "+c),this.clear(t),this.write([n,l,u].filter(Boolean).join("\n")),this.write(this.margin[2]),this.restore();case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(n(395));e.exports=d},2424:function(e,t,n){"use strict";var r=n(9),i=n(10),a=n(21),s=n(27),o=n(66),c=n(59),u=n(37),l=n(38),d=function(e){u(n,e);var t=l(n);function n(e){var r;if(a(this,n),"number"!==typeof(r=t.call(this,e)).options.correctChoice||r.options.correctChoice<0)throw new Error("Please specify the index of the correct answer from the list of choices");return r}return s(n,[{key:"toChoices",value:function(){var e=i(r.mark((function e(t,i){var a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(c(n.prototype),"toChoices",this).call(this,t,i);case 2:if(!((a=e.sent).length<2)){e.next=5;break}throw new Error("Please give at least two choices to the user");case 5:if(!(this.options.correctChoice>a.length)){e.next=7;break}throw new Error("Please specify the index of the correct answer from the list of choices");case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"check",value:function(e){return e.index===this.options.correctChoice}},{key:"result",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.t1=this.options.choices[this.options.correctChoice].value,e.next=4,this.check(this.state);case 4:return e.t2=e.sent,e.abrupt("return",{selectedAnswer:e.t0,correctAnswer:e.t1,correct:e.t2});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(n(150));e.exports=d},2425:function(e,t,n){e.exports={ArrayPrompt:n(284),AuthPrompt:n(594),BooleanPrompt:n(395),NumberPrompt:n(597),StringPrompt:n(179)}},2428:function(e,t,n){var r=n(9),i=n(10),a=(n(118),n(74)),s=(n(146).promisify,n(261)),o=n(47)("dos:commands:config"),c=n(598).getHomePath,u=a.join(s.homedir(),".cmd-prototype"),l={set:function(e,t,n){return i(r.mark((function i(){var a,s,l,p,f;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o("set",t,n),a=e.configPath||u,r.next=4,d(a);case 4:return(s=r.sent)[t]=n,r.next=8,writeFile(a,JSON.stringify(s));case 8:if("apiaddr"!==t.toLowerCase()){r.next=15;break}return l=(e.IpfsApi||IpfsApi)(n),p=new Ipld(l.block),r.next=13,c(l);case 13:return f=r.sent,r.abrupt("return",{ctx:{ipld:p,ipfs:l,wd:f}});case 15:case"end":return r.stop()}}),i)})))()},get:function(e,t){return i(r.mark((function n(){var i,a;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o("get",t),n.next=3,d(e.configPath||u);case 3:return i=n.sent,a=t?i[t]:i,n.abrupt("return",{out:a});case 6:case"end":return n.stop()}}),n)})))()}};function d(e){return p.apply(this,arguments)}function p(){return(p=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=JSON,e.next=4,readFile(t);case 4:e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),o("failed to read config",e.t2);case 11:return e.abrupt("return",n||{});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}e.exports=function(){var e=i(r.mark((function e(t,n){var i,a,s,o=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l[n]){e.next=2;break}throw new Error("".concat(n,": subcommand not found"));case 2:for(i=o.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=o[s];return e.abrupt("return",l[n].apply(l,[t].concat(a)));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},2429:function(e,t,n){(function(t){e.exports=function(e){var n=e.spinner;n&&n.stop(),t.exit()},e.exports.help="Exit the current program"}).call(this,n(20))},2430:function(e,t,n){var r=n(47)("dos:commands:help"),i=n(285),a=n(397);n(2441);e.exports=function(e){var t=i();r("help: ",Object.keys(a)),t.div('Use the following commands (use "tab" for autocomplete):\n');var n=Object.keys(a).filter((function(e){return!!a[e].help}));n.forEach((function(e){t.div({text:e,width:20,padding:[0,0,0,0]},a[e].help.replace(/\n|\r|\r\n/g," ").trim()),t.div()}));var s=Object.keys(a).filter((function(e){return!a[e].help}));return t.div("No help provided for:\n"),t.div("    "+s.toString()),t.div(),{out:t.toString()}},e.exports.help="\nPrints this message\n"},2442:function(e,t,n){var r=n(9),i=n(10),a=n(12),s=n(47)("dos:commands:ls"),o=n(74),c=n(285),u=n(90);n(2443);e.exports=function(){var e=i(r.mark((function e(t){var n,i,l,d,p,f,h,v=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,i=t.blockchain,l=v.length>1&&void 0!==v[1]?v[1]:".",n.text="Resolving ".concat(l),s("ls",l),e.next=6,i.ls(l);case 6:return d=e.sent,p=d.children,f=c(),h=Object.keys(p).sort((function(e,t){if(".."===e)return-1;if(".."===t)return 1;if("."===e)return-1;if("."===t)return 1;if(".@@io"===e)return-1;if(".@@io"===t)return 1;var n=e.toUpperCase(),r=t.toUpperCase();return n<r?-1:n>r?1:0})).filter((function(e){return!e.includes("/")})),s("aliases: ",h),h.forEach((function(e){s("child: ".concat(e));var t,n=p[e],r=n.systemRole,c=n.chainId,d=n.lineageHeight,h=n.heavyHeight;n.hash;c=64===c.length?c.substring(0,8):c;var v=i.getState().network,g="ROOT"===p[".."].chainId;if("."===e)if(g)c=i.getChainId().substring(0,8),h=d=i.getHeight();else{var y=i.getContext().wd,m=o.resolve(y,l).substring(1),b=v[m];a(b,"No self channel found for: ".concat(m)),h=b.heavyHeight,d=b.lineageHeight,c=b.address.getChainId().substring(0,8)}-1===d&&(d="-"),-1===h&&(h="-");var k=h+"."+d;t="UP_LINK"!==r?u.red(e):u.green(e),f.div({text:t,width:20},{text:k,width:10},{text:c,width:55})})),e.abrupt("return",{out:f.toString()});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nlist the objects at the cwd.  lists alias, heavy height.lineage height, and chainId\n"},2444:function(e,t){e.exports=function(e){return{out:e.wd}}},2445:function(e,t,n){var r=n(2446);e.exports=function(){return{out:"v".concat(r.version)}}},2446:function(e){e.exports=JSON.parse('{"name":"@dreamcatcher-tech/dos","version":"0.0.0","description":"Terminal interface to the HyperNet","main":"src/index.js","bin":{"dos":"src/bin.js"},"scripts":{"start":"DEBUG=\'*dos*\' node src/bin","dev":"nodemon src/bin"},"author":"","license":"AGPL-3.0-or-later","dependencies":{"better-opn":"^2.0.0","chalk":"^4.1.0","clear":"^0.1.0","cliui":"^6.0.0","commander":"^6.1.0","debug":"^4.1.0","dedent":"^0.7.0","detect-node":"^2.0.4","docker-names":"^1.1.1","enquirer":"^2.3.6","figlet":"^1.2.4","filesize":"^3.6.1","localforage":"^1.9.0","ora":"^3.0.0","pad":"^3.2.0","pretty-ms":"^7.0.0","pull-stream":"^3.6.9","random-hash":"^4.0.1","wordwrap":"^1.0.0"},"devDependencies":{"nodemon":"^1.19.3"},"nodemonConfig":{"verbose":false,"watch":["./","/code/interblock"]},"jest":{"testEnvironment":"node","transform":{}},"prettier":{"trailingComma":"es5","tabWidth":2,"semi":false,"singleQuote":true}}')},2447:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:pkg");e.exports=function(){var e=i(r.mark((function e(t,n){var i,s,o,c,u,l,d,p=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.spinner,s=t.blockchain,o=p.length,c=new Array(o>2?o-2:0),u=2;u<o;u++)c[u-2]=p[u];a(n,c),e.t0=n,e.next=""===e.t0||"help"===e.t0?6:"install"===e.t0?8:22;break;case 6:return a("help command"),e.abrupt("break",22);case 8:if(l=c[0],d=c[1],"string"===typeof l){e.next=12;break}throw new Error("Invalid dpkg path: ".concat(l));case 12:if("string"===typeof d){e.next=14;break}throw new Error("Invalid install path: ".concat(d));case 14:return i.text="Installing from path: ".concat(l," to: ").concat(d),i.start(),e.next=19,s.install(l,d);case 19:return i.info("Install complete"),e.abrupt("break",22);case 22:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.exports.help="\nThe platform package manager.  Use list --installed \nto list all applications installed on the system.\nuse list to show all available applications available for install.\nUse search to narrow down the list of available packages.\nDefaults to listing installed applications.\n"},2448:function(e,t,n){var r=n(2449);e.exports=function(){return r()},e.exports.help="Clear the screen"},2450:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:error"),s=0;e.exports=function(){var e=i(r.mark((function e(t,n){var o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="Test Error",!n){e.next=7;break}return a("async error test"),c=function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:throw new Error("async: "+o+" "+s++);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=6,c();case 6:return e.abrupt("return",e.sent);case 7:throw a("sync error test"),new Error(o+" "+s++);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.exports.help="Throw an error, to test system response"},2451:function(e,t,n){var r=n(9),i=n(10),a=(n(104).prompt,n(2452));e.exports=function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return debug("open: ",n),e.next=3,a("https://aws.amazon.com/cognito/");case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},2454:function(e,t,n){var r=n(9),i=n(10);n(47)("dos:commands:login");e.exports=function(){var e=i(r.mark((function e(t){var n,i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,i=t.blockchain,a="34e3c74c43c0e9b2f3f2ef9f93a0f427ededf5878891b23d792d8f7c1a174b94",n.info("logging in to ".concat(a)).start(),n.text="connecting to: ".concat(url),e.next=6,i.addTransport(a,{url:url});case 6:return s=e.sent,n.succeed("latency of ".concat(s," ms ").concat(url)).start(),n.text="logging in to chain",e.next=11,i.login({chainId:a});case 11:return n.succeed("login successful"),e.abrupt("return",{out:url});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help='Loop the user through a signon process that links\nThe current machine pubkey to their interblock user chain.\nWhen this occurs, the guest chain will transition to the\nuser chain, and the prompt will change from "guest" to "user"'},2455:function(e,t,n){var r=n(9),i=n(10),a=function(e){return new Promise((function(t){return setTimeout(t,e)}))};e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\n"),n(287)("https://aws.amazon.com/cognito/"),e.abrupt("return",a(2e3));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nDisconnect from the current remote host, else error and stay as local\n"},2456:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:su"),s=(new(n(2457).Command),n(104).prompt);e.exports=function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(n),n){e.next=3;break}throw new Error("must supply user name or chainId to elevate to");case 3:return e.next=5,s([{name:"password"}]);case 5:i=e.sent,a(i);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},2458:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:add"),s=n(90);n(104).prompt;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c,u,l,d,p,f,h,v,g,y=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.spinner,i=t.blockchain,o=y.length,c=new Array(o>1?o-1:0),u=1;u<o;u++)c[u-1]=y[u];a("add: %O",c),c.length||(c=[void 0]),l="",d=0,p=c;case 6:if(!(d<p.length)){e.next=19;break}return f=p[d],n.text="adding ".concat(f,"..."),e.next=11,i.add(f);case 11:h=e.sent,v=h.alias,g=h.chainId,n.succeed("added ".concat(f)).start(),l+="Added: ".concat(s.red(v),"\n - chainId: ").concat(s.greenBright(g),"\n");case 16:d++,e.next=6;break;case 19:return e.abrupt("return",{out:l.trim()});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nThis command will be overridden by each application.\nIt serves as the general action of creating a new entity\nwhere the entity is specific to the application being executed.\nWhen used in the native setting, it makes a blank datum chain.\nDepending on the context, additional info may need to be provided to\ncreate the child.\n"},2459:function(e,t,n){var r=n(9),i=n(10);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.exports.help="\nLinking is act of inserting one Object as the child of another\nwhich allows an Object to be the child of more than one parent.\nThis operation is essential to application data structures\nas opposed to simple filesystem data structures, which are \nusually a tree\n"},246:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(9),i=n.n(r),a=n(136),s=n(14),o=n(12),c=n.n(o),u=n(0),l=n(78),d=n(42),p=n.n(d),f=n(110),h=p()("terminal:useBlockstream"),v=function(e,t){var n=Object(l.a)(),r=n.blockchain,o=n.latest,d=Object(u.useState)(),p=Object(s.a)(d,2),v=p[0],g=p[1],y=Object(u.useState)(),m=Object(s.a)(y,2),b=m[0],k=m[1],x=Object(f.b)(e);return Object(u.useEffect)((function(){var t,n=!0,s=function(){return n=!1};return function(){var u=Object(a.a)(i.a.mark((function a(){var u,l,d,p;return i.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:u=x.shift(),l=o,d=o.getChainId();case 3:if(u===e){i.next=17;break}if(u=x.shift(),p=u.split("/").pop(),h("alias %s",p),c()(l.network[p].address.isResolved()),d=l.network[p].address.getChainId(),u===e){i.next=15;break}return i.next=12,r.getLatest(d);case 12:if(l=i.sent,n){i.next=15;break}return i.abrupt("return");case 15:i.next=3;break;case 17:t=d.substring(0,9),h("subscribe %s %s",e,t),s=r.subscribeBlockstream(d,(function(n){v&&!v.isNext(n)||(h("setting block",e,t,n.getHeight()),g(n))}));case 20:case"end":return i.stop()}}),a)})));return function(){return u.apply(this,arguments)}}()(),function(){h("teardown",e,t),s()}}),[r,e,t]),e!==b?(g(),void k(e)):v}},2460:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:rm");n(90),n(104).prompt;e.exports=function(){var e=i(r.mark((function e(t,n){var i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner,i=t.blockchain,a("rm: %O",n),e.next=4,i.rm(n);case 4:s=e.sent,a("result: %O",s);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.exports.help="\nRemove blockchains.  If they are symlinks, will remove\nthe link only.  If children, will be permanently deleted.\n"},2461:function(e,t,n){var r=n(9),i=n(10),a=(n(47)("dos:commands:whoami"),n(90)),s=n(285);e.exports=function(){var e=i(r.mark((function e(t){var n,i,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.blockchain,i=n.getState().getChainId(),(o=s()).div({text:"User:",width:15},"root"),o.div({text:"Machine:",width:15},a.green(i)),o.div({text:"Hypercomputer:",width:15},a.red("NOT CONNECTED")),e.abrupt("return",{out:o.toString()});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nLists info about the current machine, current user, and connected hypercomputer\n"},2462:function(e,t,n){var r=n(9),i=n(10);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(287)("https://aws.amazon.com/cognito/");case 1:case"end":return e.stop()}}),e)})))},2463:function(e,t,n){var r=n(9),i=n(10),a=n(2464),s=n(47)("dos:commands:time");e.exports=function(){var e=i(r.mark((function e(t){var i,o,c,u,l,d,p,f,h,v,g,y,m,b,k,x,w,I=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.blockchain,o=n(396),c=o.evaluate,u=I.length,l=new Array(u>1?u-1:0),d=1;d<u;d++)l[d-1]=I[d];if(!(l.length<1)){e.next=5;break}throw new Error("Must supply command");case 5:return p=l[0],f=l.slice(1),s("time: ",p,f),h=i.getBlockCount(),v=i.getChainCount(),g=Date.now(),e.next=12,c(t,p,f);case 12:if(e.t0=e.sent,e.t0){e.next=15;break}e.t0={};case 15:return(y=e.t0).out=y.out?y.out+"\n":"",m={compact:!1,separateMilliseconds:!0},y.out=y.out+"Time: ".concat(a(Date.now()-g,m)),b=i.getBlockCount(),k=i.getChainCount(),x=b-h,w=k-v,y.out=y.out+" [blocks: ".concat(b," chains: ").concat(k,"]"),y.out=y.out+" [blocks++: ".concat(x," chains++: ").concat(w,"]"),e.abrupt("return",y);case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nMeasure how long a command takes.\n"},2466:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:ping");e.exports=function(){var e=i(r.mark((function e(t,n,i){var s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner,s=t.blockchain,a("ping path: %O options: %O",n,i),e.next=4,s.ping(n);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),e.exports.help="\nSend a ping to a chain, receive a response.\n\nTODO: \n1. send data with the ping\n2. ping indefinitely\n3. do 4 pings and report average times\n4. allow path pings\n"},2467:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:reset"),s=n(104).prompt;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,t.blockchain,a("reset"),n.stop(),e.next=5,s({type:"confirm",name:"reset",message:"Resetting will delete all local blockchains"});case 5:return i=e.sent,o=i.reset,c=o?"All local blockchains deleted":"Cancelled reset",e.abrupt("return",{out:c});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nDump all the local blockchain state, generate a new\ngenesis block, reset login status.\nIn dev mode will also reset the emulated aws.\n"},2468:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:dns");n(90),n(104).prompt;e.exports=function(){var t=i(r.mark((function t(n,i){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.spinner,n.blockchain,a("dns %O",i),t.abrupt("return",{out:e.exports.help});case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.exports.help="\nService to map strings to chainIds.\nMultiple services and manual overrides can be provided.\n"},2469:function(e,t,n){var r=n(9),i=n(10),a=n(146),s=n(47)("dos:commands:cat"),o=(n(90),n(104).prompt,n(74));e.exports=function(){var e=i(r.mark((function e(t){var n,i,c,u,l,d,p,f,h,v,g,y,m,b=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.spinner,n=t.blockchain,i=b.length,c=new Array(i>1?i-1:0),u=1;u<i;u++)c[u-1]=b[u];return l=c[0],d=void 0===l?".":l,p=c.slice(1),s("cat path: %O args: %O",d,p),f=n.getContext(),h=f.wd,v=o.resolve(h,d),s("absolutePath",v),e.next=9,n.getLatestFromPath(v);case 9:return g=e.sent,y=g.state,m=a.inspect(y,{colors:!0,depth:null}),e.abrupt("return",{out:m});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nShow the internal state of a chain.\n\nTODO\nArgs for full state, or partial state, or a particular path in the state.\n"},2470:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:tx");n(90),n(104).prompt;e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.spinner,t.blockchain,a("TODO tx: %O");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nList and modify the transports used.  These are typically URLs\nwhich point to various block producing peers\n"},2471:function(e,t,n){var r=n(9),i=n(10),a=n(47);e.exports=function(){var e=i(r.mark((function e(t){var n,i,s,o,c,u,l,d,p=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.blockchain,i=p.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=p[o];return c=s.join(" "),u=n._debug.disable(),l=a.disable(),d="current interblock flags: "+u,d+="\ncurrent dos flags: "+l,d+="\nsetting flags to: "+c,n._debug.enable(c),a.enable(c),e.abrupt("return",{out:d});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nChange flags to alter debug output on console.\n\nWith no arguments, toggle disable and enable, and will print the currently set flags.\nOtherwise will set the current flags.\n\nSee https://github.com/visionmedia/debug"},2472:function(e,t,n){var r=n(9),i=n(10);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(287)("https://aws.amazon.com/cognito/");case 1:case"end":return e.stop()}}),e)})))},2473:function(e,t,n){var r=n(9),i=n(10),a=n(90),s=n(285),o=a.bold.yellow("Object"),c=a.bold.yellow("Link"),u=a.bold.yellow("Covenant"),l=a.bold.yellow("StateMachine"),d=a.bold.yellow("DistributedOperatingSystem"),p=a.bold.yellow("FileSystem"),f=a.bold.yellow("App");e.exports=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=s()).div("Everything in this ".concat(d," is a Blockchain ").concat(o)),t.div(),t.div({text:"1.",width:4},"".concat(o,"s exist everywhere independent of any single computer because they are virtual, and not tied to a particular machine, freeing them from the faults of nature which plague physical hardware")),t.div({text:"2.",width:4},"".concat(o,"s can connect to each other to transfer instructions or payload data via ").concat(c,"s.")),t.div({text:"3.",width:4},"The logic governing the behaviour of ".concat(o,"s is inside a ").concat(u)),t.div({text:"4.",width:4},"A subclass of ".concat(u," is a ").concat(l)),t.div({text:"5.",width:4},"In our system, ".concat(o,"s are only changed internally by ").concat(l,"s")),t.div({text:"6.",width:4},"When viewed as a Graph, the ".concat(c,"s between all ").concat(o,"s are the ").concat(p)),t.div({text:"7.",width:4},"The ".concat(p," is arranged in a hierarchy from a root, so that it looks like a POSIX filesystem for the familiarity of our users")),t.div({text:"8.",width:4},"When viewed as executables, the collection of ".concat(l,"s are the ").concat(f,"s of our ").concat(d," ")),t.div({text:"9.",width:4},"Including the ".concat(f," named the Dreamcatcher means we by default include the ").concat(f," that coordinates Talent into making more ").concat(f,"s")),t.div(),t.div("type 'help' for a list of commands"),t.div(),e.abrupt("return",{out:t.toString()});case 16:case"end":return e.stop()}}),e)}))),e.exports.help="Information about the HyperNet"},2474:function(e,t,n){var r=n(9),i=n(10),a=n(12),s=n(74),o=n(47)("dos:commands:blocks"),c=n(323).engine.blockPrint;e.exports=function(){var e=i(r.mark((function e(t){var n,i,l,d,p,f,h,v,g,y,m,b,k,x,w,I,C,M,R=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.blockchain,i=R.length,l=new Array(i>1?i-1:0),d=1;d<i;d++)l[d-1]=R[d];p=l[0],f=l[1],h=l[2],v=l.slice(3),o("blocks %O",p,f,h,v),f=u(f),h=u(h),g=n.getContext(),y=g.wd,p=p||y,m=s.resolve(y,p),o("using path: %o",m),b=m.split("/"),o("path segment count: ",b.length);case 12:if(!b.length){e.next=22;break}if(k=b.shift()){e.next=16;break}return e.abrupt("continue",12);case 16:if(n[k]){e.next=18;break}throw new Error("invalid path: ".concat(m," stopped on: ").concat(k));case 18:o("segment: ",k),n=n[k],e.next=12;break;case 22:for(w=n.getState().provenance.height,I=Number.isInteger(h)?h:w,C=Number.isInteger(f)?f:0,a(C<=I,"start must be less than or equal to stop"),M="";C<=I;)x=n.getState(C),M+=c(x,m)+"\n",C++,o("next height: ",C);return e.abrupt("return",{out:M});case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var u=function(e){try{return parseInt(e)}catch(t){}};e.exports.help="\nShow the blocks of any given blockchain.\nIf no chain ID or alias given, print the blocks of the \nblockchain at the cwd\n"},2475:function(e,t,n){var r=n(9),i=n(10);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.exports.help="\nTo ensure the integrity of the system, invoke scrub to\ncheck the hashes of all objects at this location,\nand to verify the availability of all objects.\nUse the option --history to check all blocks in the past\nas well as LATEST.  This will incur significant usage fees\nand bandwidth.\n"},2476:function(e,t,n){var r=n(9),i=n(10),a=n(47)("dos:commands:namegen"),s=n(2477);e.exports=function(){var e=i(r.mark((function e(t){var n,i,o=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.spinner,t.blockchain,n=o.length>1&&void 0!==o[1]?o[1]:1,a("count: %O",n),i="";n>0;)i+=s.getRandomName(),--n>0&&(i+="\n");return e.abrupt("return",{out:i});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nGenerate a random name, which can be used as an identity for anything.\n"},2478:function(e,t,n){var r=n(9),i=n(10);n(47)("dos:commands:add"),n(90),n(104).prompt;e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.spinner,t.blockchain;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nView, change the validator set of a chain or group of chains.\nRecursively change all validators of the chains children.\nValidators must accept the role before the handover is complete.\nCan be used to force a change if a chain has stalled.\n"},2479:function(e,t,n){var r=n(9),i=n(10),a=n(21),s=n(27),o=n(47)("dos:auto-complete"),c=n(90),u=n(398).withSpin,l=n(397),d=function(){"use strict";function e(){a(this,e),this._list=[],this.getList=this.getList.bind(this)}return s(e,[{key:"updateList",value:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.wd,(n=t.spinner)&&(n.text="Updating auto-complete list"),i=Object.keys(l),[],this._list=i;case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getList",value:function(e){return e.includes(" ")?this._list:Object.keys(l)}}]),e}();t.AutoComplete=d,t.withAutoComplete=function(e){return function(){var t=i(r.mark((function t(n){var i=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.autoComplete||(n.autoComplete=new d,n.autoComplete.updateList=u(n.autoComplete.updateList)),t.prev=1,t.next=4,n.autoComplete.updateList(n);case 4:t.next=10;break;case 6:t.prev=6,t.t0=t.catch(1),console.warn("".concat(c.yellow("\u26a0")," failed to update auto-complete list")),o(t.t0);case 10:return o("auto-complete"),t.abrupt("return",e.apply(this,i));case 12:case"end":return t.stop()}}),t,this,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()}},2480:function(e,t,n){var r=n(9),i=n(10);n(47)("dos:loop");e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,t();case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},25:function(e,t,n){var r=n(15),i={};["aclModel","actionModel","addressModel","binaryModel","blockModel","covenantIdModel","continuationModel","dmzModel","configModel","integrityModel","interblockModel","keypairModel","lockModel","provenanceModel","publicKeyModel","signatureModel","timestampModel","channelModel","networkModel","stateModel","remoteModel","validatorsModel","proofModel","pendingModel","simpleArrayModel"].forEach((function(e){try{var t=n(821)("./".concat(e));i[e]=t[e]}catch(r){throw console.error("error loading: ".concat(e)),r}}));var a=n(2303),s=n(379),o=n(260).registry;o.registerModels(i),o.registerModels(a),o.registerModels(s);var c=n(2305),u=n(174),l=u.ciSigner,d=u.pierceSigner;e.exports=r(r(r(r({},i),s),a),{},{registry:o,cryptoCacher:c,ciSigner:l,pierceSigner:d})},260:function(e,t){var n={},r={registerModels:function(e){Object.keys(e).forEach((function(t){var r=e[t];if(!t||!e[t])throw new Error("".concat(t," passed in as undefined"));var i=r.schema.title;if(n[i])throw new Error("".concat(i," was already registered"));n[i]=r}))},isRegistered:function(e){return!!n[e]},get:function(e){if(!n[e])throw new Error("Model not found in registry: ".concat(e));return n[e]},_getContainer:function(){return n}};e.exports={registry:r}},269:function(e,t,n){var r=n(12),i=n(41).standardize,a=n(375).covenantIdModel,s=n(274).timestampModel,o=n(175).keypairModel,c=n(355).aclModel,u=n(373).binaryModel,l=n(275).networkModel,d=n(384).stateModel,p=n(385).configModel,f=n(386).validatorsModel,h=n(387).pendingModel,v=i({schema:{type:"object",title:"Dmz",description:"DMZ coordinates all the models in one place.\nDmz is equivalent to CombineReducers in Redux.",required:["validators","encryption","config","network","covenantId","binaryIntegrity","acl","state","pending"],additionalProperties:!1,properties:{validators:f.schema,encryption:o.schema,config:p.schema,covenantId:a.schema,binaryIntegrity:u.schema,timestamp:s.schema,acl:c.schema,network:l.schema,state:d.schema,pending:h.schema}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r("object"===typeof e);var t={validators:f.clone(e.validators),encryption:o.clone(e.encryption),config:p.create(e.config),covenantId:a.clone(e.covenantId),binaryIntegrity:u.clone(e.binaryIntegrity),acl:c.clone(e.acl),network:l.clone(e.network),state:d.clone(e.state),pending:h.create()};return v.clone(t)},logicize:function(e){var t=e.network,n=e.pending,i=e.config;r(n.isBufferValid(t)),r(!t[".@@io"]||i.isPierced);return{rx:function(){var e=t.rxReply();if(e)return e;if(!n.getIsPending()){var r=n.rxBufferedRequest(t);if(r)return r}return t.rxRequest()}}}});e.exports={dmzModel:v}},270:function(e,t,n){var r=n(12),i=n(18)("interblock:dmz:utils"),a=n(268),s=n(25).channelModel;e.exports={autoAlias:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file_",n=0;return e.getAliases().forEach((function(e){if(e.startsWith(t))try{var r=parseInt(e.substring(t.length));n=r>n?r:n}catch(a){throw i("autoAlias error: ",a),a}})),t+a(5,n+1,"0")},getChannelParams:function(e,t){var n=e[t];r(s.isModel(n));var i=n.address,a=n.systemRole,o=n.lineageHeight,c=n.heavyHeight,u=n.heavy,l=i.isResolved()?i.getChainId():"UNRESOLVED",d={systemRole:a,chainId:l=i.isRoot()?"ROOT":l,lineageHeight:o,heavyHeight:c};return u&&(d.hash=u.provenance.reflectIntegrity().hash,remoteName=u.getOriginAlias(),remoteName&&(d.remoteName=remoteName)),d}}},274:function(e,t,n){var r=(0,n(41).standardize)({schema:{title:"Timestamp",type:"object",description:"Time of issuance in standard format, with Zulu offset",additionalProperties:!1,required:["date","ms"],properties:{date:{type:"string",format:"date-time",examples:["2011-10-05T14:48:00.000Z"]},ms:{type:"integer"}}},create:function(){var e=new Date,t=e.toISOString(),n=e.valueOf();return r.clone({date:t,ms:n})},logicize:function(e){return{isExpired:function(t){return Date.now()-e.ms>=t}}}});e.exports={timestampModel:r}},275:function(e,t,n){var r=n(54),i=n(15),a=n(12),s=(n(18)("interblock:models:network"),n(51)),o=n(41).standardize,c=n(276).channelModel,u=n(120).addressModel,l=n(174).provenanceModel,d=n(381).rxRequestModel,p=n(380).rxReplyModel,f=n(55).reject,h=o({schema:{title:"Network",description:"All communication in and out of this blockchain.",type:"object",required:["..","."],additionalProperties:!1,minProperties:2,patternProperties:{"(.*?)":c.schema}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e[".."]||c.create(u.create(),".."),n=u.create("LOOPBACK"),r=e["."]||c.create(n,".");return a(r.address.isLoopback()),h.clone(i(i({},e),{},{"..":t,".":r}))},logicize:function(e){a(!e[void 0]);var t=Object.keys(e);a(t.includes("..")),a(t.includes(".")),a(c.isModel(e["."]),"channel invalid"),a("."===e["."].systemRole,"self not loopback channel");var n=function(){return Object.keys(e)},i=function(){return n().filter((function(t){return e[t].address.isResolved()&&".@@io"!==t}))},o=function(t){return a(u.isModel(t)),a(!t.isUnknown()),n().find((function(n){return e[n].address.equals(t)}))};return{rxReply:function(){var n,i=r(t);try{for(i.s();!(n=i.n()).done;){var s=n.value,o=e[s],c=o.rxReply();if(c){if(o.address.isInvalid()){a.strictEqual(c.type,"@@REJECT");var u=new Error("Path invalid: ".concat(s)),l=f(u,c.request);c=p.clone(l)}return{alias:s,event:c,channel:o}}}}catch(d){i.e(d)}finally{i.f()}},rxRequest:function(){var n,i=r(t);try{for(i.s();!(n=i.n()).done;){var s=n.value,o=e[s],c=o.rxRequest();if(c)return a(o.address.isResolved()||o.address.isLoopback()),{alias:s,event:c,channel:o}}}catch(u){i.e(u)}finally{i.f()}},rxSelf:function(){var t=e["."];return t.rxReply()||t.rxRequest()},getAliases:n,getResolvedAliases:i,getAlias:o,getParent:function(){return e[".."]},includesInterblock:function(t){var n=t.provenance;a(l.isModel(n));var r=o(n.getAddress());if(!r)return!1;var i=!1,c=e[r];if(n.height<=c.lineageHeight&&(i=!0),n.height===c.lineageHeight){var u=n.equals(s.last(c.lineageTip).provenance);a(u)}return t.getRemote()&&i?(n.height===c.heavy.provenance.height&&a(t.equals(c.heavy)),n.height<=c.heavy.provenance.height):i},getResponse:function(t){a(d.isModel(t));var n=t.getAddress(),r=t.getIndex(),i=o(n);return a(e[i]),e[i].replies[r]},txInterblockAliases:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.create();a(h.isModel(t));var n=i(),r=n.filter((function(n){var r=e[n],i=t.getAlias(r.address);if(!i)return!0;var a=t[i];return r.isTxGreaterThan(a)}));return r},isNewChannels:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.create();a(h.isModel(t));var n=i(),r=n.some((function(n){var r=e[n].address;if(!t.getAlias(r))return!0}));return r}}}});e.exports={networkModel:h}},276:function(e,t,n){var r=n(54),i=n(15),a=n(12),s=n(18)("interblock:models:channel"),o=n(51),c=n(379),u=c.rxRequestModel,l=c.rxReplyModel,d=n(41).standardize,p=n(120).addressModel,f=n(173).actionModel,h=n(222).continuationModel,v=n(278).remoteModel,g=n(87).channelSchema,y=n(55).reject,m=d({schema:g,create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOWN_LINK";e=p.clone(e);var n=v.create({address:e}),r=i(i({},n),{},{systemRole:t,requestsLength:0,lineage:[],lineageTip:[]});return m.clone(r)},logicize:function(e){var t=e.address,n=e.systemRole,i=e.requests,c=e.replies,d=e.heavy,p=e.lineageHeight,h=e.heavyHeight,g=e.lineage,x=e.lineageTip,M=(e.requestsLength,"."===n);t.isUnknown()&&a.strictEqual(Object.keys(c).length,0);var R=M?v.create(e):d&&d.getRemote()?d.getRemote():v.create();if(a(R),M){a(t.isLoopback());var E=["@@OPEN_CHILD"],P=Object.values(i),O=Object.values(R.requests);a(P.every((function(e){var t=e.type;return!E.includes(t)}))),a(O.every((function(e){var t=e.type;return!E.includes(t)})))}if(d&&(a(d.getRemote()||0===h),a.strictEqual(d.provenance.height,h),a(p>=h)),x.length){var A=o.last(x).provenance;a.strictEqual(A.height,p),a(o.last(g).equals(A.reflectIntegrity()))}a(x.every((function(e){return!e.getRemote()}))),C(i),C(c);var q=function(){if(!t.isUnknown()){var e=I(R.replies).find((function(e){return!R.replies[e].isPromise()&&i[e]}));if(!Number.isInteger(e)&&t.isInvalid()){var n,a=S(),s=r(a);try{for(s.s();!(n=s.n()).done;){var o=n.value,c=R.replies[o];if(!c||c.isPromise()){e=o;break}}}catch(u){s.e(u)}finally{s.f()}}return e}},j=function(){var e,t=I(R.requests),n=r(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!c[i])return i}}catch(a){n.e(a)}finally{n.f()}},S=function(){return I(i)};return{rxRequest:function(e){if((!t.isUnknown()||M)&&!t.isInvalid()){Number.isInteger(e)||(e=j());var n=R.requests[e];if(n){a(f.isModel(n));var r=n.type,i=n.payload,o=u.create(r,i,t,e);return s("rxRequest ".concat(o.type)),o}}},rxReply:function(){var e=q();if(Number.isInteger(e)){var n;a(e>=0,"index must be whole number"),a(i[e],"No request for: ".concat(e)),t.isInvalid()?n=y(new Error("Channel invalid")):(a(R.replies[e],"No reply for: ".concat(e)),n=R.replies[e]);var r=i[e],s=n,o=s.type,c=s.payload;return l.create(o,c,r)}},rxReplyIndex:q,getNextReplyIndex:j,getRemoteRequestIndices:function(){return I(R.requests)},getRemoteReplyIndices:function(){return I(R.replies)},isTxGreaterThan:function(e){a(m.isModel(e));var n=!e.address.equals(t),r=k(c,e.replies),s=w(i,e.requests),o=b(c,e.replies);return n||r||s||o},getRemote:function(){return R},getOutboundPairs:function(){return I(i).map((function(e){return[i[e],R.replies[e]]}))},getRequestIndices:S}}}),b=function(e,t){return I(e).some((function(n){var r=e[n],i=t[n];return!(!i||!r)&&(a(h.isModel(r)),a(h.isModel(i)),i.isPromise()&&!r.isPromise())}))},k=function(e,t){for(var n=I(e);x(n,e);)n.pop();if(!n.length)return!1;var r=I(t);return M(n,r)},x=function(e,t){return!!e.length&&t[o.last(e)].isPromise()},w=function(e,t){var n=I(e),r=I(t),i=M(n,r);return i},I=function(e){var t=[];return Object.keys(e).forEach((function(e){var n=parseInt(e);t.push(n)})),t.sort((function(e,t){return e-t})),t},C=function(e){var t=-1,n=Object.keys(e).every((function(e){var n=parseInt(e),r=n>t;return t=n,r}));a(n)},M=function(e,t){if(!t.length&&!e.length)return!1;if(!t.length&&e.length)return!0;if(t.length&&!e.length)return!1;var n=o.last(t);return o.last(e)>n};e.exports={channelModel:m}},277:function(e,t){e.exports={txRequestSchema:{title:"txRequest",description:"Covenant created",type:"object",required:["type","payload","to"],additionalProperties:!1,properties:{type:{type:"string"},payload:{type:"object"},to:{type:"string"}}},rxRequestSchema:{title:"rxRequest",description:"System created inside ChannelModel",type:"object",required:["type","payload","sequence"],additionalProperties:!1,properties:{type:{type:"string"},payload:{type:"object"},sequence:{type:"string",pattern:""}}},txReplySchema:{title:"txReply",description:"Covenant created",type:"object",required:["type","payload","request"],additionalProperties:!1,properties:{type:{type:"string",enum:["@@REJECT","@@PROMISE","@@RESOLVE"]},payload:{type:"object"},request:{description:"Sequence created in rxRequest",type:"object",required:["sequence"],additionalProperties:!1,properties:{sequence:{type:"string",pattern:""}}}}},rxReplySchema:{title:"rxReply",description:'System created.\nCreate requires the sequence to be included.\n@@PROMISE cannot ever be dispatched to a reducer, hence its exclusion from "type"',type:"object",required:["type","payload","request"],additionalProperties:!1,properties:{type:{type:"string",enum:["@@REJECT","@@RESOLVE"]},payload:{type:"object"},request:{description:"Covenants original request, without the 'to' field",type:"object",required:["type","payload"],additionalProperties:!1,properties:{type:{type:"string"},payload:{type:"object"}}}}}}},278:function(e,t,n){var r=n(15),i=n(12),a=(n(51),n(41).standardize),s=n(87).remoteSchema,o=n(120).addressModel,c=a({schema:s,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i("object"===typeof e);var t={},n=["address","requests","replies","heavyHeight","lineageHeight"];n.forEach((function(n){e[n]&&(t[n]=e[n])}));var a={address:o.create(),requests:{},replies:{},heavyHeight:-1,lineageHeight:-1},s=r(r({},a),t);return c.clone(s)},logicize:function(e){return{}}});e.exports={remoteModel:c}},279:function(e,t,n){var r=n(15),i=n(80),a=n(12),s=(n(51),n(18)("interblock:models:interblock"),n(41).standardize),o=(n(174).provenanceModel,n(102).integrityModel,n(222).continuationModel),c=n(215).blockModel,u=n(276).channelModel,l=n(278).remoteModel,d=n(87).interblockSchema,p=n(389).proofModel,f=s({schema:d,create:function(e,t){a(c.isModel(e)),h(e,t);var n=e.provenance,r=e.validators,s={provenance:n,proof:p.create(e,t),validators:r};if(t){var o=e.network[t];a(u.isModel(o));var d=l.create(o);s.network=i({},t,d)}return f.clone(s)},logicize:function(e){var t,n=e.provenance,i=(e.proof,e.validators,e.network),s=i&&Object.keys(i)[0],u=s&&i[s];if(a(!u||l.isModel(u)),s){a.strictEqual(Object.keys(i).length,1);var d=i[s];a(!d.address.isUnknown(),"interblock transmission address must be known")}else a(!i);var p,h=function(){if(!t){var e=c.clone(u.requests[0].payload.genesis);a(e.provenance.address.isGenesis()),t=e}return t},v=function(){if(!u)return!1;var e=u.requests[0],t=1===u.requests.length;return!(!e||"@@INTRO"!==e.type||!t)||void 0};return{extractGenesis:h,getTargetAddress:function(){return u&&u.address},getOriginAlias:function(){return s},getRemote:function(){return u},isConnectionAttempt:v,isGenesisAttempt:function(){try{return h()}catch(e){}return!1},getWithoutRemote:function(){if(!p){var t={block:e.proof.block},n=r(r({},e),{},{proof:t});delete n.network,p=f.clone(n)}return p},getLineageHeight:function(){return u.lineageHeight},getHeavyHeight:function(){return u.heavyHeight},isConnectionResponse:function(){if(!u)return!1;a(u&&s);var e=-1===u.lineageHeight&&-1===u.heavyHeight,t=s.startsWith("@@PUBLIC_"),n=s.substring("@@PUBLIC_".length),r=t&&n===u.address.getChainId(),i=u.requests[0],o=i&&"@@ACCEPT"===i.type,c=!Object.keys(u.replies).length;return e&&r&&o&&c},isConnectionResolve:function(){if(!v())return!1;var e=u.replies[0];return e?(a(o.isModel(e)),e.isResolve()):void 0},isDownlinkInit:function(){if(!u)return!1;var e=u.requests[0]&&!Object.keys(u.replies).length,t=u.heavyHeight<0;return e&&t},isUplinkInit:function(){return!!u&&(u.replies[0]&&!Object.keys(u.requests).length)},getChainId:function(){return n.getAddress().getChainId()}}}}),h=function(e,t){if(t&&"string"!==typeof t)throw new Error("Invalid format for target alias: ".concat(t));if(!e.isValidated())throw new Error("Only validated blocks can be reduced to Interblocks");if("."===t)throw new Error("Cannot make interblock from loopback channel")};e.exports={interblockModel:f}},280:function(e,t,n){var r=n(9),i=n(10),a=n(18)("interblock:services:crypto"),s=n(12),o=n(25),c=o.cryptoCacher,u=o.keypairModel,l=o.integrityModel,d=n(123),p=d.ramDynamoDbFactory,f=d.dbFactory,h=n(117),v=c.cacheVerifyKeypair,g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CI";e=e||p();var n=f(e);s("string"===typeof t);var o,c=function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(l.isModel(t)),e.next=3,g();case 3:return n=e.sent,e.abrupt("return",n.sign(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return t=e.sent,e.abrupt("return",t.getValidatorEntry());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=i(r.mark((function e(){var i,s,c,l,d,p,f,g;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",o);case 2:return e.next=4,n.scanKeypair();case 4:if(!(i=e.sent)){e.next=12;break}return s=JSON.parse(i.keypairJson),e.next=9,v(s);case 9:o=u.clone(s),e.next=30;break;case 12:return e.next=14,h.generateKeyPair();case 14:return c=e.sent,l=u.create(t,c),d=l.serialize(),e.next=19,n.putKeypair({keyname:t,keypairJson:d});case 19:return e.next=21,n.scanKeypair();case 21:if(p=e.sent,f=p.keypairJson){e.next=25;break}throw new Error("cannot store keypair");case 25:return g=JSON.parse(f),e.next=28,v(g);case 28:(o=u.clone(g)).equals(l)||a("collision avoided for: ",t);case 30:return e.abrupt("return",o);case 31:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{sign:c,getValidatorEntry:d}};e.exports={cryptoFactory:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CI",n=g(e,t),s=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a("crypto: ".concat(t.type)),e.t0=t.type,e.next="SIGN"===e.t0?4:"VALIDATOR"===e.t0?5:6;break;case 4:return e.abrupt("return",n.sign(t.payload));case 5:return e.abrupt("return",n.getValidatorEntry());case 6:throw new Error("Unknown crypto action type: ".concat(t.type));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s},toFunctions:function(e){return{sign:function(t){return e.push({type:"SIGN",payload:t})},getValidatorEntry:function(){return e.push({type:"VALIDATOR"})}}},crypto:h}},281:function(e,t,n){(function(t){var r=n(121),i=n(9),a=n(10),s=n(18)("interblock:aws:ramDynamoDb"),o=n(12),c=(n(51),{dbChains:"height",dbPools:"originChainId_height_type",dbLocks:"chainId",dbSockets:"socketId",dbSubscribers:"targetChainId",dbPiercings:"hash"}),u=function(e,t){return t[c[e]]};e.exports={ramDynamoDbFactory:function(){var e={dbCrypto:{},dbChains:{},dbPools:{},dbLocks:{},dbSubscribers:{},dbSockets:{},dbPiercings:{}};return{get:function(n,r){var c=n.TableName,l=n.Key;s("get %O callback: %O",c,r),o(e[c]),r&&t(a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r,e.next=3,d.promise();case 3:e.t1=e.sent,(0,e.t0)(null,e.t1);case 5:case"end":return e.stop()}}),e)}))));var d={promise:function(){var t=a(i.mark((function t(){var n,r,a;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return o(l.chainId),n=e[c][l.chainId]||{},r=u(c,l),a=n[r],t.abrupt("return",{Item:a});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()};return d},query:function(t){s("query %O",t.TableName);var n=t.TableName,r=t.KeyConditionExpression,c=t.ExpressionAttributeValues;o.strictEqual(r,"chainId = :hkey");var u=c[":hkey"];return o(u),{promise:function(){var t=a(i.mark((function t(){var r,a;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return r=e[n][u]||{},a=Object.values(r).reverse(),t.abrupt("return",{Items:a});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},delete:function(t){var n=t.TableName,r=t.Key;return s("del %O %O",n,r),{promise:function(){var t=a(i.mark((function t(){var a,s,c;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:a=e[n][r.chainId],s=u(n,r),c=a[s],o(c,"cannot delete non existent item"),delete a[s];case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},put:function(n,o){var c=n.TableName,l=n.Item;r(n,["TableName","Item"]);s("put %O %O",c,l.chainId),o&&t(a(i.mark((function e(){var t;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.promise();case 3:t=e.sent,o(null,t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),o(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))));var d={promise:function(){var t=a(i.mark((function t(){var n,r,a;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return n=l.chainId,r=e[c][n]||{},a=u(c,l),r[a]&&s("already exists: %O",l.chainId),r[a]=l,e[c][n]=r,t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()};return d},scan:function(t){var n=t.TableName,r=t.Limit;return s("scan: %O %O",n,r),o(["dbChains","dbCrypto"].includes(n)),o.strictEqual(r,1),{promise:function(){var t=a(i.mark((function t(){var r,a,s;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return r=e[n],a=Object.values(r)[0],s=[],a&&s.push(Object.values(a)[0]),t.abrupt("return",{Items:s});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},_getTables:function(){return e}}}}}).call(this,n(148).setImmediate)},282:function(e,t,n){var r=n(2318).pure;e.exports={pure:r}},284:function(e,t,n){"use strict";var r=n(54),i=n(15),a=n(9),s=n(10),o=n(21),c=n(27),u=n(593),l=n(66),d=n(59),p=n(37),f=n(38),h=n(105),v=n(223),g=n(2407),y=n(76),m=y.reorder,b=y.scrollUp,k=y.scrollDown,x=y.isObject,w=y.swap,I=function(e){p(n,e);var t=f(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).cursorHide(),r.maxSelected=e.maxSelected||1/0,r.multiple=e.multiple||!1,r.initial=e.initial||0,r.delay=e.delay||0,r.longest=0,r.num="",r}return c(n,[{key:"initialize",value:function(){var e=s(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof this.options.initial){e.next=4;break}return e.next=3,this.options.initial.call(this);case 3:this.initial=e.sent;case 4:return e.next=6,this.reset(!0);case 6:return e.next=8,l(d(n.prototype),"initialize",this).call(this);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=s(a.mark((function e(){var t,n,r,i,s,o=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.options,n=t.choices,r=t.initial,i=t.autofocus,s=t.suggest,this.state._choices=[],this.state.choices=[],e.t0=Promise,e.next=6,this.toChoices(n);case 6:return e.t1=e.sent,e.next=9,e.t0.all.call(e.t0,e.t1);case 9:if(this.choices=e.sent,this.choices.forEach((function(e){return e.enabled=!1})),"function"===typeof s||0!==this.selectable.length){e.next=13;break}throw new Error("At least one choice must be selectable");case 13:if(x(r)&&(r=Object.keys(r)),!Array.isArray(r)){e.next=21;break}return null!=i&&(this.index=this.findIndex(i)),r.forEach((function(e){return o.enable(o.find(e))})),e.next=19,this.render();case 19:e.next=24;break;case 21:null!=i&&(r=i),"string"===typeof r&&(r=this.findIndex(r)),"number"===typeof r&&r>-1&&(this.index=Math.max(0,Math.min(r,this.choices.length)),this.enable(this.find(this.index)));case 24:if(!this.isDisabled(this.focused)){e.next=27;break}return e.next=27,this.down();case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toChoices",value:function(){var e=s(a.mark((function e(t,n){var r,i,o,c=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.loadingChoices=!0,r=[],i=0,o=function(){var e=s(a.mark((function e(t,n){var s,u;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t){e.next=4;break}return e.next=3,t.call(c);case 3:t=e.sent;case 4:if(!(t instanceof Promise)){e.next=8;break}return e.next=7,t;case 7:t=e.sent;case 8:s=0;case 9:if(!(s<t.length)){e.next=20;break}return e.next=12,c.toChoice(t[s],i++,n);case 12:if(u=t[s]=e.sent,r.push(u),!u.choices){e.next=17;break}return e.next=17,o(u.choices,u);case 17:s++,e.next=9;break;case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.abrupt("return",o(t,n).then((function(e){return c.state.loadingChoices=!1,e})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"toChoice",value:function(){var e=s(a.mark((function e(t,n,r){var s,o,c;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t){e.next=4;break}return e.next=3,t.call(this,this);case 3:t=e.sent;case 4:if(!(t instanceof Promise)){e.next=8;break}return e.next=7,t;case 7:t=e.sent;case 8:if("string"===typeof t&&(t={name:t}),!t.normalized){e.next=11;break}return e.abrupt("return",t);case 11:if(t.normalized=!0,s=t.value,o=g(t.role,this.options),"string"!==typeof(t=o(this,t)).disabled||t.hint||(t.hint=t.disabled,t.disabled=!0),!0===t.disabled&&null==t.hint&&(t.hint="(disabled)"),null==t.index){e.next=19;break}return e.abrupt("return",t);case 19:if(t.name=t.name||t.key||t.title||t.value||t.message,t.message=t.message||t.name||"",t.value=[t.value,t.name].find(this.isValue.bind(this)),t.input="",t.index=n,t.cursor=0,y.define(t,"parent",r),t.level=r?r.level+1:1,null==t.indent&&(t.indent=r?r.indent+"  ":t.indent||""),t.path=r?r.path+"."+t.name:t.name,t.enabled=!(!this.multiple||this.isDisabled(t)||!t.enabled&&!this.isSelected(t)),this.isDisabled(t)||(this.longest=Math.max(this.longest,h.unstyle(t.message).length)),c=i({},t),t.reset=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.input,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.value,r=0,i=Object.keys(c);r<i.length;r++){var a=i[r];t[a]=c[a]}t.input=e,t.value=n},null!=s||"function"!==typeof t.initial){e.next=37;break}return e.next=36,t.initial.call(this,this.state,t,n);case 36:t.input=e.sent;case 37:return e.abrupt("return",t);case 38:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onChoice",value:function(){var e=s(a.mark((function e(t,n){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.emit("choice",t,n,this),"function"!==typeof t.onChoice){e.next=4;break}return e.next=4,t.onChoice.call(this,this.state,t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addChoice",value:function(){var e=s(a.mark((function e(t,n,r){var i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toChoice(t,n,r);case 2:return i=e.sent,this.choices.push(i),this.index=this.choices.length-1,this.limit=this.choices.length,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"newItem",value:function(){var e=s(a.mark((function e(t,n,r){var s,o;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i({name:"New choice name?",editable:!0,newChoice:!0},t),e.next=3,this.addChoice(s,n,r);case 3:return(o=e.sent).updateChoice=function(){delete o.newChoice,o.name=o.message=o.input,o.input="",o.cursor=0},e.abrupt("return",this.render());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"indent",value:function(e){return null==e.indent?e.level>1?"  ".repeat(e.level-1):"":e.indent}},{key:"dispatch",value:function(e,t){if(this.multiple&&this[t.name])return this[t.name]();this.alert()}},{key:"focus",value:function(e,t){return"boolean"!==typeof t&&(t=e.enabled),t&&!e.enabled&&this.selected.length>=this.maxSelected?this.alert():(this.index=e.index,e.enabled=t&&!this.isDisabled(e),e)}},{key:"space",value:function(){return this.multiple?(this.toggle(this.focused),this.render()):this.alert()}},{key:"a",value:function(){if(this.maxSelected<this.choices.length)return this.alert();var e=this.selectable.every((function(e){return e.enabled}));return this.choices.forEach((function(t){return t.enabled=!e})),this.render()}},{key:"i",value:function(){return this.choices.length-this.selected.length>this.maxSelected?this.alert():(this.choices.forEach((function(e){return e.enabled=!e.enabled})),this.render())}},{key:"g",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focused;return this.choices.some((function(e){return!!e.parent}))?(this.toggle(e.parent&&!e.choices?e.parent:e),this.render()):this.a()}},{key:"toggle",value:function(e,t){var n=this;if(!e.enabled&&this.selected.length>=this.maxSelected)return this.alert();"boolean"!==typeof t&&(t=!e.enabled),e.enabled=t,e.choices&&e.choices.forEach((function(e){return n.toggle(e,t)}));for(var r=e.parent;r;){var i=r.choices.filter((function(e){return n.isDisabled(e)}));r.enabled=i.every((function(e){return!0===e.enabled})),r=r.parent}return C(this,this.choices),this.emit("toggle",e,this),e}},{key:"enable",value:function(e){return this.selected.length>=this.maxSelected?this.alert():(e.enabled=!this.isDisabled(e),e.choices&&e.choices.forEach(this.enable.bind(this)),e)}},{key:"disable",value:function(e){return e.enabled=!1,e.choices&&e.choices.forEach(this.disable.bind(this)),e}},{key:"number",value:function(e){var t=this;this.num+=e;var n=function(e){var n=Number(e);if(n>t.choices.length-1)return t.alert();var r=t.focused,i=t.choices.find((function(e){return n===e.index}));if(!i.enabled&&t.selected.length>=t.maxSelected)return t.alert();if(-1===t.visible.indexOf(i)){var a=m(t.choices),s=a.indexOf(i);if(r.index>s){var o=a.slice(s,s+t.limit),c=a.filter((function(e){return!o.includes(e)}));t.choices=o.concat(c)}else{var u=s-t.limit+1;t.choices=a.slice(u).concat(a.slice(0,u))}}return t.index=t.choices.indexOf(i),t.toggle(t.focused),t.render()};return clearTimeout(this.numberTimeout),new Promise((function(e){var r=t.choices.length,i=t.num,a=function(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1?arguments[1]:void 0;clearTimeout(t.numberTimeout),r&&(a=n(i)),t.num="",e(a)};return"0"===i||1===i.length&&Number(i+"0")>r?a(!0):Number(i)>r?a(!1,t.alert()):void(t.numberTimeout=setTimeout((function(){return a(!0)}),t.delay))}))}},{key:"home",value:function(){return this.choices=m(this.choices),this.index=0,this.render()}},{key:"end",value:function(){var e=this.choices.length-this.limit,t=m(this.choices);return this.choices=t.slice(e).concat(t.slice(0,e)),this.index=this.limit-1,this.render()}},{key:"first",value:function(){return this.index=0,this.render()}},{key:"last",value:function(){return this.index=this.visible.length-1,this.render()}},{key:"prev",value:function(){return this.visible.length<=1?this.alert():this.up()}},{key:"next",value:function(){return this.visible.length<=1?this.alert():this.down()}},{key:"right",value:function(){return this.cursor>=this.input.length?this.alert():(this.cursor++,this.render())}},{key:"left",value:function(){return this.cursor<=0?this.alert():(this.cursor--,this.render())}},{key:"up",value:function(){var e=this.choices.length,t=this.visible.length,n=this.index;return!1===this.options.scroll&&0===n?this.alert():e>t&&0===n?this.scrollUp():(this.index=(n-1%e+e)%e,this.isDisabled()?this.up():this.render())}},{key:"down",value:function(){var e=this.choices.length,t=this.visible.length,n=this.index;return!1===this.options.scroll&&n===t-1?this.alert():e>t&&n===t-1?this.scrollDown():(this.index=(n+1)%e,this.isDisabled()?this.down():this.render())}},{key:"scrollUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.choices=b(this.choices),this.index=e,this.isDisabled()?this.up():this.render()}},{key:"scrollDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.visible.length-1;return this.choices=k(this.choices),this.index=e,this.isDisabled()?this.down():this.render()}},{key:"shiftUp",value:function(){var e=s(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.options.sort){e.next=7;break}return this.sorting=!0,this.swap(this.index-1),e.next=5,this.up();case 5:return this.sorting=!1,e.abrupt("return");case 7:return e.abrupt("return",this.scrollUp(this.index));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shiftDown",value:function(){var e=s(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.options.sort){e.next=7;break}return this.sorting=!0,this.swap(this.index+1),e.next=5,this.down();case 5:return this.sorting=!1,e.abrupt("return");case 7:return e.abrupt("return",this.scrollDown(this.index));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pageUp",value:function(){return this.visible.length<=1?this.alert():(this.limit=Math.max(this.limit-1,0),this.index=Math.min(this.limit-1,this.index),this._limit=this.limit,this.isDisabled()?this.up():this.render())}},{key:"pageDown",value:function(){return this.visible.length>=this.choices.length?this.alert():(this.index=Math.max(0,this.index),this.limit=Math.min(this.limit+1,this.choices.length),this._limit=this.limit,this.isDisabled()?this.down():this.render())}},{key:"swap",value:function(e){w(this.choices,this.index,e)}},{key:"isDisabled",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focused,t=["disabled","collapsed","hidden","completing","readonly"];return!(!e||!t.some((function(t){return!0===e[t]})))||e&&"heading"===e.role}},{key:"isEnabled",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focused;if(Array.isArray(t))return t.every((function(t){return e.isEnabled(t)}));if(t.choices){var n=t.choices.filter((function(t){return!e.isDisabled(t)}));return t.enabled&&n.every((function(t){return e.isEnabled(t)}))}return t.enabled&&!this.isDisabled(t)}},{key:"isChoice",value:function(e,t){return e.name===t||e.index===Number(t)}},{key:"isSelected",value:function(e){var t=this;return Array.isArray(this.initial)?this.initial.some((function(n){return t.isChoice(e,n)})):this.isChoice(e,this.initial)}},{key:"map",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";return[].concat(t||[]).reduce((function(t,r){return t[r]=e.find(r,n),t}),{})}},{key:"filter",value:function(e,t){var n="function"===typeof e?e:function(t,n){return[t.name,n].includes(e)},r=(this.options.multiple?this.state._choices:this.choices).filter(n);return t?r.map((function(e){return e[t]})):r}},{key:"find",value:function(e,t){if(x(e))return t?e[t]:e;var n="function"===typeof e?e:function(t,n){return[t.name,n].includes(e)},r=this.choices.find(n);return r?t?r[t]:r:void 0}},{key:"findIndex",value:function(e){return this.choices.indexOf(this.find(e))}},{key:"submit",value:function(){var e=s(a.mark((function e(){var t,r,i,s,o,c;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.focused){e.next=3;break}return e.abrupt("return",this.alert());case 3:if(!t.newChoice){e.next=8;break}if(t.input){e.next=6;break}return e.abrupt("return",this.alert());case 6:return t.updateChoice(),e.abrupt("return",this.render());case 8:if(!this.choices.some((function(e){return e.newChoice}))){e.next=10;break}return e.abrupt("return",this.alert());case 10:if(r=this.options,i=r.reorder,s=r.sort,o=!0===this.multiple,void 0!==(c=this.selected)){e.next=15;break}return e.abrupt("return",this.alert());case 15:return Array.isArray(c)&&!1!==i&&!0!==s&&(c=y.reorder(c)),this.value=o?c.map((function(e){return e.name})):c.name,e.abrupt("return",l(d(n.prototype),"submit",this).call(this));case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"choices",get:function(){return C(this,this.state.choices||[])},set:function(e){var t=this;void 0===e&&(e=[]),this.state._choices=this.state._choices||[],this.state.choices=e;var n,i=r(e);try{var a=function(){var e=n.value;t.state._choices.some((function(t){return t.name===e.name}))||t.state._choices.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(c){i.e(c)}finally{i.f()}if(!this._initial&&this.options.initial){this._initial=!0;var s=this.initial;if("string"===typeof s||"number"===typeof s){var o=this.find(s);o&&(this.initial=o.index,this.focus(o,!0))}}}},{key:"visible",get:function(){return(this.state.visible||this.choices).slice(0,this.limit)},set:function(e){this.state.visible=e}},{key:"limit",get:function(){var e=this.state,t=this.options,n=this.choices,r=e.limit||this._limit||t.limit||n.length;return Math.min(r,this.height)},set:function(e){this.state.limit=e}},{key:"value",get:function(){return"string"!==typeof l(d(n.prototype),"value",this)&&l(d(n.prototype),"value",this)===this.initial?this.input:l(d(n.prototype),"value",this)},set:function(e){u(d(n.prototype),"value",e,this,!0)}},{key:"index",get:function(){return Math.max(0,this.state?this.state.index:0)},set:function(e){this.state.index=e}},{key:"enabled",get:function(){return this.filter(this.isEnabled.bind(this))}},{key:"focused",get:function(){var e=this.choices[this.index];return e&&this.state.submitted&&!0!==this.multiple&&(e.enabled=!0),e}},{key:"selectable",get:function(){var e=this;return this.choices.filter((function(t){return!e.isDisabled(t)}))}},{key:"selected",get:function(){return this.multiple?this.enabled:this.focused}}]),n}(v);function C(e,t){if(t instanceof Promise)return t;if("function"===typeof t){if(y.isAsyncFn(t))return t;t=t.call(e,e)}var n,i=r(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(Array.isArray(a.choices)){var s=a.choices.filter((function(t){return!e.isDisabled(t)}));a.enabled=s.every((function(e){return!0===e.enabled}))}!0===e.isDisabled(a)&&delete a.enabled}}catch(o){i.e(o)}finally{i.f()}return t}e.exports=I},2918:function(e,t,n){"use strict";n.r(t);n(0);var r=n(36),i=n.n(r),a=(n(788),n(789),n(42)),s=n.n(a),o=n(708),c=n(78),u=n(127),l=n(714),d=n(719),p=n(64),f=n(110),h=(n(603),n(192)),v=n(724),g=n(13),y=(s()("terminal:widgets:Customer"),function(e){var t=e.block,n=e.path,r=e.cwd,i=Object(f.a)(n,r),a=Object(p.a)(Object(p.a)({},e),{},{cwd:i}),s=(i&&(u.a,Object(p.a)({},a)),t.state.schema.title),o=t.state.formData,c=o.custNo,l=o.name;return Object(g.jsx)(h.a,{title:"".concat(s,": ").concat(l," (").concat(c,")"),children:Object(g.jsx)(v.a,{block:t})})}),m=(s()("terminal:widgets:About"),function(e){var t=e.block,n=(e.path,e.cwd,t.state.formData),r=n.title,i=n.description;return Object(g.jsxs)(h.a,{title:"About",children:[Object(g.jsx)("h2",{children:r}),Object(g.jsx)("p",{children:i})]})}),b=n(746),k=(s()("terminal:DUI"),function(){var e=Object(c.a)(),t=e.context;e.latest;if(!t)return Object(g.jsx)("h3",{children:"Blockchain loading...."});var n=t.wd,r={"/crm":l.a,"/crm/customers":d.a,"/crm/customers/*":y,"/crm/about":m,"/crm/settings":b.a};return Object(g.jsx)("div",{id:"DUI",style:{position:"relative",height:"70vh",display:"flex",flexDirection:"column"},children:Object(g.jsx)(u.a,{path:n,widgets:r})})}),x=n(747);var w=function(){return Object(x.a)(),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(o.a,{path:"/",style:{height:"30vh",backgroundColor:"black"}}),Object(g.jsx)(k,{})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var I=n(325);i.a.render(Object(g.jsx)(I.b,{children:Object(g.jsx)(w,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},323:function(e,t,n){var r=n(814),i=r.browserFactory,a=r.effectorFactory,s=r.awsFactory,o=n(354),c=n(578);e.exports={browserFactory:i,effectorFactory:a,awsFactory:s,engine:o,apps:c}},325:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(9),i=n.n(r),a=n(136),s=n(14),o=n(0),c=n.n(o),u=n(323),l=n(713),d=n.n(l),p=n(42),f=n.n(p),h=n(13),v=f()("terminal:Blockchain"),g=c.a.createContext(null);g.displayName="Blockchain",t.b=function(e){var t=e.identifier,n=void 0===t?"terminal":t,r=e.context,c=e.children,l=Object(o.useState)(),p=Object(s.a)(l,2),f=p[0],y=p[1],m=Object(o.useState)(),b=Object(s.a)(m,2),k=b[0],x=b[1],w=Object(o.useState)(),I=Object(s.a)(w,2),C=I[0],M=I[1],R=Object(o.useState)(!1),E=Object(s.a)(R,2),P=E[0],O=E[1];Object(o.useEffect)((function(){var e,t;return function(){var r=Object(a.a)(i.a.mark((function r(){var a,s;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return v("initializing blockchain: ".concat(n)),r.next=3,Object(u.effectorFactory)(n);case 3:a=r.sent,M(a),s=[],d()(s,{blockchain:a}),v("subscribing to blockchain"),e=a.subscribe((function(){var e=a.getState();y(e),e.state.context&&(v("setting context",e.state.context),x(e.state.context))})),t=a.subscribePending((function(e){v("subscribePending",e),O(e)}));case 10:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){e&&e(),t&&t(),v("Blockchain ".concat(n," has been shut down"))}}),[n]);var A=r||g,q={blockchain:C,latest:f,context:k,isPending:P};return Object(h.jsx)(A.Provider,{value:q,children:c})}},354:function(e,t,n){var r=n(815).metrologyFactory,i=n(496).standardEngineFactory,a=n(123),s=a.consistencyFactory,o=a.toFunctions,c=n(280),u=c.cryptoFactory,l=c.crypto,d=n(588).blockPrint,p=n(2363).setLogger;e.exports={metrologyFactory:r,standardEngineFactory:i,consistencyFactory:s,cryptoFactory:u,crypto:l,blockPrint:d,setLogger:p,consistencyQueueToFunctions:o}},355:function(e,t,n){var r=(0,n(41).standardize)({schema:{type:"object",title:"Acl",description:"Access control list, power rating, alias table, and chargeout rates\nGroups are similar to roles.\nGroups contain only Actors\nActors are similar to users, but represent chains\nThis is the alias table\nActors contain only a single ChainId\nThis might be extended to cover token balance from other chains.\nCould use proofs to show your current balance when an action was requested.\n\nAlias table is contained within the join slices directly.",required:["groups","everybody","balance","shares","costs"],additionalProperties:!1,properties:{groups:{},everybody:{},balance:{},shares:{},costs:{}}},create:function(){return r.clone({groups:{children:{alice:50,chain123:60},founders:{chain123:1}},everybody:{},balance:{},shares:{children:0,founders:100},costs:{"*":{children:50}}})},logicize:function(e){return{isAllowed:function(e,t,n){}}}});e.exports={aclModel:r}},373:function(e,t,n){var r=n(41).standardize,i=n(102).integrityModel,a=r({schema:{title:"Binary",type:"object",description:"Manages the binary attached to each chain.",additionalProperties:!1,required:["integrity","size"],properties:{integrity:i.schema,size:{type:"number",min:0}}},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e=i.clone(e),a.clone({integrity:e,size:t})},logicize:function(e){return{}}});e.exports={binaryModel:a}},374:function(e,t,n){var r=n(117),i=n(41).standardize,a=(n(216).publicKeyModel,n(102).integrityModel,i({schema:n(87).signatureSchema,create:function(){throw new Error("Only the keypairModel can create signatureModel types")},logicize:function(e){var t=e.integrity,n=e.seal,i=e.publicKey,a=t.hash,s=i.key;if(!r.verifyHashSync(a,n,s)){var o=new Error("Could not verify hash synchronously: ".concat(a));throw o.toVerify={hash:a,seal:n,key:s},o}return{}}}));e.exports={signatureModel:a}},375:function(e,t,n){var r=n(41).standardize,i=n(102).integrityModel,a=r({schema:{title:"CovenantId",description:"Covenants are how behaviour is introduced to the system.\nA Covenant represents the loaded piece of language specific code.\nA covenant is a binary package on disk, but in ram it is executable code.\n\nIn all languages, a reducer must be supplied.\nThis pure function takes a json state, and a json action, and returns a json state\n\nOptionally, a list of async functions that are invoked by the side effect system \nmay be supplied",type:"object",additionalProperties:!1,required:["name","version","integrity","language"],properties:{name:{type:"string"},version:{type:"string"},integrity:i.schema,language:{enum:["javascript","javascript/xstate","python","go","rust","haskell","c","c++"]}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unity",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0.0.0",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"javascript",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.create();if(!i.isModel(r))throw new Error("Invalid integrity for name: ".concat(e));return a.clone({name:e,version:t,integrity:r,language:n})},logicize:function(e){return{isSystemCovenant:function(){return s(e.name)}}}}),s=function(e){return"string"===typeof e&&!!n(217)[e]};e.exports={covenantIdModel:a}},378:function(e,t,n){var r=n(2298);e.exports=r},379:function(e,t,n){var r=n(380).rxReplyModel,i=n(381).rxRequestModel,a=n(382).txReplyModel,s=n(383).txRequestModel,o=n(2302).reductionModel;e.exports={rxReplyModel:r,rxRequestModel:i,txReplyModel:a,txRequestModel:s,reductionModel:o}},380:function(e,t,n){var r=n(12),i=n(41).standardize,a=n(173).actionModel,s=i({schema:n(277).rxReplySchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;r(a.isModel(n),"Request not model: ".concat(n));var i={type:e,payload:t,request:n};return s.clone(i)},logicize:function(e){var t=e.request,n=t.type,r=t.payload,i=a.create({type:n,payload:r});return{getRequest:function(){return i},isReply:function(){return!0}}}});e.exports={rxReplyModel:s}},381:function(e,t,n){var r=n(12),i=n(41).standardize,a=n(575),s=n(173).actionModel,o=n(120).addressModel,c=i({schema:n(277).rxRequestSchema,create:function(e,t,n,i){r(Number.isInteger(i)),r(o.isModel(n)),r(!n.isUnknown());var a={type:e,payload:t,sequence:"".concat(n.getChainId(),"_").concat(i)};return c.clone(a)},logicize:function(e){var t=e.type,n=e.payload,i=e.sequence,o=a(i),c=o.address,u=o.index;r(!c.isUnknown()),r(Number.isInteger(u)),r(u>=0);var l=s.create({type:t,payload:n});return{getAddress:function(){return c},getIndex:function(){return u},getRequest:function(){return l},isReply:function(){return!1}}}});e.exports={rxRequestModel:c}},382:function(e,t,n){var r=n(12),i=n(41).standardize,a=n(222).continuationModel,s=n(277).txReplySchema,o=n(575),c=i({schema:s,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;r.strictEqual(typeof t,"object");var i={type:e,payload:t,request:{sequence:n}};return c.clone(i)},logicize:function(e){var t=e.type,n=e.payload,r=e.request.sequence,i=o(r),s=i.address,c=i.index,u=a.create(t,n);return{getAddress:function(){return s},getIndex:function(){return c},getReply:function(){return u}}}});e.exports={txReplyModel:c}},383:function(e,t,n){var r=n(12),i=n(41).standardize,a=n(173).actionModel,s=i({schema:n(277).txRequestSchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DEFAULT_TX_REQUEST",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";r.strictEqual(typeof t,"object");var i={type:e,payload:t,to:n};return s.clone(i)},logicize:function(e){var t=e.type,n=e.payload,r=(e.to,a.create({type:t,payload:n}));return{getRequest:function(){return r}}}});e.exports={txRequestModel:s}},384:function(e,t,n){var r=(0,n(41).standardize)({schema:{title:"State",description:"The result of running a covenant is stored here.\nIt checks the state minus the actions is serializable\nIncludes the array of requests and replies returned from \nreducing the covenant.  These actions are intended to be transmitted\nvia the network.  This model enforces the format and logic of the\nreturns from the reducer\n\nThis is how covenant info is ingested back into the trusted system.\nIt is crucial that the format of this data is correct\n\nEntry point from covenant to system.\n\nMaximally inflates actions with defaults.  Logical checking is done inside\nthe networkProducer as needs context of the initiating action to fill in\nremaining defaults\n\nThe actions in from the covenant are refined over three states:\n1. create( state ) inflates actions to pass schema validation\n2. logicize( state ) checks static logic\n3. networkProducer.tx( state ) checks context logic\n\nThe returned model is forbidden to have an actions key on it.\nThe validation is run during clone, then logicize strips the actions out.\n\nCreate is only called immediately after a reducer call returns some state.\nTherefore, we always know what the default action is, so we require it of create.\n",type:"object",required:[]},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.clone(e)},logicize:function(e){return{}}});e.exports={stateModel:r}},385:function(e,t,n){var r=n(15),i=(0,n(41).standardize)({schema:{title:"Config",description:"Configuration options for the chain",type:"object",required:["isPierced","sideEffects","isPublicChannelOpen"],additionalProperties:!1,properties:{isPierced:{type:"boolean",description:"If the chain should be reduced, even with no known actions"},sideEffects:{type:"object",description:"When reducing, will this chain be allowed network access",required:["networkPatterns","asyncTimeoutMs"],properties:{networkPatterns:{type:"array",description:"Empty string means no network access",items:{type:"string",format:"regex"}},asyncTimeoutMs:{type:"number",description:"0 means no timeout allowed",minimum:0}}},isPublicChannelOpen:{type:"boolean",description:"Will the validators open up new channels on request from unknown chains"}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={networkPatterns:[""],asyncTimeoutMs:0};e=r(r({},e),{},{sideEffects:r(r({},t),e.sideEffects)});var n={isPierced:!1,sideEffects:t,isPublicChannelOpen:!1};return i.clone(r(r({},n),e))},logicize:function(e){return{}}});e.exports={configModel:i}},386:function(e,t,n){var r=n(41).standardize,i=n(87).validatorsSchema,a=(n(216).publicKeyModel,n(175)),s=a.keypairModel,o=a.ciKeypair,c=r({schema:i,create:function(){var e=s.create("CI",o).getValidatorEntry();return c.clone(e)},logicize:function(e){return{}}});e.exports={validatorsModel:c}},387:function(e,t,n){var r=n(12),i=n(41).standardize,a=n(379),s=a.rxRequestModel,o=a.rxReplyModel,c=n(388).simpleArrayModel,u=n(275).networkModel,l=n(120).addressModel,d=i({schema:{title:"Pending",description:"Indicates chain is waiting for a promise to resolve\n    Stores the address and index of the request.\n    Note that only requests can be origin actions for promises\n    First request is the origin request\n    The pendingRequest is saved in its entirety so structural changes\n    can occur to networking and channels, and the request will still\n    be able to proceed.",type:"object",required:["replies","requests"],additionalProperties:!1,properties:{pendingRequest:s.schema,replies:{type:"array",description:"Full replies, allowing the originating request to be lowered,\n        and the remote side to lower the reply, without losing it from the accumulator",uniqueItems:!0,items:o.schema},requests:{type:"object",additionalProperties:!1,patternProperties:{"(.*?)":c.schema}}}},create:function(){return d.clone({replies:[],requests:{}})},logicize:function(e){var t=e.pendingRequest,n=e.replies,i=e.requests;t||r(!n.length);return{getIsPending:function(){return!!t},isBufferValid:function(e){return!0},getAccumulator:function(){return n},rxBufferedRequest:function(e){r(u.isModel(e));var t=Object.keys(i);if(t.length){var n=t[0],a=l.create(n),o=e.getAlias(a);r(o);var c=e[o];r(c);var d=i[n][0];r(d>=0);var p=c.rxRequest(d);return r(s.isModel(p)),{alias:o,event:p,channel:c}}},getIsBuffered:function(e){r(s.isModel(e));var t=e.getAddress().getChainId(),n=e.getIndex();return!!i[t]&&i[t].includes(n)}}}});e.exports={pendingModel:d}},388:function(e,t,n){var r=n(12),i=(0,n(41).standardize)({schema:{title:"SimpleArray",description:"ascending indexes of requests to process",type:"array",uniqueItems:!0,items:{type:"number",minimum:0,multipleOf:1}},create:function(){return i.clone([])},logicize:function(e){var t=e.every((function(t,n){return!n||t>e[n-1]}));return r(t,"Values not monotonic: ".concat(e)),{}}});e.exports={simpleArrayModel:i}},389:function(e,t,n){var r=n(12),i=n(41).standardize,a=n(87).proofSchema,s=n(215).blockModel,o=i({schema:a,create:function(e,t){r(s.isModel(e));var n={block:e.getProof()};return t&&(r(e.network[t],"missing ".concat(t)),n.network=e.network.getProof(),n.channel=e.network[t].getProof()),o.clone(n)},logicize:function(e){return{}}});e.exports={proofModel:o}},390:function(e,t,n){var r=n(9),i=n(10),a=n(15),s=n(12),o=n(55)["@@GLOBAL_HOOK"],c=n(25),u=c.blockModel,l=c.rxReplyModel,d=c.rxRequestModel,p=n(217),f=n(578),h=n(18)("interblock:isolate");e.exports={isolateFactory:function(e){var t=function(e){var t={},n=a(a(a({},p),f),e);return{loadCovenant:function(){var e=i(r.mark((function e(i){var a,o,c,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(u.isModel(i)),a=i.covenantId,o=i.provenance.reflectIntegrity().hash,c=a.name,s(n[c],"No covenant loaded: ".concat(c)),h("loadCovenant %o from %o",c,Object.keys(n)),h("containerId: %o",o.substring(0,9)),l=n[c],t[o]={covenant:l,block:i,effects:{}},e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tick:function(){var e=i(r.mark((function e(n){var i,a,c,u,p,f,v,g,y,m,b,k,x,w,I;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.containerId,a=n.state,c=n.action,u=n.accumulator,p=void 0===u?[]:u,f=n.timeout,h("tick: %o action: %o",i.substring(0,9),c.type),v=t[i],s(v,"No tick container for: ".concat(i)),s(!a||"object"===typeof a),s(Array.isArray(p)),f=f||3e4,s(Number.isInteger(f)&&f>=0),l.isModel(c)?s(!p.length):s(d.isModel(c)),g=function(){return v.covenant.reducer(a,c)},y=c.getHash(),e.next=13,o(g,p,y);case 13:return m=e.sent,h("syncResult",m),b=m.reduction,k=m.isPending,x=m.requests,w=m.replies,s(b&&!k||!b&&k),s.strictEqual(typeof k,"boolean"),s(Array.isArray(x)),s(Array.isArray(w)),k&&s(p.length||x.length),I=x.map((function(e){if(".@@io"===e.to){s.strictEqual(typeof e.exec,"function");var t=e.payload[".@@ioRequestId"];return s.strictEqual(typeof t,"string"),s(t.length>y.length+1),s(!v.effects[t]),v.effects[t]=e,{type:e.type,payload:e.payload,to:e.to}}return e})),e.abrupt("return",{reduction:b,isPending:k,requests:I,replies:w});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unloadCovenant:function(){var e=i(r.mark((function e(n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h("attempting to unload: %o",n),e.next=3,Promise.resolve();case 3:s(t[n],"No container for: ".concat(n)),delete t[n];case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setEffectPermissions:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.containerId,t.permissions;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),executeEffect:function(){var e=i(r.mark((function e(n){var i,a,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.containerId,a=n.effectId,n.timeout,h("executeEffect effectId: %o",a),o=t[i],s(o,"No effects container for: ".concat(i)),s(o.effects[a],"No effect for: ".concat(a)),c=o.effects[a],h("action: ",c),s.strictEqual(typeof c.exec,"function"),e.next=10,c.exec();case 10:return u=e.sent,e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}(e);return function(e){switch(e.type){case"LOAD_COVENANT":return t.loadCovenant(e.payload);case"TICK":return t.tick(e.payload);case"UNLOAD_COVENANT":return t.unloadCovenant(e.payload);case"EXECUTE":return t.executeEffect(e.payload);default:throw new Error("Unknown isolator action type")}}},toFunctions:function(e){return{loadCovenant:function(t){return e.push({type:"LOAD_COVENANT",payload:t})},tick:function(t){return e.push({type:"TICK",payload:t})},unloadCovenant:function(t){return e.push({type:"UNLOAD_COVENANT",payload:t})},executeEffect:function(t){return e.push({type:"EXECUTE",payload:t})}}}}},392:function(e,t,n){var r=n(9),i=n(10),a=n(18)("interblock:aws:ramS3"),s=n(12);n(51);e.exports={ramS3Factory:function(){var e={wbblockbucket:{},wbinterbucket:{}};return{putObject:function(t){var n=t.Bucket,o=t.Key,c=t.Body;return a("putObject %O %O",n,o),s("string"===typeof n),s("string"===typeof o),s("object"===typeof c),{promise:function(){var t=i(r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return s(e[n]),e[n][o]&&a("item already exists: %O %O",n,o),e[n][o]=c,t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},getObject:function(t){var n=t.Bucket,o=t.Key;return a("getObject %O %O",n,o),s("string"===typeof n),s("string"===typeof o),{promise:function(){var t=i(r.mark((function t(){var i;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return s(e[n]),e[n][o]||(a(n),a(o)),s(e[n][o]),i=e[n][o],t.abrupt("return",{Body:i});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},deleteObject:function(t){var n=t.Bucket,o=t.Key;return a("deleteObject %O %O",n,o),{promise:function(){var t=i(r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return s(e[n]),s(e[n][o]),delete e[n][o],t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},_getBuckets:function(){return e},_isRam:!0}}}},393:function(e,t,n){var r=n(15),i=n(9),a=n(10),s=n(12),o=n(25),c=o.channelModel,u=o.addressModel,l=o.rxReplyModel,d=o.rxRequestModel,p=o.dmzModel,f=o.reductionModel,h=(o.txRequestModel,o.pendingModel),v=n(88).networkProducer,g=n(70).assign;e.exports={common:function(e){var t=function(){var t=a(i.mark((function t(n){var r,a,o,c,u,p,f,h;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.dmz,a=n.covenantAction,o=n.isolatedTick,e("reduceCovenant: %o",a.type),c=l.isModel(a),u=d.isModel(a),s(c||u),p=r.state,f=r.pending.getAccumulator(),t.next=9,o(p,a,f);case 9:return h=t.sent,s(h,"Covenant returned: ".concat(h)),e("reduceCovenant result pending: ",h.isPending),t.abrupt("return",{reduceResolve:h});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n=g({reduceResolve:function(t,n){var r=t.dmz,i=t.anvil;s(p.isModel(r));var a=n.data.reduceResolve;s(a);a.reduction;var o=a.isPending;a.requests,a.replies;return e("assignResolve pending: %o",o),f.create(a,i,r)}}),o=g({dmz:function(t){var n=t.dmz,i=t.address;s(p.isModel(n));var a=n.network["."];s(c.isModel(a)),s(u.isModel(i));var o=n.network.getAlias(i);e("respondReply from: %o",o);var l=v.respondReply(n.network,i,a);return p.clone(r(r({},n),{},{network:l}))}}),y=g({reduceRejection:function(e,t){var n=e.anvil;return l.isModel(n),"AssertionError"===t.data.name&&void 0===t.data.actual&&(t.data.actual=null),t.data}});return{respondRejection:g({dmz:function(e){var t=e.dmz,n=e.anvil,i=e.reduceRejection;s(p.isModel(t));var a=v.respondRejection(t.network,n,i);return p.clone(r(r({},t),{},{network:a}))}}),assignRejection:y,isReply:function(t){var n=t.anvil,r=l.isModel(n);return r||s(d.isModel(n)),e("isReply: %o",r),r},transmit:g({dmz:function(t){var n=t.dmz,i=t.reduceResolve;s(p.isModel(n)),s(f.isModel(i));var a=i.requests,o=i.replies;e("transmit req: %o rep %o",a,o);var c=v.tx(n.network,a,o);return p.clone(r(r({},n),{},{network:c}))},isExternalPromise:function(t){var n=t.isExternalPromise,r=t.externalAction,i=t.reduceResolve;if(n)return n;s(f.isModel(i));var a=i.replies;return l.isModel(r)?(e("transmit isExternalPromise",!1),!1):(s(d.isModel(r)),n=a.some((function(e){return e.getReply().isPromise()&&e.request.sequence===r.sequence})),e("transmit isExternalPromise",n),n)},isOriginPromise:function(t){var n=t.isOriginPromise,r=t.initialPending,i=t.reduceResolve;if(n||!r.getIsPending())return e("transmit isOriginPromise",n),n;s(h.isModel(r)),s(f.isModel(i));var a=i.replies,o=r.pendingRequest;return n=a.some((function(e){return e.getReply().isPromise()&&e.request.sequence===o.sequence})),e("transmit isOriginPromise",n),n}}),respondReply:o,assignResolve:n,reduceCovenant:t,isLoopbackResponseDone:function(t){var n=t.dmz,r=t.anvil;s(p.isModel(n)),s(d.isModel(r)),s(r.getAddress().isLoopback());var i=!!n.network.getResponse(r);return e("isLoopbackResponseDone: %o anvil: %o",i,r.type),i},respondLoopbackRequest:g({dmz:function(t){var n=t.initialPending,i=t.externalAction,a=t.dmz,o=t.address,c=t.anvil;e("respondRequest"),s(h.isModel(n)),s(p.isModel(a)),s(d.isModel(c)),s(c.getAddress().equals(o));var u=n.getIsBuffered(c);s(!c.equals(i)||u,"externalAction can only be responded to by auto resolvers");var l=v.respondRequest(a.network,c);return p.clone(r(r({},a),{},{network:l}))}}),mergeState:g({dmz:function(t){var n=t.dmz,i=t.reduceResolve;return s(p.isModel(n)),s(f.isModel(i)),e("mergeState"),p.clone(r(r({},n),{},{state:i.reduction}))}}),isAnvilNotLoopback:function(t){var n=t.anvil;s(d.isModel(n));var r=!n.getAddress().isLoopback();return e("isAnvilNotLoopback",r),r}}}}},394:function(e,t,n){"use strict";var r=n(9),i=n(10),a=n(15),s=n(21),o=n(27),c=n(66),u=n(59),l=n(37),d=n(38),p=n(105),f=n(150),h=n(595),v=function(e){l(n,e);var t=d(n);function n(e){var r;return s(this,n),(r=t.call(this,a(a({},e),{},{multiple:!0}))).type="form",r.initial=r.options.initial,r.align=[r.options.align,"right"].find((function(e){return null!=e})),r.emptyError="",r.values={},r}return o(n,[{key:"reset",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(u(n.prototype),"reset",this).call(this);case 2:return!0===t&&(this._index=this.index),this.index=this._index,this.values={},this.choices.forEach((function(e){return e.reset&&e.reset()})),e.abrupt("return",this.render());case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"dispatch",value:function(e){return!!e&&this.append(e)}},{key:"append",value:function(e){var t=this.focused;if(!t)return this.alert();var n=t.cursor,r=t.input;return t.value=t.input=r.slice(0,n)+e+r.slice(n),t.cursor++,this.render()}},{key:"delete",value:function(){var e=this.focused;if(!e||e.cursor<=0)return this.alert();var t=e.cursor,n=e.input;return e.value=e.input=n.slice(0,t-1)+n.slice(t),e.cursor--,this.render()}},{key:"deleteForward",value:function(){var e=this.focused;if(!e)return this.alert();var t=e.cursor,n=e.input;if(void 0===n[t])return this.alert();var r="".concat(n).slice(0,t)+"".concat(n).slice(t+1);return e.value=e.input=r,this.render()}},{key:"right",value:function(){var e=this.focused;return e?e.cursor>=e.input.length?this.alert():(e.cursor++,this.render()):this.alert()}},{key:"left",value:function(){var e=this.focused;return e?e.cursor<=0?this.alert():(e.cursor--,this.render()):this.alert()}},{key:"space",value:function(e,t){return this.dispatch(e,t)}},{key:"number",value:function(e,t){return this.dispatch(e,t)}},{key:"next",value:function(){var e=this.focused;if(!e)return this.alert();var t=e.initial,r=e.input;return t&&t.startsWith(r)&&r!==t?(e.value=e.input=t,e.cursor=e.value.length,this.render()):c(u(n.prototype),"next",this).call(this)}},{key:"prev",value:function(){var e=this.focused;return e?0===e.cursor?c(u(n.prototype),"prev",this).call(this):(e.value=e.input="",e.cursor=0,this.render()):this.alert()}},{key:"separator",value:function(){return""}},{key:"format",value:function(e){return this.state.submitted?"":c(u(n.prototype),"format",this).call(this,e)}},{key:"pointer",value:function(){return""}},{key:"indicator",value:function(e){return e.input?"\u29bf":"\u2299"}},{key:"choiceSeparator",value:function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolve(t.separator,this.state,t,n);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=":";case 5:return i=e.t0,e.abrupt("return",i?" "+this.styles.disabled(i):"");case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoice",value:function(){var e=i(r.mark((function e(t,n){var i,a,s,o,c,u,l,d,f,v,g,y,m,b,k,x,w,I,C,M,R,E,P,O,A;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return i=this.state,a=this.styles,s=t.cursor,o=t.initial,c=void 0===o?"":o,u=t.name,l=t.hint,d=t.input,f=void 0===d?"":d,v=a.muted,g=a.submitted,y=a.primary,m=a.danger,b=l,k=this.index===n,x=t.validate||function(){return!0},e.next=10,this.choiceSeparator(t,n);case 10:return w=e.sent,I=t.message,"right"===this.align&&(I=I.padStart(this.longest+1," ")),"left"===this.align&&(I=I.padEnd(this.longest+1," ")),C=this.values[u]=f||c,M=f?"success":"dark",e.next=18,x.call(t,C,this.state);case 18:if(e.t0=e.sent,!0===e.t0){e.next=21;break}M="danger";case 21:return R=a[M],e.t1=R,e.next=25,this.indicator(t,n);case 25:if(e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.t4=t.pad||"",E=e.t3+e.t4,P=this.indent(t),O=function(){return[P,E,I+w,f,b].filter(Boolean).join(" ")},!i.submitted){e.next=36;break}return I=p.unstyle(I),f=g(f),b="",e.abrupt("return",O());case 36:if(!t.format){e.next=42;break}return e.next=39,t.format.call(this,f,t,n);case 39:f=e.sent,e.next=45;break;case 42:A=this.styles.muted,f=h(this,{input:f,initial:c,pos:s,showCursor:k,color:A});case 45:if(this.isValue(f)||(f=this.styles.muted(this.symbols.ellipsis)),!t.result){e.next=50;break}return e.next=49,t.result.call(this,C,t,n);case 49:this.values[u]=e.sent;case 50:return k&&(I=y(I)),t.error?f+=(f?" ":"")+m(t.error.trim()):t.hint&&(f+=(f?" ":"")+v(t.hint.trim())),e.abrupt("return",O());case 53:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"submit",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.value=this.values,e.abrupt("return",c(u(n.prototype),"base",this).submit.call(this));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(f);e.exports=v},395:function(e,t,n){"use strict";var r=n(9),i=n(10),a=n(21),s=n(27),o=n(593),c=n(66),u=n(59),l=n(37),d=n(38),p=n(223),f=n(76),h=f.isPrimitive,v=f.hasColor,g=function(e){l(n,e);var t=d(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).cursorHide(),r}return s(n,[{key:"initialize",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolve(this.initial,this.state);case 2:return t=e.sent,e.next=5,this.cast(t);case 5:return this.input=e.sent,e.next=8,c(u(n.prototype),"initialize",this).call(this);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatch",value:function(e){return this.isValue(e)?(this.input=e,this.submit()):this.alert()}},{key:"format",value:function(e){var t=this.styles;return this.state.submitted?t.success(e):t.primary(e)}},{key:"cast",value:function(e){return this.isTrue(e)}},{key:"isTrue",value:function(e){return/^[ty1]/i.test(e)}},{key:"isFalse",value:function(e){return/^[fn0]/i.test(e)}},{key:"isValue",value:function(e){return h(e)&&(this.isTrue(e)||this.isFalse(e))}},{key:"hint",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"!==this.state.status){e.next=7;break}return e.next=3,this.element("hint");case 3:if(t=e.sent,v(t)){e.next=6;break}return e.abrupt("return",this.styles.muted(t));case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s,o,c,u,l,d,p,f,h;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.input,i=t.size,e.next=3,this.prefix();case 3:return a=e.sent,e.next=6,this.separator();case 6:return s=e.sent,e.next=9,this.message();case 9:return o=e.sent,c=this.styles.muted(this.default),u=[a,o,c,s].filter(Boolean).join(" "),this.state.prompt=u,e.next=15,this.header();case 15:return l=e.sent,d=this.value=this.cast(n),e.next=19,this.format(d);case 19:return p=e.sent,e.next=22,this.error();case 22:if(e.t0=e.sent,e.t0){e.next=27;break}return e.next=26,this.hint();case 26:e.t0=e.sent;case 27:return f=e.t0,e.next=30,this.footer();case 30:h=e.sent,f&&!u.includes(f)&&(p+=" "+f),u+=" "+p,this.clear(i),this.write([l,u,h].filter(Boolean).join("\n")),this.restore();case 36:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"value",get:function(){return this.cast(c(u(n.prototype),"value",this))},set:function(e){o(u(n.prototype),"value",e,this,!0)}}]),n}(p);e.exports=g},396:function(e,t,n){var r=n(9),i=n(34),a=n(10),s=n(47)("dos:eval"),o=n(397);e.exports.evaluate=function(){var e=a(r.mark((function e(t,n){var a,c,u,l,d,p,f,h,v=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=v.length>2&&void 0!==v[2]?v[2]:[],s(n,a),n=n||""){e.next=5;break}return e.abrupt("return");case 5:if(o[n]){e.next=20;break}if(!(n.startsWith("./")||n.startsWith("/"))){e.next=19;break}return c=n.substring(2),s("non builtin command: %s assuming covenant function",c),u=t.blockchain,l=u.getContext(),d=l.wd,e.next=14,u.getActionCreators(d);case 14:if(p=e.sent,!(f=p[c])){e.next=19;break}return h=f({isTestData:!0}),e.abrupt("return",u.dispatch(h,d));case 19:throw new Error("".concat(n,": command not found"));case 20:return e.abrupt("return",o[n].apply(o,[t].concat(i(a))));case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},397:function(e,t,n){t.cd=n(598),t.config=n(2428),t.exit=n(2429),t.help=n(2430),t.ls=n(2442),t.pwd=n(2444),t.version=n(2445),t.pkg=n(2447),t.clear=n(2448),t.error=n(2450),t.open=n(2451),t.login=n(2454),t.logout=n(2455),t.su=n(2456),t.add=n(2458),t.ln=n(2459),t.rm=n(2460),t.whoami=n(2461),t.search=n(2462),t.time=n(2463),t.ping=n(2466),t.reset=n(2467),t.dns=n(2468),t.cat=n(2469),t.net=n(2470),t.debug=n(2471),t.edit=n(2472),t.about=n(2473),t.blocks=n(2474),t.scrub=n(2475),t.namegen=n(2476),t.validators=n(2478)},398:function(e,t,n){var r=n(9),i=n(10),a=n(590),s=n(47)("dos:spinner");t.withSpin=function(e){return function(){var t=i(r.mark((function t(n){var i=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s("spinner"),n.spinner=a({spinner:"moon"}).start(),t.prev=2,t.next=5,e.apply(this,i);case 5:return t.abrupt("return",t.sent);case 8:throw t.prev=8,t.t0=t.catch(2),s(t.t0),t.t0;case 12:return t.prev=12,n.spinner.stop(),n.spinner=null,t.finish(12);case 16:case"end":return t.stop()}}),t,this,[[2,8,12,16]])})));return function(e){return t.apply(this,arguments)}}()}},41:function(e,t,n){var r=n(80),i=n(15),a=n(12),s=(n(18)("interblock:models:utils"),n(822),n(51)),o=n(356),c=n(824),u=c.modelInflator,l=c.precompileSchema,d=n(260).registry,p=n(117),f=n(149),h=function(e,t,n){var r,i,s,c=function(){a.strictEqual(typeof t,"object");var n=v(e,t),r=n.hash,o=n.proof;i=r,s=o};return{equals:function(e){return!!n(e)&&f(t,e)},serialize:function(){return r||(r=o(t)),r},getHash:function(){return i||(c(),a(i)),i},getProof:function(){return s||(c(),a(s)),s}}},v=function(e,t){switch(e.title){case"Action":if("@@GENESIS"===t.type&&t.payload.genesis){var n=t.payload.genesis,r=d.get("Block");a(r.isModel(n));var s=i(i({},t),{},{payload:i({},t.payload)});return s.payload.genesis=n.getHash(),m(e,s)}return m(e,t);case"Integrity":return{hash:t.hash};case"Interblock":case"Block":return{hash:t.provenance.getHash(),proof:"no proof needed"};case"Network":var o=k(t);return{hash:o.hash,proof:{networkChannels:o.proof}};case"Channel":var c=g(t),u=["systemRole","requestsLength","heavy","lineage","lineageTip"],l=y(t,u),f=y(e.properties,u),h=m({properties:f},l).hash;return{hash:p.objectHash({remote:c.getHash(),proof:h}),proof:h};case"State":case"SimpleArray":return{hash:p.objectHash(t)};default:return m(e,t)}},g=s.memoize((function(e){var t=d.get("Remote"),n=y(e,["address","replies","requests","heavyHeight","lineageHeight"]);return t.clone(n)})),y=function(e,t){var n={};return t.forEach((function(t){"undefined"!==typeof e[t]&&(n[t]=e[t])})),n},m=function(e,t){if(e.patternProperties)return{hash:k(t).hash};var n={},r=e.properties;return Object.keys(t).map((function(e){var i=r[e],a=i.title,s=i.type,o=i.patternProperties,c=t[e];if(d.isRegistered(a))n[e]=c.getHash();else if("array"!==s)if(o){var u=k(c).hash;n[e]=u}else n[e]=c;else n[e]=b(c)})),{hash:p.objectHash(n)}},b=function(e){return p.objectHash(e.map((function(e){return e.getHash()})))},k=function(e){var t=Object.keys(e).map((function(t){return p.objectHash(r({},t,e[t].getHash()))}));return t.sort(),{hash:p.objectHash(t),proof:t}},x=function(e,t){for(var n in e)a(!t[n],"function collision: ".concat(n));var r={};for(var i in t)r[i]={enumerable:!1,configurable:!1,writable:!1,value:t[i]};return Object.defineProperties(e,r),C(e),e},w=function(e){var t=e.schema.title;["create","logicize"].forEach((function(n){if("function"!==typeof e[n])throw new Error("Model: ".concat(t," needs function: ").concat(n))}));var n=Object.keys(e).length;if(3!==n)throw new Error("Model: ".concat(t," has ").concat(n," properties, not 3"))},I=function(e){var t=s.memoize(e.create);return function(){return arguments.length?e.create.apply(e,arguments):t.apply(void 0,arguments)}},C=function e(t){for(var n in Object.freeze(t),t){if(void 0===t[n])throw new Error("Values cannot be undefined: ".concat(n));if("function"===typeof t[n])throw new Error("No functions allowed in deepFreeze: ".concat(n));"object"!==typeof t[n]||Object.isFrozen(t[n])||e(t[n])}};e.exports={standardize:function(e){w(e),l(e.schema);var t,n=I(e),r=new WeakSet,s=new WeakMap,o=function(e){return r.has(e)},c=function(n){if(!n)return t||(t=d.create()),t;if(o(n))return n;if("string"===typeof n&&(n=JSON.parse(n)),s.has(n))return s.get(n);var a=u(e.schema,n),c=e.logicize(a),l=h(e.schema,a,o),p=l.serialize,f=l.getHash,v=l.getProof,g=l.equals,y=i(i({},c),{},{serialize:p,getHash:f,getProof:v,equals:g}),m=x(a,y);return r.add(m),s.set(n,m),m},d=Object.freeze(i(i({},e),{},{create:n,merge:function(e,t){return a(o(e)),a.strictEqual(typeof t,"object"),Object.keys(t).length?c(i(i({},e),t)):e},clone:c,isModel:o}));return d}}},495:function(e,t,n){var r=n(9),i=n(15),a=n(10),s=n(12),o=n(354).metrologyFactory,c=n(51),u=n(18)("interblock:effector"),l=n(25).covenantIdModel,d=(n(574).tcpTransportFactory,n(217)),p=n(572).netFactory,f=n(573).socketFactory,h=function(){var e=a(r.mark((function e(t){var n,c,l,h,g,y,m=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.length>1&&void 0!==m[1]?m[1]:{},s(!n||"object"===typeof n),u("effectorFactory"),n=k(n),l=p(c={}),h=f(c),n=i(i({},n),{},{net:l,socket:h,hyper:d.shell}),e.next=10,o(t,n);case 10:return g=e.sent,(y=v(g,g.pierce)).startNetworking=a(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.add("net",{covenantId:l.covenantId});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),e.abrupt("return",y);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function e(t,r){var a,s=t.getAbsolutePath(),o=function(e){var t=e.type,n=e.payload,i=void 0===n?{}:n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;if(u("dispatch to: %o type: %O",a,t),"/"===s)return r({type:t,payload:i});var o=d.shell.actions.dispatch({type:t,payload:i},a);return r(o)},c=r.subscribePending,l=i(i({},t),{},{dispatch:o,subscribePending:c,_debug:n(18)}),p={},f=function(){var n=t.getState();if(n){var i=t.getCovenants(),s=b(n,i);if(s&&!s.covenantId.equals(a)){a=s.covenantId,u("set covenant to: %O",a.name);var c=x(o,s);m(l,t),Object.assign(l,c)}var d=t.getChildren();if(!g(d,p)){for(var f in y(l,p),d)u("creating child: %O",f),p[f]=e(d[f],r);Object.assign(l,p)}}};return f(),t.subscribe(f),l},g=function(e,t){var n=Object.keys(e).sort(),r=Object.keys(t).sort();return c.isEqual(n,r)},y=function(e,t){for(var n in t)delete e[n],delete t[n]},m=function(e,t){for(var n in e)"_debug"===n||"subscribePending"===n||t[n]||"function"===typeof e[n]&&delete e[n]},b=function(e,t){var n=e.covenantId,r=i(i({},d),t),a=d.unity;if("hyper"===n.name)return t.hyper;for(var o in r)r[o].covenantId.equals(n)&&(s(a===d.unity),a=r[o]);return a},k=function(e){var t={};for(var n in e){covenant=e[n];var r=covenant.covenantId,i=r.name,a=r.version,s=r.language,o=r.integrity;covenant.covenantId=l.create(i,a,s,o),t[n]=covenant}return t},x=function(e,t){var n={};if("object"!==typeof t.actions)return n;var r=function(r){n[r]=function(){var n,i=(n=t.actions)[r].apply(n,arguments);return e(i)}};for(var i in t.actions)r(i);return n};e.exports={effectorFactory:h}},496:function(e,t,n){var r=n(15),i=n(54),a=n(9),s=n(10),o=n(12),c=(n(51),n(818),n(497).sqsQueueFactory),u=n(25),l=u.interblockModel,d=u.addressModel,p=u.txModel,f=(u.socketModel,n(2306).fsmFactory),h=n(18)("interblock:engine");e.exports={standardEngineFactory:function(){h("standardEngineFactory");var e=!1,t=[],n=function(){var n=s(a.mark((function n(r){var i;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",r());case 2:if(t.push(r),!e){n.next=5;break}return n.abrupt("return");case 5:if(!t.length){n.next=14;break}return e=!0,i=t.shift(),n.next=10,i();case 10:n.sent,e=!1,n.next=5;break;case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),u=f(),v=(u.ioIsolate,u.ioCrypto,u.ioConsistency,u.ioPool),g=u.ioIncrease,y=u.ioReceive,m=u.ioTransmit,b=c("sqsTx",p),k=c("sqsRx",p),x=c("sqsTransmit",l),w=c("sqsPool",l),I=c("sqsIncrease",d),C={sqsTx:b,sqsRx:k,sqsTransmit:x,sqsPool:w,sqsIncrease:I};k.setProcessor(function(e,t,n){return function(){var r=s(a.mark((function r(i){var s,c,u,l,d;return a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return h.extend("receiver")("receiver"),o(p.isModel(i)),s=i.interblock,r.next=6,e.push(i);case 6:return c=r.sent,u=c.isPoolable,l=c.isCatchupable,o("boolean"===typeof u),o("boolean"===typeof l),d=[],u&&d.push(t.push(s)),l&&d.push(n.push(s)),r.next=16,Promise.all(d);case 16:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}(y,w,x)),x.setProcessor(function(e,t,n){return function(){var r=s(a.mark((function r(i){var s,c;return a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return h.extend("transmitter")("transmitter"),o(l.isModel(i)),r.next=5,e.push(i);case 5:return s=r.sent,o(s.every(p.isModel),"failed transmitter"),c=s.map((function(e){var r=e.interblock;return e.socket.getIsInternal()?n.push(r):t.push(e)})),r.next=10,Promise.all(c);case 10:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}(m,b,w)),w.setProcessor(function(e,t){return function(){var n=s(a.mark((function n(r){var i,s,c;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(i=h.extend("pooler"))("pooler"),o(l.isModel(r)),n.next=5,e.push(r);case 5:return s=n.sent,o(Array.isArray(s),"failed pool"),i("affectedAddresses length: %o",s.length),c=s.map((function(e){return t.push(e)})),n.next=11,Promise.all(c);case 11:return n.abrupt("return",s);case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(v,I)),I.setProcessor(function(e,t){var r=new Map,c=new Map,u=h.extend("increasor");return function(){var p=s(a.mark((function p(f){var h,v;return a.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:if(o(d.isModel(f)),h=f.getChainId(),c.has(h)){p.next=10;break}return c.set(h,!0),v=u.extend(h.substring(0,6)),p.next=7,n(s(a.mark((function n(){var s,c,u,d,p,g,y,m,b,k;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.delete(h),s=Date.now(),n.next=4,e.push(f);case 4:return c=n.sent,Date.now(),u=c.txInterblocks,d=c.isRedriveRequired,o(Array.isArray(u)),o(u.every(l.isModel)),o.strictEqual(typeof d,"boolean"),p=u.map((function(e){return t.push(e)})),n.next=13,Promise.all(p);case 13:d&&r.set(h,!0),g=0,y=0,m=i(u);try{for(m.s();!(b=m.n()).done;)b.value.getOriginAlias()?g++:y++}catch(a){m.e(a)}finally{m.f()}k="tx: ".concat(u.length," hx:").concat(g," lx:").concat(y),u.length?v("ioIncrease ".concat(k," %i ms"),Date.now()-s):v("WASTED ioIncrease total: %i ms",Date.now()-s);case 20:if(r.get(h)){n.next=0;break}case 21:case"end":return n.stop()}}),n)}))));case 7:c.delete(h),p.next=11;break;case 10:r.set(h,!0);case 11:case"end":return p.stop()}}),p)})));return function(e){return p.apply(this,arguments)}}()}(g,x));var M=r(r({},u),C);return Object.freeze(M),M}}},497:function(e,t,n){var r=n(819),i=r.ioQueueFactory,a=r.sqsQueueFactory;e.exports={ioQueueFactory:i,sqsQueueFactory:a}},509:function(e,t){},55:function(e,t,n){var r=n(15),i=n(558),a=n(2231);e.exports=r(r({},i),a)},550:function(e,t,n){(function(t,r){var i=n(941)({coerce:!1}),a=(n(944),n(268),n(946)),s=n(245).v4,o="";e.exports={injectSeed:function(e){if(0,e){for(;e.length<32;)e+="0";o=e.substring(0,32)}else o=e},objectHash:function(e){if("undefined"===typeof t){var n=i.sort(e);return a(n,{algorithm:"sha256",encoding:"hex"})}return i.hash(e)},generateNonce:function(){return o?(r.from(o),o):s()}}}).call(this,n(20),n(17).Buffer)},552:function(e,t,n){var r=n(121),i=n(9),a=n(15),s=n(10),o=(n(12),n(949)),c=new(n(498))({allErrors:!0,verbose:!0}),u=n(18)("interblock:apps:datum"),l=n(103),d=n(25).covenantIdModel,p=n(55).interchain,f=n(2238),h=n(2247);h.extend("faker",(function(){return o}));var v={type:"object",title:"Datum",required:["type","namePath","schema","uiSchema","subscribers","children"],additionalProperties:!1,properties:{type:{enum:["COLLECTION","XSTATE","ARRAY","DATA"]},isEditable:{type:"boolean"},namePath:{type:"array",items:{type:"string"}},formData:{type:"object"},schema:{type:"object"},uiSchema:{type:"object"},subscribers:{type:"array",description:"list of paths that need to be notified when changes occur",items:{type:"string"}},children:{type:"object",patternProperties:{"(.*?)":{$ref:"#"}}}}},g={type:"DATA",isEditable:!0,namePath:[],formData:{},schema:{},uiSchema:{},subscribers:[],children:{}},y=function(){var e=s(i.mark((function e(t,n){var r,s,o,c,d,f,h,v;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object.keys(t).length||(t=g),r=n.type,s=n.payload,u("action: ",r),e.t0=r,e.next="@@INIT"===e.t0?6:"SET"===e.t0?8:30;break;case 6:return u("@@INIT"),e.abrupt("return",t);case 8:if(m(s)&&(t=I(s)),o=b(t,n),t.formData=o.formData,!Object.keys(t.children).length){e.next=29;break}return e.next=14,p(l.actions.listChildren());case 14:c=e.sent,d=c.children,e.t1=i.keys(t.children);case 17:if((e.t2=e.t1()).done){e.next=29;break}if(f=e.t2.value,d[f]){e.next=27;break}return u("creating new child: ",f),h=P.set(a(a({},o.children[f]),t.children[f])),u("setChild",h),v=l.actions.spawn(f),p(v),e.next=27,p(h,f);case 27:e.next=17;break;case 29:return e.abrupt("return",t);case 30:throw new Error("Unknown action: ".concat(r));case 31:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function e(t){if(t.schema&&Object.keys(t.schema).length)return!0;var n=t.children,r=void 0===n?{}:n;return Object.values(r).some(e)},b=function(e,t){var n=t.payload;if(n.isTestData){var i=t.getHash(),a=parseInt(Number("0x"+i.substring(0,14)));u("seed: ",a),h.option({random:f(a),alwaysFakeOptionals:!0}),o.seed(a)}C(e);var s=n.isTestData,c=r(n,["isTestData"]),l=k(c);return s&&(l=w(e,l)),x(e,l),l},k=function e(t){if(!t||"undefined"===typeof t.formData)return{};var n=t.formData,r={};if("undefined"!==typeof n&&(r.formData=n),t.children&&Object.keys(t.children).length)for(var i in r.children={},t.children)r.children[i]=e(t.children[i]);return r},x=function e(t,n){if(!c.validate(t.schema,n.formData)){var r=c.errorsText(c.errors);throw new Error("".concat(t.schema.title," failed validation: ").concat(r))}for(var i in t.children)e(t.children[i],n.children[i])},w=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.formData,i=void 0===r?{}:r,s=n.children,o=void 0===s?{}:s,c=h.generate(t.schema),l=a(a({},c),i);u("fake: ",l);var d=a(a({},n),{},{formData:l});if(Object.keys(t.children).length){var p={};for(var f in t.children)p[f]=e(t.children[f],o[f]);d.children=p}return d},I=function(e){e.isTestData;var t=r(e,["isTestData"]),n=M(t);return n=R(n),C(n),E(n),n},C=function(e){if(!c.validate(v,e)){var t=c.errorsText(c.errors);throw new Error("Datum failed validation: ".concat(t))}},M=function e(t){var n=a(a({},g),t),r=n.children,i={};for(var s in r)i[s]=e(r[s]);return a(a({},n),{},{children:i})},R=function e(t){t.formData;var n=t.children,i=void 0===n?{}:n,s=r(t,["formData","children"]),o={};for(var c in i)o[c]=e(i[c]);return a(a({},s),{},{children:o})},E=function e(t){c.compile(t.schema),c.compile(t.uiSchema);Object.values(t.children).every(e)},P={set:function(e){return{type:"SET",payload:e}},subscribe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:"SUBSCRIBE",payload:t}},unsubscribe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:"UN_SUBSCRIBE",payload:t}},setDirectEdit:function(){return{type:"SET_DIRECT"}}},O=d.create("datum");e.exports={actions:P,reducer:y,convertToTemplate:I,demuxFormData:b,validateDatumTemplate:C,muxTemplateWithFormData:function e(t,n){var r=a(a({},t),{},{children:{}});for(var i in r.formData=n.formData,t.children)r.children[i]=e(t.children[i],n.children[i]);return r},covenantId:O}},556:function(e,t,n){var r=n(80),i=n(15),a=n(34),s=n(12),o=n(18)("interblock:producers:channel"),c=n(51),u=n(25),l=u.addressModel,d=u.channelModel,p=u.interblockModel,f=u.actionModel,h=u.continuationModel,v=function(e,t){return d.clone(g(e,t))},g=function(e,t){o("ingestInterblock"),s(p.isModel(t)),s(e.address.equals(t.provenance.getAddress()));var n=t.provenance,r=n.reflectIntegrity(),u=t.getRemote(),l=t.getWithoutRemote(),d=a(e.lineage),f=a(e.lineageTip),h=e.lineageHeight,v=e.heavy,g=e.heavyHeight,y=e.replies,b=function(){d.push(r),f.push(l),h=n.height,o("ingested lineage: ".concat(n.height))},k=function(){if(v=t,g=n.height,s(u||n.address.isGenesis()),u){var r=u.requests,i=Object.keys(r),a=m(e.replies,i);y=a,o("ingested heavy: ".concat(n.height))}},x=c.last(e.lineageTip);return x?x.provenance.isNext(n)&&b():n.address.isGenesis()&&(o("ingesting genesis"),b(),k()),u&&v&&n.height>v.provenance.height&&d.some((function(e){return e.equals(r)}))&&k(),i(i({},e),{},{lineage:d,lineageTip:f,lineageHeight:h,heavy:v,heavyHeight:g,replies:y})},y=function(e,t){return s(l.isModel(t)),s(!t.isGenesis()),e.address.equals(t)?e:d.clone(i(i({},e),{},{address:t}))},m=function(e,t){var n={};return t.forEach((function(t){"undefined"!==typeof e[t]&&(n[t]=e[t])})),n};e.exports={ingestInterblocks:function(e,t){return s(d.isModel(e)),s(Array.isArray(t)),s(t.every(p.isModel)),(t=a(t)).sort((function(e,t){return e.provenance.height-t.provenance.height})),t.forEach((function(t){e=v(e,t)})),d.clone(e)},ingestInterblock:v,ingestPierceInterblock:function(e,t){s(p.isModel(t));var n=t.provenance;s(e.address.equals(n.getAddress()));var r=t.getRemote();s(r),o("ingestPierceInterblock");var a=t,c=n.height,u=n.height,l=r.requests,f=Object.keys(l),h=m(e.replies,f);return d.clone(i(i({},e),{},{heavy:a,heavyHeight:c,lineageHeight:u,replies:h}))},setAddress:y,txRequest:function(e,t){if(o("txRequest"),s(f.isModel(t),"must supply request object"),Object.values(e.requests).some((function(e){return e.equals(t)}))){var n="Duplicate request found: ".concat(t.type,".  All requests must be distinguishable from each other");throw new Error(n)}var a=e.requestsLength,c=e.requests;return c=i(i({},c),{},r({},a,t)),a++,d.clone(i(i({},e),{},{requests:c,requestsLength:a}))},txReply:function(e,t,n){s(h.isModel(t),"must supply reply object");var a=e.getNextReplyIndex();n=Number.isInteger(n)?n:a;var o=c.last(e.getRemoteRequestIndices());s(n>=0&&n<=o,"replyIndex out of bounds: ".concat(n)),s(e.getRemote().requests[n]);var u=e.replies,l=u[n],p=a===n;if(l&&!l.isPromise())throw new Error("Can only settle previous promises: ".concat(n));if(t.isPromise()&&!p)throw new Error("Can only promise for current action: ".concat(n));if(!l&&!p)throw new Error("Can only settle directly with tip: ".concat(t));return u=i(i({},u),{},r({},n,t)),d.clone(i(i({},e),{},{replies:u}))},shiftTxRequest:function(e,t){s(d.isModel(e)),s(e.rxReply()),o("shiftTxRequest requestsLength: ".concat(e.requestsLength));var n=e.rxReplyIndex(),r=e.replies,a=e.requests;return e.address.isLoopback()&&(s(d.isModel(t)),s(t.address.isLoopback()),n=t.rxReplyIndex(),s(e.replies[n],"loopback empty at ".concat(n)),delete(r=i({},r))[n]),s(e.requests[n],"nothing to remove at ".concat(n)),delete(a=i({},a))[n],d.clone(i(i({},e),{},{replies:r,requests:a}))},invalidate:function(e){var t=l.create("INVALID");return y(e,t)}}},558:function(e,t,n){var r=n(149),i=n(559).serializeError,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;switch(e){case"@@PROMISE":if(Object.keys(t).length)throw new Error("Promise payload must be empty");if(n)throw new Error("can only promise to the current request - leave blank");break;case"@@RESOLVE":break;case"@@REJECT":t="string"===typeof t?new Error(t):t,t=i(t);break;default:throw new Error("Disallowed type: ".concat(e))}if("object"!==typeof t)throw new Error("payload must be object: ".concat(typeof t));var r={type:e,payload:t,request:n};return r},s=["@@PROMISE","@@RESOLVE","@@REJECT"],o=function(e){return!e||!e.type||!s.includes(e.type)};e.exports={request:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)throw new Error("Must supply at least one arg");if("object"===typeof e&&(n="string"===typeof t?t:e.to||".",t=e.payload||{},e=e.type),"string"!==typeof e)throw new Error('"type" must be a string: '.concat(e));if("string"!==typeof n)throw new Error('"to" must be a string: '.concat(n));if("object"!==typeof t)throw new Error('"payload" must be an object: '.concat(t));var r={type:e,payload:t,to:n};return r},promise:function(){return a("@@PROMISE")},resolve:function(e,t){return a("@@RESOLVE",e,t)},reject:function(e,t){return a("@@REJECT",e,t)},isReplyFor:function(e,t){if(t&&"object"!==typeof t)return!1;if(o(e))return!1;if("@@PROMISE"===e.type)return!1;if(!t)return!0;var n=t.type,i=t.payload,a=e&&e.request;return a&&a.type===n&&r(a.payload,i)}}},560:function(e,t,n){var r=n(12),i=n(18)("interblock:dmz:uplink"),a=n(55).replyResolve,s=n(25),o=s.networkModel,c=s.addressModel,u=s.channelModel,l=n(270).autoAlias;e.exports={uplink:function(e,t){return{type:"@@UPLINK",payload:{chainId:e,originAction:t}}},uplinkReducer:function(e,t){r(o.isModel(e));var n=t.payload.chainId;r(n);var s=c.create(n);r.strictEqual(s.getChainId(),n),r(s.isResolved());var d=e.getAlias(s),p={};d&&"UP_LINK"===e[d].systemRole||(d=l(e,".uplink_"),r(!e[d]),p[d]=u.create(s,"UP_LINK"));var f=n.substring(0,9);return i("uplinkReducer ".concat(d," set to ").concat(f)),a({alias:d}),o.merge(e,p)},uplinkReply:function(e,t){var n=t.getRequest().payload.originAction;switch(t.type){case"@@RESOLVE":var r=n.payload.child;i("reply: ",r);var s=e[r].address.getChainId();a({chainId:s},n);break;case"@@REJECT":i("reject: ",t),replyReject(t.payload,n)}}}},561:function(e,t,n){var r=n(80),i=n(15),a=n(12),s=n(25),o=s.networkModel,c=s.addressModel,u=s.channelModel,l=n(88).channelProducer;e.exports={connect:function(e,t){return{type:"@@CONNECT",payload:{alias:e,chainId:t}}},connectReducer:function(e,t){a(o.isModel(e));var n=c.create(t.payload.chainId);a(n.isResolved()),a.strictEqual(n.getChainId(),t.payload.chainId);var s=t.payload.alias;a(s&&"string"===typeof s);var d=e[s]||u.create(n);return d=l.setAddress(d,n),o.clone(i(i({},e),{},r({},s,d)))}}},562:function(e,t,n){var r=n(15),i=n(9),a=n(10),s=n(12),o=n(18)("interblock:dmz:spawn"),c=n(25),u=c.blockModel,l=c.actionModel,d=c.channelModel,p=c.interblockModel,f=(c.txRequestModel,c.networkModel),h=c.dmzModel,v=c.rxRequestModel,g=n(88),y=g.channelProducer,m=(g.networkProducer,n(270).autoAlias),b=n(55),k=b.effectInBand,x=b.replyPromise,w=function(){var e=a(i.mark((function e(t,n){var r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(v.isModel(n)),e.next=3,I(t,n);case 3:return r=e.sent,x(),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),I=function(){var e=a(i.mark((function e(t,n){var a,c,v,g,b,x,w,I,C,M,R,E,P,O;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s(h.isModel(t)),a=n.payload,c=a.alias,v=a.spawnOpts,g=t.network,b=t.validators,x=t.covenantId,w=h.create(r(r({network:f.create(),covenantId:x},v),{},{validators:b})),o("spawn alias: ".concat(c)),c=c||m(g),s(!c.includes("/"),'No / character allowed in "'.concat(c,'"')),"."!==c&&".."!==c){e.next=9;break}throw new Error("Alias uses reserved name: ".concat(c));case 9:if(!g[c]||g[c].address.isUnknown()){e.next=12;break}throw new Error("childAlias exists: ".concat(c));case 12:return e.next=14,k("SIGN_BLOCK",u.create,w);case 14:return I=e.sent,s(u.isModel(I),"Genesis block creation failed"),C={genesis:I,alias:c,originAction:n},M=l.create("@@GENESIS",C),R=I.provenance.getAddress(),E={},P=d.create(R,"./"),O=p.create(I),P=y.ingestInterblock(P,O),P=y.txRequest(P,M),g[c]&&g[c].getRequestIndices().forEach((function(e){var t=g[c].requests[e];P=y.txRequest(P,t)})),E[c]=P,e.abrupt("return",f.merge(g,E));case 27:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={spawn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r={type:"@@SPAWN",payload:{alias:e,spawnOpts:t,actions:n}};return e||delete r.payload.alias,r},spawnReducer:w,spawnReducerWithoutPromise:I}},571:function(e,t,n){var r=n(9),i=n(10),a=n(18)("interblock:covenants:dpkg"),s=n(55).replyResolve,o=function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.type,e.next="GET_INSTALL"===e.t0?3:(e.t0,6);break;case 3:return a("getInstaller"),s(t.installer||{}),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={reducer:o,actions:{setInstaller:function(){return{type:"SET_INSTALL"}},getInstaller:function(){return{type:"GET_INSTALL"}}}}},572:function(e,t,n){var r=n(9),i=n(10),a=n(18)("interblock:covenants:net"),s=n(12),o=n(55).interchain,c=n(103),u=n(70),l=u.Machine,d=(u.assign,c.actions),p=d.spawn,f=(d.connect,n(25)),h=f.socketModel,v=f.covenantIdModel,g=n(378),y=(g.respond,g.send,g.sendParent,g.translator);e.exports={netFactory:function(e){var t={actions:{},guards:{},services:{addTransport:function(){var e=i(r.mark((function e(t,n){var i,s,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a("event: %o",n),i=n.payload.url,s=v.create("socket"),c={isPierced:!0},e.next=6,o(p(i,{covenantId:s,config:c}));case 6:return u=e.sent,e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),rmTransport:function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}},n=l({id:"net",initial:"idle",context:{},strict:!0,states:{idle:{on:{ADD:"addTransport",RM:"rmTransport",PING:"ping",PING_LAMBDA:"pingLambda",VERSION:"version"}},addTransport:{invoke:{src:"addTransport",onDone:"idle"}},rmTransport:{invoke:{src:"rmTransport",onDone:"idle"}},ping:{invoke:{src:"ping",onDone:"idle"}},pingLambda:{invoke:{src:"pingLambda",onDone:"idle"}},version:{entry:"respondVersion",always:"idle"},done:{id:"done",type:"final"},error:{id:"error",type:"final"}}},t);return{actions:{add:function(e){return s.strictEqual(typeof e,"string"),{type:"ADD",payload:{url:e=e.replace(/\//g,"|")}}},rm:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:"RM",payload:{url:e,force:t}}}},schemas:{add:{type:"object",description:"Add a new transport.  Will result in a child of this chain.",required:["url"],properties:{url:{type:"url"},type:h.schema.properties.type,name:{type:"string"}}},rm:{description:"Removes a transport.  Gracefully attempts to close the connection.\n        Force will terminate immediately by deleting the chain"}},reducer:y(n),covenantId:v.create("net")}}}},573:function(e,t,n){var r=n(9),i=n(15),a=n(10),s=n(34),o=n(18)("interblock:covenants:socket"),c=n(12),u=n(103),l=n(70),d=l.Machine,p=l.assign,f=u.actions,h=(f.spawn,f.connect,f.getChannel),v=n(25),g=(v.socketModel,v.covenantIdModel),y=n(574).tcpTransportFactory,m=n(55),b=m.effect,k=m.interchain,x=n(378),w=x.respond,I=(x.send,x.sendParent,x.translator);e.exports={socketFactory:function(e){var t={actions:{addChainId:p({chainIds:function(e,t){var n=e.chainIds;c(Array.isArray(n));var r=new Set(n),i=t.payload.chainId;return c.strictEqual(typeof i,"string"),r.add(i),n=s(r),o("chainIds length: %o",n),n}}),rmChainId:p({chainIds:function(e,t){var n=e.chainIds;c(Array.isArray(n));var r=new Set(n),i=t.payload.chainId;return c.strictEqual(typeof i,"string"),r.delete(i),n=s(r),o("chainIds length: %o",n),n}}),assignRemoteName:p({remoteName:function(e,t){var n=t.data.remoteName;return c.strictEqual(typeof n,"string"),o("remoteName",n),n}}),respondPing:function(e,t){return o("respondPing",t),w(t.data)},respondOrigin:function(e,t){return w(t.data)}},guards:{},services:{connectSocket:function(){var t=a(r.mark((function t(n,a){var s,c,u,l,d;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o("connectSocket"),t.next=3,k(h(".."));case 3:return s=t.sent,c=s.remoteName,o("remoteName: %O",c),u=c.replace(/\|/g,"/"),o("url: %O",u),l=e[c]||y(u),e[c]=l,t.next=12,b("CONNECT",l.connect);case 12:return d=t.sent,o("connected to %o",u),t.abrupt("return",i({remoteName:c},d));case 15:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ping:function(){var t=a(r.mark((function t(n,i){var a,s,u;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.remoteName,c.strictEqual(typeof a,"string"),o("ping: %O",i),s=e[a]){t.next=6;break}throw new Error("No socket found for: ".concat(a));case 6:return t.next=8,b("PING",s.ping,i.payload.data);case 8:return u=t.sent,o("ping result: %O",u),t.abrupt("return",u);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),disconnectSocket:function(){var t=a(r.mark((function t(n,a){var s,c,u;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=n.remoteName,o("disconnectSocket"),c=e[s]){t.next=5;break}throw new Error("No socket found for: ".concat(s));case 5:return t.next=7,b("DISCONNECT",c.disconnect);case 7:return u=t.sent,delete e[s],o("disconnectSocket result: ",u),t.abrupt("return",i({},u));case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}},n=d({id:"socket",initial:"idle",context:{chainIds:[],remoteName:""},strict:!0,states:{idle:{on:{ADD:"addChainId",CONNECT:"connectSocket",DISCONNECT:"disconnectSocket",PING:"ping",PING_LAMBDA:"pingLambda",VERSION:"version",RM:"rmChainId",TRANSMIT:"transmitInterblock"}},addChainId:{entry:"addChainId",always:"idle"},connectSocket:{invoke:{src:"connectSocket",onDone:{target:"idle",actions:["assignRemoteName","respondOrigin"]}}},disconnectSocket:{invoke:{src:"disconnectSocket",onDone:{target:"idle",actions:"respondOrigin"}}},ping:{invoke:{src:"ping",onDone:{target:"idle",actions:"respondPing"}}},pingLambda:{invoke:{src:"pingLambda",onDone:"idle"}},version:{invoke:{src:"version",onDone:"idle"}},rmChainId:{entry:"rmChainId",always:"idle"},transmitInterblock:{invoke:{src:"transmitInterblock",onDone:"idle"}},done:{id:"done",type:"final"},error:{id:"error",type:"final"}}},t);return{actions:{addChainId:function(e){return{type:"ADD",payload:{chainId:e}}},connect:function(){return{type:"CONNECT"}},disconnect:function(){return{type:"DISCONNECT"}},ping:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"PING",payload:{data:e}}},pingLambda:function(){return{type:"PING_LAMBDA"}},version:function(){return{type:"VERSION"}},rmChainId:function(e){return{type:"RM",payload:{chainId:e}}},transmit:function(e){return{type:"TRANSMIT",payload:{interblock:e}}}},schemas:{},reducer:I(n),covenantId:g.create("socket")}}}},574:function(e,t,n){var r=n(9),i=n(10),a=n(12),s=n(25),o=(s.blockModel,s.interblockModel,n(18)("interblock:transport")),c=n(2299);e.exports={tcpTransportFactory:function(e){var t;return{connect:function(){var n=i(r.mark((function n(){var s;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a(!t),(t=new c(e)).on("message",(function(e){o("message: %O",e)})),t.on("close",(function(e){return o("close",e)})),t.on("error",(function(e){return o("error %O",e)})),t.on("ping",(function(e){return o("ping",e.toString())})),t.on("pong",(function(e){return o("pong",e.toString())})),t.on("upgrade",(function(e){return o("upgrade")})),s=Date.now(),n.abrupt("return",new Promise((function(n,a){var c=function(){var e=i(r.mark((function e(n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o("unexpectedResponse"),t.terminate(),a("unexpectedResponse");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.on("open",(function(){o("socket open to ".concat(e)),t.removeListener("unexpected-response",c),n({latencyMs:Date.now()-s})})),t.on("unexpected-response",c)})));case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),ping:function(){var e=i(r.mark((function e(){var n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:"",o("ping: %O",n),e.abrupt("return",new Promise((function(e){var r=Date.now();t.ping(n),t.on("pong",(function(t){a.strictEqual(t.toString(),n);var i=Date.now()-r;e({data:n,latencyMs:i})}))})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pingLambda:function(){var e=i(r.mark((function e(){var n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:"",o("pingLambda: %O",n),e.abrupt("return",new Promise((function(e){var r=Date.now();t.send("PING_LAMBDA ".concat(n)),t.on("message",(function(t){a.strictEqual(t.toString(),"PONG_LAMBDA ".concat(n)),e(Date.now()-r)}))})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),version:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("version"),e.abrupt("return",new Promise((function(e){t.send("VERSION"),t.on("message",(function(t){a.strictEqual(t.toString(),"PONG_LAMBDA ".concat(data)),e(Date.now()-start)}))})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),disconnect:function(){var e=i(r.mark((function e(){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),t.close(),e.abrupt("return",new Promise((function(e,r){t.on("close",(function(){return e({latencyMs:Date.now()-n})}))})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),interblock:function(){var e=i(r.mark((function e(n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:1,a.strictEqual(t.readyState,1,"websocket not open"),t.send(n.serialize());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}}},575:function(e,t,n){var r=n(75),i=n(12),a=n(120).addressModel;e.exports=function(e){i("string"===typeof e);var t,n=e.split("_"),s=r(n,2),o=s[0],c=s[1],u=parseInt(c);return"LOOPBACK"===o?t=a.create("LOOPBACK"):(t=a.create(o),i(t.isResolved())),{address:t,index:u}}},576:function(e,t,n){n(54);var r=n(12),i=(n(18)("interblock:models:lock"),n(245).v4),a=n(41).standardize,s=n(274).timestampModel,o=n(215).blockModel,c=n(279).interblockModel,u=n(382).txReplyModel,l=n(383).txRequestModel,d={title:"Lock",description:"Locking of the persistence layer for execution to take place.",type:"object",required:["uuid","timestamp","expires","interblocks","piercings"],additionalProperties:!1,properties:{uuid:{type:"string",description:"uuidv4 identifying a lock on a chainId"},timestamp:s.schema,expires:{type:"integer",description:"ms until the lock expires",min:0},block:o.schema,interblocks:{type:"array",description:"Punched out blocks from other chains that have accumulated for this chain",uniqueItems:!0,items:c.schema},piercings:{type:"object",description:"Side effects",required:["requests","replies"],properties:{requests:{type:"array",uniqueItems:!0,items:l.schema},replies:{type:"array",uniqueItems:!0,items:u.schema}}}}},p={requests:[],replies:[]},f=a({schema:d,create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i(),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p;r(!e||o.isModel(e)),t=t.map(c.clone),a=h(e,a);var u=s.create(),l=2e3,d={uuid:n,timestamp:u,expires:l,interblocks:t,piercings:a};return e&&(d.block=e),f.clone(d)},logicize:function(e){var t=e.block,n=e.timestamp,i=e.expires,a=e.piercings,s=(e.interblocks,h(t,a)),o=a.requests,c=a.replies;r.strictEqual(s.requests.length,o.length),r.strictEqual(s.replies.length,c.length);return{isLocked:function(){return!n.isExpired(i)},isMatch:function(t){return t.uuid===e.uuid},isPiercingsPresent:function(){return o.length||c.length}}}}),h=function(e,t){var n=t.requests,i=t.replies;return n=n.map((function(e){return r.strictEqual(typeof e,"object"),e=l.clone(e)})),n=y(g(n)),i=i.map((function(e){return r.strictEqual(typeof e,"object"),e=u.clone(e)})),i=y(g(i)),v(e,{requests:n,replies:i})},v=function(e,t){var n=t.requests,r=t.replies;if(!e||!e.network[".@@io"])return{requests:n,replies:r};var i=e.network[".@@io"].getRemote(),a=i.requests,s=i.replies,o=Object.values(a),c=Object.values(s);return{requests:n=n.filter((function(e){return!o.some((function(t){return t.equals(e)}))})),replies:r=r.filter((function(e){return!c.some((function(t){return t.equals(e)}))}))}},g=function(e){var t=[];e.forEach((function(e){t.every((function(t){return!e.equals(t)}))&&t.push(e)}));var n=t.every((function(e){return l.isModel(e)?"string"===typeof e.payload["__@@ioSequence"]:u.isModel(e)}));return r(n),t},y=function(e){return e.sort((function(e,t){var n=e.payload["__@@ioSequence"],r=t.payload["__@@ioSequence"];return n.localeCompare(r)}))};e.exports={lockModel:f}},577:function(e,t,n){var r=n(15),i=(n(12),n(245).v4),a=n(41).standardize,s={id:"fd9e9077-cda5-4b1d-afbf-c8a7cf648ded",type:"internal",info:{}},o=a({schema:{title:"Socket",description:"Socket info, used to store info about block producers",type:"object",required:["id","type","info"],additionalProperties:!1,properties:{id:{type:"string"},type:{enum:["internal","websocket","https","email","udp"]},info:{type:"object"}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return e=r({id:i(),type:"internal",info:{}},e),o.clone(r({},e))},logicize:function(e){return{getIsInternal:function(){return"internal"===e.type}}}});e.exports={socketModel:o}},578:function(e,t,n){var r=n(25).covenantIdModel,i=n(2307).crm;i.covenantId=r.create("crm"),e.exports={crm:i}},579:function(e,t,n){var r=n(75),i=n(9),a=n(10),s=n(18)("interblock:consistency:db"),o=n(12),c=(n(51),n(281).ramDynamoDbFactory);e.exports={dbFactory:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c(),n=function(){var e=a(i.mark((function e(n,r){var a,s,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={TableName:n,Key:r,ConsistentRead:!0,ReturnConsumedCapacity:"TOTAL"},e.next=3,t.get(a).promise();case 3:return s=e.sent,s.ConsumedCapacity,o=s.Item,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(e){return n("dbChains",e)},l=function(){var e=a(i.mark((function e(n,r){var a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(n),o(r),Array.isArray(r)||(r=[r]),a=r.map((function(e){var r={TableName:n,Item:e,ReturnConsumedCapacity:"TOTAL"};return t.put(r).promise()})),e.next=6,Promise.all(a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),d=function(e){return l("dbPools",e)},p=function(e){return l("dbChains",e)},f=function(e){return l("dbSubscribers",e)},h=function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l("dbSockets",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l("dbCrypto",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l("dbPiercings",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=a(i.mark((function e(n,r){var a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(Array.isArray(r)),a=r.map((function(e){var r={TableName:n,Key:e,ReturnConsumedCapacity:"TOTAL"};return t.delete(r).promise()})),e.next=4,Promise.all(a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(e){return y("dbSubscribers",e)},b=function(e){return y("dbPools",e)},k=function(e){return y("dbPiercings",e)},x=function(){var e=a(i.mark((function e(n,r,a){var c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={TableName:n,KeyConditionExpression:"chainId = :hkey",ExpressionAttributeValues:{":hkey":r},ScanIndexForward:!1,ConsistentRead:!0,ReturnConsumedCapacity:"TOTAL"},a&&(c.Limit=1),s("dbQuery: %O %O",n,r),e.next=5,t.query(c).promise();case 5:if(u=e.sent,u.ConsumedCapacity,l=u.Items,o(Array.isArray(l)),s("dbQuery items length: %O",l.length),!a){e.next=11;break}return e.abrupt("return",l[0]);case 11:return e.abrupt("return",l);case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),w=function(e,t){return x("dbSubscribers",e,t)},I=function(e){return x("dbSockets",e)},C=function(e){return x("dbChains",e,!0)},M=function(e){return x("dbPools",e)},R=function(e){return x("dbPiercings",e)},E=function(){var e=a(i.mark((function e(n){var a,s,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={TableName:n,ConsistentRead:!0,Limit:1},e.next=3,t.scan(a).promise();case 3:if(s=e.sent,s.ConsumedCapacity,c=s.Items,o(Array.isArray(c)),!c.length){e.next=10;break}return o.strictEqual(c.length,1),u=r(c,1),l=u[0],e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var t=a(i.mark((function t(){var n;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=2;break}return t.abrupt("return",e);case 2:return t.next=4,E("dbChains");case 4:return(n=t.sent)&&(e=n),t.abrupt("return",e);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),O=function(){var e=a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E("dbCrypto"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{putPool:d,putBlock:p,putSubscriptions:f,putSocket:h,delSubscriptions:m,delPool:b,getBlock:u,queryAffected:w,querySockets:I,queryLatest:C,queryPool:M,scanBaseChainId:P,scanKeypair:O,putKeypair:v,putPierce:g,queryPiercings:R,delPierce:k}}}},580:function(e,t,n){var r=n(75),i=n(9),a=n(10),s=n(12),o=n(18)("interblock:consistency:s3"),c=(n(51),n(25)),u=c.cryptoCacher,l=c.blockModel,d=c.interblockModel,p=n(392).ramS3Factory,f={fromInterblock:function(e){var t=e.getHash(),n=e.provenance.getAddress().getChainId(),r=e.provenance.height,i=e.getRemote(),a=i?i.address.getChainId():"#LINEAGE";return"".concat(n,"/").concat(r,"_").concat(a,"_").concat(t)},fromPoolItem:function(e){var t=e.chainId,n=e.originChainId_height_type,i=e.interblockHash,a=n.split("_"),s=r(a,3),o=s[0],c=s[1],u="light"===s[2]?"#LINEAGE":t;return"".concat(o,"/").concat(c,"_").concat(u,"_").concat(i)},fromBlock:function(e){var t=h(e);return f.fromBlockItem(t)},fromBlockItem:function(e){var t=e.chainId,n=e.height,r=e.blockHash;e.shortestLineage;return"".concat(t,"/").concat(n,"_").concat(r)}},h=function(e){return{chainId:e.provenance.getAddress().getChainId(),height:e.provenance.height,blockHash:e.getHash(),shortestLineage:e.provenance.lineage[0]}};e.exports={s3Factory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p(),t=new Map,n=function(){var n=a(i.mark((function n(r,a){var c,u,l;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=e._isRam?a:a.serialize(),u={Bucket:"wbinterbucket",Key:r,Body:c,ContentType:"application/json"},n.next=4,e.putObject(u).promise();case 4:l=n.sent,t.set(r,a),o("putInterblock: %O",r),s(l);case 8:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),r=function(){var n=a(i.mark((function n(r){var a,s,c,l,p;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a={Bucket:"wbinterbucket",Key:r},o("getInterblock"),!t.has(r)){n.next=5;break}return o("interblock cache hit for %o",r),n.abrupt("return",t.get(r));case 5:return n.prev=5,n.next=8,e.getObject(a).promise();case 8:if(s=n.sent,!d.isModel(s.Body)){n.next=13;break}return n.abrupt("return",s.Body);case 13:return c=s.Body.toString(),l=JSON.parse(c),n.next=17,u.cacheVerifyHash(l);case 17:return p=d.clone(c),o("s3GetInterblock complete"),n.abrupt("return",p);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(5),o("error fetching: %O %O",r,n.t0.message);case 25:case"end":return n.stop()}}),n,null,[[5,22]])})));return function(e){return n.apply(this,arguments)}}(),c=function(){var n=a(i.mark((function n(r){var c;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s(Array.isArray(r)),o("deleteInterblocks: %O",r.length),c=r.map(function(){var n=a(i.mark((function n(r){var a;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={Bucket:"wbinterbucket",Key:r},n.next=3,e.deleteObject(a).promise();case 3:t.delete(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),n.next=5,Promise.all(c);case 5:o("deleteInterblocks complete");case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),f=function(){var n=a(i.mark((function n(r,a){var c,u,d;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s(l.isModel(a)),c=e._isRam?a:a.serialize(),u={Bucket:"wbblockbucket",Key:r,Body:c,ContentType:"application/json"},n.next=5,e.putObject(u).promise();case 5:d=n.sent,t.set(r,a),o("putBlock: %O",r),s(d);case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),h=function(){var n=a(i.mark((function n(r){var a,s,c,d,p;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a={Bucket:"wbblockbucket",Key:r},o("getBlock: %O",r),!t.has(r)){n.next=5;break}return o("block cache hit for: %o",r),n.abrupt("return",t.get(r));case 5:return n.next=7,e.getObject(a).promise();case 7:if(s=n.sent,!l.isModel(s.Body)){n.next=10;break}return n.abrupt("return",s.Body);case 10:return c=s.Body.toString(),d=JSON.parse(c),n.next=14,u.cacheVerifyHash(d);case 14:return p=l.clone(d),o("getBlock complete: %O",r),n.abrupt("return",p);case 17:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return{putInterblock:n,getInterblock:r,deleteInterblocks:c,putBlock:f,getBlock:h}},s3Keys:f}},588:function(e,t,n){var r=n(34),i=n(12),a=n(584),s=n(587),o=n(268),c=n(2352),u=n(2353),l=n(25),d=l.interblockModel,p=(l.blockModel,l.addressModel,l.provenanceModel,s.gray("undefined")),f=function(e){return u(e,{truncate:!0,showHeaders:!1,minWidth:3,config:{msg:{minWidth:15,maxWidth:15},height:{minWidth:8,maxWidth:8},path:{minWidth:18,maxWidth:18}}})},h=function(e,t,n,r){var i=m(e.provenance.getAddress().getChainId()),a=s.green(e.provenance.height),o=e.provenance.reflectIntegrity().hash,c=s.dim(m(o,"bgWhite","green")),u=(y(e),{msg:r?s.gray("NOCHANGE"):s.green("BLOCK"),height:a,path:t,chainId:i,hash:c});return n&&(u.msg=s.red("NEW_CHAIN")),u},v=function(e){var t=[];return e.getAliases().forEach((function(n){var r=e[n],i=r.address,a="-",o=p,c=p;i.isResolved()&&(o=m(i.getChainId(),"bgMagenta","gray")),(i.isRoot()||i.isLoopback())&&(o=m(i.getChainId(),"bgBlack","gray"),c="");var u=r.getRemote();if(r.heavy){var l=r.heavy.provenance.reflectIntegrity().hash;c=s.dim(m(l,"bgWhite","magenta"));var d=r.lineageHeight,f=r.heavyHeight;a=s.magenta(f+"."+d)}var h={msg:s.magenta("  \u2514\u2500\u2500 channel"),height:a,path:s.gray(n),chainId:o,hash:c};t.push(h),k(r.requests,u.replies).forEach((function(e){var n=r.requests[e],i=u.replies[e],a=s.cyan("      \u2514\u2500\u2500 tx:"),o=n?n.type:p,c=s.gray(i?i.type:p),l={msg:a,height:s.cyan(e),path:"",chainId:o,hash:c};t.push(l)})),k(u.requests,r.replies).forEach((function(e){var n=u.requests[e],i=r.replies[e],a={msg:s.yellow("      \u2514\u2500\u2500 rx:"),height:s.yellow(e),path:"",chainId:s.gray(n?n.type:p),hash:i?i.type:p};t.push(a)}))})),t},g=new WeakMap,y=function(e){if(g.has(e))return g.get(e);var t=o(c(2*e.serialize().length),12);return g.set(e,t),t},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bgGreen",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",r=" ".concat(a(o(e,9),9)," ");return s[n][t].bold(r)},b=function(e){return u(e,{truncate:!0,showHeaders:!1,minWidth:3,config:{msg:{minWidth:15,maxWidth:15},height:{minWidth:8,maxWidth:8},path:{minWidth:18,maxWidth:18}}})},k=function(e,t){var n=x(e),i=x(t),a=[].concat(r(n),r(i)),s=new Set(a),o=r(s);return o.sort((function(e,t){return e-t})),o},x=function(e){var t=[];return Object.keys(e).forEach((function(e){var n=parseInt(e);t.push(n)})),t.sort((function(e,t){return e-t})),t};e.exports={blockPrint:function(e,t,n,i){var a=[h(e,t,n,i)];if(!i){var s=v(e.network);a.push.apply(a,r(s))}return f(a)},interPrint:function(e,t,n,r,a){i(d.isModel(e)),t=t||"INTERBLOCK",n=n||"(unknown)",r=r||"bgYellow",a=a||"yellow";var o=e.provenance,c=o.height,u=o.getAddress().getChainId(),l=m(u,r),f=o.reflectIntegrity().hash,h=s.dim(m(f,"bgWhite",a)),v=y(e),g=[{msg:t,height:c,path:n,chainId:l,hash:h,size:v}],k=e.getRemote();return k&&(t=s.magenta("  \u2514\u2500\u2500 channel"),c="-",n=s.gray(e.getOriginAlias()),v=y(k),g.push({msg:t,height:c,path:n,size:v}),t=s.cyan("      \u2514\u2500\u2500 tx:"),Object.keys(k.requests).forEach((function(e){c=e,l=k.requests[e].type,h=p,v=y(k.requests[e]),g.push({msg:t,height:c,chainId:l,hash:h,size:v})})),t=s.yellow("      \u2514\u2500\u2500 rx:"),Object.keys(k.replies).forEach((function(e){c=e,l=p,h=k.replies[e].type,v=y(k.replies[e]),g.push({msg:t,height:c,chainId:l,hash:h,size:v})}))),b(g)},headerPrint:h,networkPrint:v,print:f}},594:function(e,t,n){"use strict";var r=n(9),i=n(10),a=n(21),s=n(27),o=n(66),c=n(59),u=n(37),l=n(38),d=n(394),p=function(){throw new Error("expected prompt to have a custom authenticate method")};e.exports=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,n=function(n){u(p,n);var d=l(p);function p(e){return a(this,p),d.call(this,e)}return s(p,[{key:"submit",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.call(this,this.values,this.state);case 2:this.value=e.sent,o(c(p.prototype),"base",this).submit.call(this);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"create",value:function(t){return e(t)}}]),p}(d);return n}()},595:function(e,t,n){"use strict";var r=n(76);e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.cursorHide();var n=t.input,i=void 0===n?"":n,a=t.initial,s=void 0===a?"":a,o=t.pos,c=t.showCursor,u=void 0===c||c,l=t.color,d=l||e.styles.placeholder,p=r.inverse(e.styles.primary),f=function(t){return p(e.styles.black(t))},h=i,v=" ",g=f(v);if(e.blink&&!0===e.blink.off&&(f=function(e){return e},g=""),u&&0===o&&""===s&&""===i)return f(v);if(u&&0===o&&(i===s||""===i))return f(s[0])+d(s.slice(1));s=r.isPrimitive(s)?"".concat(s):"",i=r.isPrimitive(i)?"".concat(i):"";var y=s&&s.startsWith(i)&&s!==i,m=y?f(s[i.length]):g;if(o!==i.length&&!0===u&&(h=i.slice(0,o)+f(i[o])+i.slice(o+1),m=""),!1===u&&(m=""),y){var b=e.styles.unstyle(h+m);return h+m+d(s.slice(b.length))}return h+m}},596:function(e,t,n){"use strict";var r=n(21),i=n(27),a=n(66),s=n(59),o=n(37),c=n(38),u=n(179),l=n(2411),d=function(e){o(n,e);var t=c(n);function n(e){var i;r(this,n);var a=(i=t.call(this,e)).options.history;if(a&&a.store){var s=a.values||i.initial;i.autosave=!!a.autosave,i.store=a.store,i.data=i.store.get("values")||{past:[],present:s},i.initial=i.data.present||i.data.past[i.data.past.length-1]}return i}return i(n,[{key:"completion",value:function(e){return this.store?(this.data=l(e,this.data,this.input),this.data.present?(this.input=this.data.present,this.cursor=this.input.length,this.render()):this.alert()):this.alert()}},{key:"altUp",value:function(){return this.completion("prev")}},{key:"altDown",value:function(){return this.completion("next")}},{key:"prev",value:function(){return this.save(),a(s(n.prototype),"prev",this).call(this)}},{key:"save",value:function(){this.store&&(this.data=l("save",this.data,this.input),this.store.set("values",this.data))}},{key:"submit",value:function(){return this.store&&!0===this.autosave&&this.save(),a(s(n.prototype),"submit",this).call(this)}}]),n}(u);e.exports=d},597:function(e,t,n){"use strict";var r=n(15),i=n(21),a=n(27),s=n(66),o=n(59),c=n(37),u=n(38),l=function(e){c(n,e);var t=u(n);function n(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,n),(e=t.call(this,r({style:"number"},a))).min=e.isValue(a.min)?e.toNumber(a.min):-1/0,e.max=e.isValue(a.max)?e.toNumber(a.max):1/0,e.delay=null!=a.delay?a.delay:1e3,e.float=!1!==a.float,e.round=!0===a.round||!1===a.float,e.major=a.major||10,e.minor=a.minor||1,e.initial=null!=a.initial?a.initial:"",e.input=String(e.initial),e.cursor=e.input.length,e.cursorShow(),e}return a(n,[{key:"append",value:function(e){return!/[-+.]/.test(e)||"."===e&&this.input.includes(".")?this.alert("invalid number"):s(o(n.prototype),"append",this).call(this,e)}},{key:"number",value:function(e){return s(o(n.prototype),"append",this).call(this,e)}},{key:"next",value:function(){return this.input&&this.input!==this.initial?this.alert():this.isValue(this.initial)?(this.input=this.initial,this.cursor=String(this.initial).length,this.render()):this.alert()}},{key:"up",value:function(e){var t=e||this.minor,n=this.toNumber(this.input);return n>this.max+t?this.alert():(this.input="".concat(n+t),this.render())}},{key:"down",value:function(e){var t=e||this.minor,n=this.toNumber(this.input);return n<this.min-t?this.alert():(this.input="".concat(n-t),this.render())}},{key:"shiftDown",value:function(){return this.down(this.major)}},{key:"shiftUp",value:function(){return this.up(this.major)}},{key:"format",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input;return"function"===typeof this.options.format?this.options.format.call(this,e):this.styles.info(e)}},{key:"toNumber",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.float?+e:Math.round(+e)}},{key:"isValue",value:function(e){return/^[-+]?[0-9]+((\.)|(\.[0-9]+))?$/.test(e)}},{key:"submit",value:function(){var e=this,t=[this.input,this.initial].find((function(t){return e.isValue(t)}));return this.value=this.toNumber(t||0),s(o(n.prototype),"submit",this).call(this)}}]),n}(n(179));e.exports=l},598:function(e,t,n){var r=n(9),i=n(10),a=n(12),s=n(47)("dos:commands:cd"),o=function(){var e=i(r.mark((function e(t){var n,i,o,c,u,l=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,i=t.blockchain,o=l.length>1&&void 0!==l[1]?l[1]:".",a.strictEqual(typeof o,"string"),s("cd: ".concat(o)),n.text="Resolving: ".concat(o),e.next=7,i.cd(o);case 7:return c=i.getContext(),s("context: %O",c),u=c.wd,e.abrupt("return",{ctx:{wd:u}});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports=o,e.exports.help="\nNavigate through the filesystem graph using Posix compliant pathing.\nCan jump straight to an object by specifying a chainId.\n"},602:function(e,t,n){(function(t){var r=n(9),i=n(10),a=(n(90),n(47)("dos:print"));e.exports=function(){var e=i(r.mark((function e(n){var i,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"string"!==typeof n){e.next=5;break}i={out:n},e.next=8;break;case 5:return e.next=7,n();case 7:i=e.sent;case 8:i&&i.out&&(s="[object String]"===Object.prototype.toString.call(i.out)?i.out:JSON.stringify(i.out,null,2),o=s.replace(/(?:\r\n|\r|\n)/g,"\r\n"),t.stdout.write(o),t.stdout.write("\r\n")),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),a(e.t0),t.stderr.write("\u274c\ufe0f ".concat(e.t0,"\r\n"));case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(20))},603:function(e,t,n){"use strict";n(9),n(136),n(14),n(12),n(0),n(78);var r=n(42);n.n(r)()("terminal:useChannel")},708:function(e,t,n){"use strict";(function(e){var r=n(64),i=n(12),a=n.n(i),s=n(0),o=n(42),c=n.n(o),u=n(709),l=n(710),d=n(711),p=n(465),f=n.n(p),h=(n(796),n(797),n(13)),v=n(799).stdin,g=c()("terminal:cli"),y=function(t){g("toStdStream");var n=function(){var t=e.stdin;v();var n=e.stdin;return Object.defineProperty(e,"stdin",{value:t,writable:!0}),n}();t.stdin=n,t.isTTY=!0;t.clearLine=function(){g("clearLine"),t.write("\x1b[2K")},t.cursorTo=function(e,n){g("cursorTo: ",e,n),a.a.strictEqual(e,0);t.write("\x1b[1000D")}},m="F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12".split(" ");t.a=function(t){var n=Object(s.useRef)();return Object(s.useEffect)((function(){g("opening terminal");var t=new u.Terminal({cursorBlink:!0,cursorStyle:"block",convertEol:!0,rendererType:"dom"}),r=new l.FitAddon;t.loadAddon(r);var i=new d.Unicode11Addon;t.loadAddon(i),t.unicode.activeVersion="11",t.open(document.getElementById("xterm-container")),r.fit(),t.focus(),y(t),t.attachCustomKeyEventHandler((function(e){var t=e.key,n=e.type;if(m.includes(t))return g("ignoring: ".concat(t," with type: ").concat(n)),!1})),t.onKey((function(e){var n=e.key;e.domEvent;t.stdin.send(n)})),n.current=t,window.addEventListener("resize",(function(){r.fit(),t.columns=t.cols})),e.stdout=t,e.stdin=t.stdin,e.stderr=t,t.columns=t.cols;var a=new f.a("Roboto Mono"),s=b();g("isTor: ",s);var o=5e6,c=[a.load(null,o)],p="Roboto Mono";if(s){g("loading emojis for tor browser");var h=new f.a("TorEmoji");c.push(h.load("\ud83e\udd84",o)),p+=", TorEmoji"}Promise.all(c).catch((function(e){g("error loading fonts: ",e)})).then((function(){g("fonts loaded "),g("fonts were: ",t.getOption("fontFamily")),t.setOption("fontFamily",p),g("fonts set: ",t.getOption("fontFamily")),r.fit()}))}),[]),Object(h.jsx)("div",Object(r.a)({id:"xterm-container"},t))};var b=function(){for(var e=document.fonts.entries(),t=!1;!t;){var n=e.next();if(t=n.done,n.value&&"proxima-nova"===n.value[0].family)return!1}return!0}}).call(this,n(20))},713:function(e,t,n){(function(t){var r=n(9),i=n(10),a=n(47)("dos"),s=n(2370),o=n(396).evaluate,c=n(398).withSpin,u=n(602);function l(e,t,n,r){return a("evalPrint"),r.evaluate=r.evaluate||c(o),u((function(){return r.evaluate(e,t,n)}))}e.exports=function(){var e=i(r.mark((function e(n){var i,o=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>1&&void 0!==o[1]?o[1]:{},a("argv",n),n=(n||t.argv).slice(2),a("argv",n),e.abrupt("return",n.length?l(ctx,n[0],n.slice(1),i):s(i));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(20))},714:function(e,t,n){"use strict";(function(e){var r=n(82),i=n(64),a=(n(0),n(42)),s=n.n(a),o=n(127),c=n(110),u=(n(603),n(246),n(2921)),l=n(2922),d=n(751),p=n(752),f=n(2924),h=n(95),v=n(2923),g=n(2925),y=n(2926),m=n(2927),b=n(73),k=n(13),x=s()("terminal:widgets:Home"),w=Object(b.a)({grow:{flexGrow:1},navDisplayFlex:{display:"flex",justifyContent:"space-between"},linkText:{textDecoration:"none",textTransform:"uppercase",color:"white"}}),I=function(e){var t=["..",".",".@@io","about","settings","account"];return e.network.getAliases().filter((function(e){return!t.includes(e)}))};t.a=function(t){x("props: ",t);var n=w(),a=t.block,s=t.path,b=t.cwd,C=Object(c.a)(s,b),M=Object(i.a)(Object(i.a)({},t),{},{cwd:C}),R=C?Object(k.jsx)(o.a,Object(i.a)({},M)):null,E=I(a);x("aliases: ",E);var P=E.map((function(e){return{title:e,path:"/"+e}})),O=function(t){return function(){x("onclick",t);var n=b+"/"+t;if(s!==n){var i,a="cd ".concat(n,"\n"),o=Object(r.a)(a);try{for(o.s();!(i=o.n()).done;){var c=i.value;e.stdin.send(c)}}catch(u){o.e(u)}finally{o.f()}}else x("no change to ".concat(s))}},A=function(e,t,n){return Object(k.jsx)(h.a,{edge:"end","aria-label":n,"aria-haspopup":"true",onClick:O(e),color:"inherit",children:t})};return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(u.a,{position:"static",children:Object(k.jsxs)(l.a,{children:[Object(k.jsx)(h.a,{edge:"start",color:"inherit","aria-label":"home",children:Object(k.jsx)(v.a,{})}),Object(k.jsx)(d.a,{component:"nav","aria-labelledby":"main navigation",className:n.navDisplayFlex,children:P.map((function(e){var t=e.title;e.path;return Object(k.jsx)("a",{className:n.linkText,onClick:O(t),children:Object(k.jsx)(p.a,{button:!0,children:Object(k.jsx)(f.a,{primary:t})})},t)}))}),Object(k.jsx)("div",{className:n.grow}),A("about",Object(k.jsx)(g.a,{}),"about"),A("settings",Object(k.jsx)(y.a,{}),"application settings"),A("account",Object(k.jsx)(m.a,{}),"current user account")]})}),R]})}}).call(this,n(20))},719:function(e,t,n){"use strict";(function(e){var r=n(9),i=n.n(r),a=n(82),s=n(136),o=n(64),c=n(0),u=n(720),l=n.n(u),d=n(335),p=n(12),f=n.n(p),h=n(42),v=n.n(h),g=n(127),y=n(110),m=n(78),b=n(2939),k=n(2940),x=(n(2917),n(246)),w=n(13);d.a.setLicenseKey("0f94d8b65161817ca5d7f7af8ac2f042T1JERVI6TVVJLVN0b3J5Ym9vayxFWFBJUlk9MTY1NDg1ODc1MzU1MCxLRVlWRVJTSU9OPTE=");var I=v()("terminal:widgets:Customers"),C=function(e){var t=["..",".",".@@io"];return e.network.getAliases().filter((function(e){return!t.includes(e)&&!e.startsWith(".")}))},M=function(e){var t,n=e.path,r=e.field,i=e.alias,a=e.namePath,s=Object(x.a)(n);if(r===a)t=i;else if(s&&s.state.formData){t=s.state.formData[r]}return Object(w.jsx)("div",{children:t})};t.a=function(t){var n=t.block,r=t.path,u=t.cwd,p=Object(m.a)(),h=(p.blockchain,p.isPending),v=Object(c.useRef)(),x=Object(y.a)(r,u),R=Object(o.a)(Object(o.a)({},t),{},{cwd:x}),E=x?Object(w.jsx)(g.a,Object(o.a)({},R)):null,P=function(){var t=Object(s.a)(i.a.mark((function t(){var n,r,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f()(!h,"Cannot add customers simultaneously"),I("addCustomer"),"./add --isTestData\n",n=Object(a.a)("./add --isTestData\n");try{for(n.s();!(r=n.n()).done;)s=r.value,e.stdin.send(s)}catch(i){n.e(i)}finally{n.f()}return t.next=7,h;case 7:t.sent,"cd /crm/customers/bob";case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),O=n.state.datumTemplate,A=v.current||[],q=[];O&&!v.current&&function(){v.current=A;var e=O.schema.properties,t=O.namePath;for(var n in e){var r=e[n],i=r.title,a=void 0===i?n:i,s=r.description,o=void 0===s?"":s;o=o||a;var c=l()(a,{font:"Arial",fontSize:"14px"}).width;I("width",a,c),A.push({field:n,headerName:a,description:o,renderCell:function(e){var n=e.row,r=(e.id,e.field),i=n.child,a=u+"/"+i;return I(a),Object(w.jsx)(M,{path:a,field:r,alias:i,namePath:t[0]})},width:c+60})}}();var j=C(n);j.length;var S,T=Object(a.a)(j);try{for(T.s();!(S=T.n()).done;){var D=S.value;q.push({id:q.length,child:D})}}catch(L){T.e(L)}finally{T.f()}return Object(w.jsxs)("div",{style:{flex:"1"},children:[Object(w.jsx)(d.b,{columns:A,rows:q,loading:!O,disableMultipleSelection:!0,onRowClick:function(t){var n=t.id,i=j[n];I("onclick",i,u);var s=u+"/"+i;if(r!==s){var o,c="cd ".concat(s,"\n"),l=Object(a.a)(c);try{for(l.s();!(o=l.n()).done;){var d=o.value;e.stdin.send(d)}}catch(L){l.e(L)}finally{l.f()}}else I("no change to ".concat(r))},hideFooter:!0,autoHeight:!0,logLevel:"warn"}),Object(w.jsx)(b.a,{color:"primary",style:{margin:0,top:"auto",right:20,bottom:20,left:"auto",position:"fixed"},onClick:P,disabled:h,children:Object(w.jsx)(k.a,{})}),E]})}}).call(this,n(20))},724:function(e,t,n){"use strict";(function(e){n(82);var r=n(14),i=n(342),a=n(0),s=n(73),o=n(252),c=n(479),u=n(755),l=n(756),d=n(95),p=n(757),f=n(2943),h=n(2944),v=n(2945),g=n(78),y=n(42),m=n.n(y),b=n(13),k=m()("terminal:widgets:Datum"),x=Object(s.a)((function(e){return{root:{flexGrow:1},card:{maxWidth:345},paper:{padding:e.spacing(2)}}}));t.a=function(e){var t=e.block.state,n=t.schema,s=t.formData,y=t.uiSchema,m=(t.children,n.title),w=Object(i.a)(n,["title"]),I=Object(a.useState)(s),C=Object(r.a)(I,2),M=C[0],R=C[1],E=Object(g.a)().isPending,P=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];k.apply(void 0,["onBlur: "].concat(t))},O=function(e){var t=e.formData;k("onChange: ",t),R(t)},A=x();return Object(b.jsxs)(c.a,{container:!0,spacing:3,children:[Object(b.jsx)(c.a,{item:!0,children:Object(b.jsxs)(u.a,{className:A.card,children:[Object(b.jsx)(l.a,{title:m,action:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(d.a,{"aria-label":"edit",children:Object(b.jsx)(f.a,{color:"primary"})}),Object(b.jsx)(d.a,{"aria-label":"edit",children:Object(b.jsx)(h.a,{color:"secondary"})})]})}),Object(b.jsx)(p.a,{children:Object(b.jsx)(o.a,{disabled:!0,schema:w,uiSchema:y,formData:M,children:!0,onBlur:P,onChange:O})})]})}),Object(b.jsx)(c.a,{item:!0,children:Object(b.jsxs)(u.a,{className:A.card,children:[Object(b.jsx)(l.a,{title:"Address",action:Object(b.jsx)(d.a,{"aria-label":"edit",children:Object(b.jsx)(v.a,{color:"primary"})})}),Object(b.jsx)(p.a,{children:Object(b.jsx)(o.a,{disabled:E,schema:w,uiSchema:y,formData:M,children:!0,onBlur:P,onChange:O})})]})})]})}}).call(this,n(20))},746:function(e,t,n){"use strict";(function(e){var r=n(82),i=n(14),a=n(342),s=n(0),o=n(42),c=n.n(o),u=n(192),l=n(252),d=n(78),p=n(13),f=c()("terminal:widgets:Settings");t.a=function(t){var n=t.block.state,o=n.schema,c=n.formData,h=o.title,v=Object(a.a)(o,["title"]),g=Object(s.useState)(c),y=Object(i.a)(g,2),m=y[0],b=y[1],k=Object(d.a)().isPending;return Object(p.jsx)(u.a,{title:h,children:Object(p.jsx)(l.a,{disabled:k,schema:v,formData:m,children:!0,onBlur:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];f.apply(void 0,["onBlur: "].concat(t))},onChange:function(t){var n=t.formData;f("onChange: ",n),b(n),function(t){var n=JSON.stringify(t);f("setDatum",n);var i,a="./set --formData ".concat(n,"\n"),s=Object(r.a)(a);try{for(s.s();!(i=s.n()).done;){var o=i.value;e.stdin.send(o)}}catch(c){s.e(c)}finally{s.f()}}(n)}})})}}).call(this,n(20))},747:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var r=n(82),i=n(14),a=n(0),s=n(78),o=n(42),c=n.n(o)()("terminal:useNavigation"),u=function(){var t=Object(s.a)(),n=t.blockchain,o=t.context,u=Object(a.useState)(),l=Object(i.a)(u,2),d=l[0],p=l[1];if(Object(a.useEffect)((function(){if(n){c("setting popstate event listener");var t=function(t){var n=t.state.wd;c("popstate wd: ",n);var i,a="cd ".concat(n,"\n"),s=Object(r.a)(a);try{for(s.s();!(i=s.n()).done;){var o=i.value;e.stdin.send(o)}}catch(u){s.e(u)}finally{s.f()}p(n)};return window.addEventListener("popstate",t),function(){window.removeEventListener("popstate",t)}}c("popstate not settable")}),[n]),o){var f=o.wd;window.location.pathname!==f?(c("window.history.pushState: ",f),d?c("command was from history"):(c("command was not from history"),window.history.pushState({wd:f},"",f),window.history.replaceState({wd:f},"",f),document.title=f)):d&&p()}}}).call(this,n(20))},76:function(e,t,n){"use strict";(function(e){var r=n(34),i=Object.prototype.toString,a=n(105),s=!1,o=[],c={yellow:"blue",cyan:"red",green:"magenta",black:"white",blue:"yellow",red:"cyan",magenta:"green",white:"black"};t.longest=function(e,t){return e.reduce((function(e,n){return Math.max(e,t?n[t].length:n.length)}),0)},t.hasColor=function(e){return!!e&&a.hasColor(e)};var u=t.isObject=function(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)};t.nativeType=function(e){return i.call(e).slice(8,-1).toLowerCase().replace(/\s/g,"")},t.isAsyncFn=function(e){return"asyncfunction"===t.nativeType(e)},t.isPrimitive=function(e){return null!=e&&"object"!==typeof e&&"function"!==typeof e},t.resolve=function(e,t){if("function"===typeof t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return t.call.apply(t,[e].concat(r))}return t},t.scrollDown=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(r(e.slice(1)),[e[0]])},t.scrollUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[e.pop()].concat(r(e))},t.reorder=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.slice();return t.sort((function(e,t){return e.index>t.index?1:e.index<t.index?-1:0})),t},t.swap=function(e,t,n){var r=e.length,i=n===r?0:n<0?r-1:n,a=e[t];e[t]=e[i],e[i]=a},t.width=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,r=t&&t.columns?t.columns:n;return t&&"function"===typeof t.getWindowSize&&(r=t.getWindowSize()[0]),"win32"===e.platform?r-1:r},t.height=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=e&&e.rows?e.rows:t;return e&&"function"===typeof e.getWindowSize&&(n=e.getWindowSize()[1]),n},t.wordWrap=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return e;"number"===typeof t&&(t={width:t});var n=t,r=n.indent,i=void 0===r?"":r,a=n.newline,s=void 0===a?"\n"+i:a,o=n.width,c=void 0===o?80:o,u=(s+i).match(/[^\S\n]/g)||[];c-=u.length;var l=".{1,".concat(c,"}([\\s\\u200B]+|$)|[^\\s\\u200B]+?([\\s\\u200B]+|$)"),d=e.trim(),p=new RegExp(l,"g"),f=d.match(p)||[];return f=f.map((function(e){return e.replace(/\n$/,"")})),t.padEnd&&(f=f.map((function(e){return e.padEnd(c," ")}))),t.padStart&&(f=f.map((function(e){return e.padStart(c," ")}))),i+f.join(s)},t.unmute=function(e){var t=e.stack.find((function(e){return a.keys.color.includes(e)}));return t?a[t]:e.stack.find((function(e){return"bg"===e.slice(2)}))?a[t.slice(2)]:function(e){return e}},t.pascal=function(e){return e?e[0].toUpperCase()+e.slice(1):""},t.inverse=function(e){if(!e||!e.stack)return e;var n=e.stack.find((function(e){return a.keys.color.includes(e)}));if(n){var r=a["bg"+t.pascal(n)];return r?r.black:e}var i=e.stack.find((function(e){return"bg"===e.slice(0,2)}));return i?a[i.slice(2).toLowerCase()]||e:a.none},t.complement=function(e){if(!e||!e.stack)return e;var n=e.stack.find((function(e){return a.keys.color.includes(e)})),r=e.stack.find((function(e){return"bg"===e.slice(0,2)}));if(n&&!r)return a[c[n]||n];if(r){var i=r.slice(2).toLowerCase(),s=c[i];return s&&a["bg"+t.pascal(s)]||e}return a.none},t.meridiem=function(e){var t=e.getHours(),n=e.getMinutes(),r=t>=12?"pm":"am";return(0===(t%=12)?12:t)+":"+(n<10?"0"+n:n)+" "+r},t.set=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;return n.split(".").reduce((function(e,n,i,a){var s=a.length-1>i?e[n]||{}:r;return!t.isObject(s)&&i<a.length-1&&(s={}),e[n]=s}),e)},t.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=null==e[t]?t.split(".").reduce((function(e,t){return e&&e[t]}),e):e[t];return null==r?n:r},t.mixin=function(e,n){if(!u(e))return n;if(!u(n))return e;for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r],s=Object.getOwnPropertyDescriptor(n,a);if(s.hasOwnProperty("value"))if(e.hasOwnProperty(a)&&u(s.value)){var o=Object.getOwnPropertyDescriptor(e,a);u(o.value)&&o.value!==s.value?e[a]=t.merge({},e[a],n[a]):Reflect.defineProperty(e,a,s)}else Reflect.defineProperty(e,a,s);else Reflect.defineProperty(e,a,s)}return e},t.merge=function(){for(var e={},n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var a=0,s=r;a<s.length;a++){var o=s[a];t.mixin(e,o)}return e},t.mixinEmitter=function(e,n){for(var r=n.constructor.prototype,i=0,a=Object.keys(r);i<a.length;i++){var s=a[i],o=r[s];"function"===typeof o?t.define(e,s,o.bind(n)):t.define(e,s,o)}},t.onExit=function(t){var n=function(t,n){s||(s=!0,o.forEach((function(e){return e()})),!0===t&&e.exit(128+n))};0===o.length&&(e.once("SIGTERM",n.bind(null,!0,15)),e.once("SIGINT",n.bind(null,!0,2)),e.once("exit",n)),o.push(t)},t.define=function(e,t,n){Reflect.defineProperty(e,t,{value:n})},t.defineExport=function(e,t,n){var r;Reflect.defineProperty(e,t,{enumerable:!0,configurable:!0,set:function(e){r=e},get:function(){return r?r():n()}})}}).call(this,n(20))},78:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(325),a=function(){return Object(r.useContext)(i.a)}},788:function(e,t,n){},789:function(e,t,n){},803:function(e,t){},805:function(e,t){},814:function(e,t,n){var r=n(495).effectorFactory,i=n(2365).awsFactory,a=n(2366).browserFactory;e.exports={effectorFactory:r,awsFactory:i,browserFactory:a}},815:function(e,t,n){(function(t){var r=n(15),i=n(9),a=n(10),s=n(12),o=n(18)("ib:met"),c=n(51),u=n(496).standardEngineFactory,l=n(390).isolateFactory,d=n(123),p=d.consistencyFactory,f=d.ramDynamoDbFactory,h=d.ramS3Factory,v=d.s3Keys,g=n(2339).createBase,y=n(2340).createTap,m=n(103).actions,b=n(217),k=n(25),x=k.blockModel,w=k.interblockModel,I=k.addressModel,C=n(2362).piercerFactory,M=0,R=function(){var e=a(i.mark((function e(n){var d,y,k,R,A,q,j,S,T,D,L,N=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=N.length>1&&void 0!==N[1]?N[1]:{},s.strictEqual(typeof d,"object"),n=n||"id-".concat(M++),o.extend("".concat(n)),y=u(),y.sqsTx,y.sqsRx,y.sqsTransmit,k=y.sqsPool,R=y.sqsIncrease,y.ioCrypto,A=y.ioIsolate,q=y.ioConsistency,y.ioPool,y.ioIncrease,A.setProcessor(l(d)),j=f(),S=h(),q.setProcessor(p(j,S,n)),T=E(y,n),e.next=13,g(q,k);case 13:return D=e.sent,L=function e(n,o){s(I.isModel(n));var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;"number"===typeof e&&void 0===t&&(t=e,e=[]);var r,i=j._getTables(),a=i.dbChains,o=a[n.getChainId()]||{};if(void 0===t)r=c.last(Object.values(o));else{if(!o[t])throw new Error("out of bounds: ".concat(t," ").concat(o.length));r=o[t]}if(r){var u=v.fromBlockItem(r),l=S._getBuckets(),d=l.wbblockbucket,p=d[u];s(x.isModel(p));var f=p;return e.forEach((function(e){s(f[e],"No segment: ".concat(e)),f=f[e]})),f}},l=function(e){return new Promise((function(t,n){var r=f(e,function(){var e=a(i.mark((function e(n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(n),e.next=3,Promise.resolve();case 3:r();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))},p=new Map,f=function(e,t){h(e);var n=p.get(e),r=n.subs,i=n.latest;return r.add(t),i&&setTimeout((function(){return t(i)})),function(){r.delete(t)}},h=function(e,t){p.has(e)||p.set(e,{subs:new Set,latest:t})},g=new Set,k=new Set;q.subscribe(function(){var e=a(i.mark((function e(t,r){var a,s,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("UNLOCK"!==t.type){e.next=9;break}return e.next=3,r;case 3:a=t.payload.block,s=a.getChainId(),k.has(a)||s!==n.getChainId()||(k.add(a),g.forEach((function(e){return e()}))),h(s,a),(o=p.get(s)).latest&&!o.latest.isNext(a)||(o.latest=a,o.subs.forEach((function(e){return e(a)})));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),t((function(){return g.forEach((function(e){return e()}))}));var M=function(){var e=a(i.mark((function e(n){var r,a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object.values(y);case 1:if(!r.some((function(e){return e.length()||e.awaitingLength()}))){e.next=12;break}return a=r.map((function(e){return e.settle()})),e.next=5,Promise.all(a);case 5:return e.next=7,new Promise(t);case 7:if(!n){e.next=10;break}return e.next=10,n.settle();case 10:e.next=1;break;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=C(n,q,R),A=function(){return r(r({},b),d)},L=function(){var e=a(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t);case 2:if(n=e.sent,!(r=P(n,A()))){e.next=6;break}return e.abrupt("return",r.actions);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=a(i.mark((function e(t){var n,r,a,o,c;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=O(t),r=n.shift(),a=D.getChainId(),e.next=5,l(a);case 5:o=e.sent;case 6:if(r===t){e.next=16;break}return r=n.shift(),c=r.split("/").pop(),s(o.network[c].address.isResolved()),a=o.network[c].address.getChainId(),e.next=13,l(a);case 13:o=e.sent,e.next=6;break;case 16:return e.abrupt("return",o);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{pierce:E,spawn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return E(m.spawn(e,t))},subscribe:function(e){return s.strictEqual(typeof e,"function"),g.add(e),function(){return g.delete(e)}},subscribeBlockstream:f,getLatest:l,getLatestFromPath:N,getState:u,getContext:function(){return u(["state","context"])},getChildren:function(){var t=u(),n=t.network.getAliases(),r={};return n.forEach((function(n){var i=t.network[n];if("./"===i.systemRole){var a=i.address,s="/"===o?n:o+"/"+n;r[n]=e(a,s)}})),r},getAbsolutePath:function(){return o},getChannels:function(){return u().network},getEngine:function(){return y},getPersistence:function(){return q.getProcessor().persistence},getChainId:function(){return u().provenance.getAddress().getChainId()},getHeight:function(){return u().provenance.height},getPool:function(){var e=j._getTables().dbPools[n.getChainId()],t=Object.values(e).map(v.fromPoolItem),r=S._getBuckets().wbinterbucket;return t.map((function(e){var t=r[e];return s(t),w.clone(t)}))},getCovenants:A,settle:M,enableLogging:function(){return T.on()},disableLogging:function(){return T.off()},getBlockCount:function(){return T.getBlockCount()},getChainCount:function(){return T.getChainCount()},getActionCreators:L}},e.abrupt("return",L(D,"/"));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(e,t){var n=e.sqsPool,r=e.sqsTransmit,s=e.ioConsistency;debugPrefix=t?"ib:met:".concat(t):"ib:met";var o=y(debugPrefix);return n.subscribe(function(){var e=a(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),r.subscribe(function(){var e=a(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),s.subscribe(function(){var e=a(i.mark((function e(t,n){var r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("LOCK"!==t.type){e.next=6;break}return r=Date.now(),e.next=4,n;case 4:e.sent&&o.lock(t.payload,r);case 6:if("UNLOCK"!==t.type){e.next=10;break}return e.next=9,n;case 9:o.block(t.payload.block);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o},P=function(e,t){var n=e.covenantId,r=b.unity;if("hyper"===n.name)return t.hyper;for(var i in t)t[i].covenantId.equals(n)&&(s(r===b.unity),r=t[i]);return r},O=function(e){if("/"===e)return["/"];var t="",n=e.split("/").filter((function(e){return!!e}));return n.unshift("/"),n.map((function(e){return t&&"/"!==t&&(t+="/"),t+=e}))};e.exports={metrologyFactory:R}}).call(this,n(148).setImmediate)},819:function(e,t,n){(function(t){var r=n(15),i=n(54),a=n(34),s=n(9),o=n(10),c=n(820),u=n(12),l=function(e,r){u(e&&"string"===typeof e);var l,p=n(18)("interblock:queue:"+e),f=!0,h=[],v=new Set,g=Number.MAX_SAFE_INTEGER,y=0,m=function(){var e=o(s.mark((function e(){var t;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.resolve();case 4:for(;f&&v.size<g&&h.length;)p("awaiting size: ".concat(v.size)),t=h.shift(),v.add(t),b(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var n=o(s.mark((function n(r){var i,a,o,c;return s.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u(r&&"object"===typeof r),i=r.action,a=r.resolve,o=r.reject,r.promise,u(a&&o),n.prev=3,n.next=6,l(i);case 6:c=n.sent,t(a,c),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(3),p("".concat(e," rejected: %O %O"),r,n.t0),t(o,n.t0);case 14:m(),u(v.has(r)),v.delete(r);case 17:case"end":return n.stop()}}),n,null,[[3,10]])})));return function(e){return n.apply(this,arguments)}}(),k=new Set,x={name:e,settle:function(){var e=o(s.mark((function e(){var n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v.size&&!h.length){e.next=12;break}if(p("settle _awaiting.size: %o _requests.length: %o",v.size,h.length),!v.size){e.next=8;break}return n=a(v).map((function(e){return e.promise})),e.next=6,Promise.race(n);case 6:e.next=10;break;case 8:return e.next=10,new Promise(t);case 10:e.next=0;break;case 12:p("settled");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),length:function(){return h.length},awaitingLength:function(){return v.size},awaitNextPush:function(){var e=o(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var t=x.subscribe((function(n,r){t(),e(n)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),subscribe:function(e){return u("function"===typeof e),k.add(e),function(){return k.delete(e)}},getProcessor:function(){return l},rejectAll:function(){x.setProcessor((function(e){throw new Error("Tried to process: ".concat(JSON.parse(e,null,2)))}))},setConcurrency:function(e){g=e,m()},push:function(){var e=o(s.mark((function e(t){var n,a,o,c;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p("push ".concat(t.type||r.schema.title)),d(r,t),a=new Promise((function(e,r){var i=y++;n={id:i,action:t,resolve:e,reject:r}})),n.promise=a,h.push(n),m(),o=i(k.values());try{for(o.s();!(c=o.n()).done;)(0,c.value)(t,a)}catch(s){o.e(s)}finally{o.f()}return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setProcessor:function(e){u(!y||!l,"cannot switch after commencing"),u("function"===typeof e),l=e},halt:function(){var e=o(s.mark((function e(t){var n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("_isActive"),f=!1,e.next=3,new Promise((function(e){return setTimeout(e,t)}));case 3:n=new Error("Queue is halting operation"),v.values().forEach((function(e){return(0,e.reject)(n)})),v.clear();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};return x},d=function(e,t){e&&(u("function"===typeof e.isModel),u(e.isModel(t),"model is not addable"))};e.exports={ioQueueFactory:l,sqsQueueFactory:function(e,t){u(e&&"string"===typeof e);var i=n(18)("interblock:queue:sqs:"+e),a=l(e,t),c=a.push,p=function(e){a.push(e)};return r(r({},a),{},{push:function(){var n=o(s.mark((function n(r){return s.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i("push sqs ".concat(e)),d(t,r),n.next=4,p(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),pushDirect:c,setSqsProcessor:function(e){!a.getProcessor()||a.setProcessor(a.getProcessor()),p=e}})}}}).call(this,n(148).setImmediate)},821:function(e,t,n){var r={"./aclModel":355,"./aclModel.js":355,"./actionModel":173,"./actionModel.js":173,"./addressModel":120,"./addressModel.js":120,"./binaryModel":373,"./binaryModel.js":373,"./blockModel":215,"./blockModel.js":215,"./channelModel":276,"./channelModel.js":276,"./configModel":385,"./configModel.js":385,"./continuationModel":222,"./continuationModel.js":222,"./covenantIdModel":375,"./covenantIdModel.js":375,"./dmzModel":269,"./dmzModel.js":269,"./integrityModel":102,"./integrityModel.js":102,"./interblockModel":279,"./interblockModel.js":279,"./keypairModel":175,"./keypairModel.js":175,"./lockModel":576,"./lockModel.js":576,"./networkModel":275,"./networkModel.js":275,"./pendingModel":387,"./pendingModel.js":387,"./proofModel":389,"./proofModel.js":389,"./provenanceModel":174,"./provenanceModel.js":174,"./publicKeyModel":216,"./publicKeyModel.js":216,"./remoteModel":278,"./remoteModel.js":278,"./signatureModel":374,"./signatureModel.js":374,"./simpleArrayModel":388,"./simpleArrayModel.js":388,"./stateModel":384,"./stateModel.js":384,"./timestampModel":274,"./timestampModel.js":274,"./validatorsModel":386,"./validatorsModel.js":386};function i(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=a,e.exports=i,i.id=821},824:function(e,t,n){var r=n(15),i=n(12),a=(n(18)("interblock:models:modelInflator"),new(n(498))({allErrors:!0,verbose:!0})),s=n(260).registry,o=function(e,t){i("object"===e.type),i(e.patternProperties),i(!e.additionalProperties),i.strictEqual(Object.keys(e.patternProperties).length,1);var n=Object.keys(e.patternProperties)[0],r="[0-9]*"===n,a=e.patternProperties[n],o=s.get(a.title);i(o,"patternProperties must use models for values");var c={};return Object.keys(t).map((function(e){if(r){var n=parseInt(e);i(Number.isInteger(n),"".concat(e," is not number: ").concat(n))}c[e]=o.clone(t[e])})),c},c=function(e,t){if(i(Array.isArray(t)),i("array"===e.type),i(e.uniqueItems,"uniqueItems not set: ".concat(e.title)),"number"===e.items.type)return t;var n=s.get(e.items.title);return i(n,"Arrays must be models"),t.map(n.clone)},u=function(e,t){i(!e.additionalProperties,"additionalProperties: ".concat(e.title));var n=Object.keys(t),r=(Object.keys(e.properties),e.required.every((function(e){return"undefined"!==typeof t[e]})));i(r);var a=n.every((function(t){return e.properties[t]}));i(a,"fail ".concat(e.title))},l=new Map,d=function(e,t){i(e,"No schema supplied");var n=l.get(e);if(!n)try{n=a.compile(e),l.set(e,n)}catch(c){var r="Compilation failed: ".concat(e&&e.title," ").concat(c.message);throw new Error(r)}var s=n(t),o=a.errorsText(n.errors);if(!s)throw new Error("".concat(e.title," failed validation: ").concat(o))};e.exports={modelInflator:function(e,t){if("State"===e.title)return r({},t);if(i(e.title,"only titled schemas can be inflated"),e.patternProperties)return o(e,t);if("array"===e.type)return c(e,t);u(e,t);var n={},a=e.properties;return Object.keys(t).map((function(e){var r=a[e],i=r.title,u=r.type,l=r.patternProperties,p=t[e];s.isRegistered(i)?n[e]=s.get(i).clone(p):"array"!==u?l?n[e]=o(a[e],p):(d(a[e],p),n[e]=p):n[e]=c(a[e],p)})),n},precompileSchema:function(e){i(e.title,"No title supplied"),validator=a.compile(e),l.set(e,validator)}}},858:function(e,t,n){(function(t){var r=n(9),i=n(10),a=n(12),s=n(18)("interblock:crypto:sodium"),o=n(859),c=o.SodiumPlus,u=o.Ed25519PublicKey,l=o.Ed25519SecretKey,d=n(550),p=d.objectHash,f=(d.generateNonce,{publicKey:"I7xUkSwebpLEqGglyGfif/3FVb/71CRPF6Jqv//ull0=",secretKey:"MDEyMzQ1Njc4OWFiY2RlZjAxMjM0NTY3ODlhYmNkZWYjvFSRLB5uksSoaCXIZ+J//cVVv/vUJE8Xomq//+6WXQ=="}),h={publicKey:"8aktZHsVyr/yy6arJiJP8F1OI4Na5eQw9pIH6f7XrV0=",secretKey:"r6m8nU2GqsSg38+0TXKXrIgd8WHsJfr5qlSZZDz7GN7xqS1kexXKv/LLpqsmIk/wXU4jg1rl5DD2kgfp/tetXQ=="};Object.freeze(f),Object.freeze(h);var v,g=new Set(["".concat(f.publicKey,"_").concat(f.secretKey),"".concat(h.publicKey,"_").concat(h.secretKey)]),y=function(){return v||(v=c.auto()),v};y();var m=p("template"),b=function(){var e=i(r.mark((function e(){var t,n,i,o,c,u,l,d,p,f=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:"",e.next=3,y();case 3:for(n=e.sent,a.strictEqual(typeof t,"string"),a(t.length<=32,"seed too long: ".concat(t.length)),t.length&&s("INSECURE padding seed to 32 bytes - got ".concat(t.length));t.length&&t.length<32;)t+="_";if(t.length){e.next=12;break}return e.next=11,n.randombytes_buf(32);case 11:t=e.sent;case 12:return e.next=14,n.crypto_sign_seed_keypair(t);case 14:return i=e.sent,e.next=17,n.crypto_sign_secretkey(i);case 17:return o=e.sent,e.next=20,n.crypto_sign_publickey(i);case 20:return c=e.sent,u={publicKey:c.toString("base64"),secretKey:o.toString("base64")},l=u.publicKey,d=u.secretKey,p="".concat(l,"_").concat(d),g.add(p),e.abrupt("return",u);case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=i(r.mark((function e(t){var n,i,s,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.publicKey,i=t.secretKey,a.strictEqual(typeof n,"string"),a.strictEqual(typeof i,"string"),s="".concat(n,"_").concat(i),e.prev=4,e.next=7,x(m,i);case 7:return o=e.sent,c=o.signature,e.next=11,w(m,c,n);case 11:e.sent&&g.add(s),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(4);case 17:return e.abrupt("return",g.has(s));case 18:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=i(r.mark((function e(t,n){var i,s,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.strictEqual(t.length,m.length,"use objectHash()"),i=l.from(n,"base64"),e.next=4,y();case 4:return s=e.sent,e.next=7,s.crypto_sign_detached(t,i);case 7:return o=e.sent,c=o.toString("base64"),e.abrupt("return",{messageHash:t,signature:c});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=function(){var e=i(r.mark((function e(n,i,a){var o,c,l,d,p;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.from(i,"base64"),c=u.from(a,"base64"),e.next=4,y();case 4:return l=e.sent,e.next=7,l.crypto_sign_verify_detached(n,c,o);case 7:return d=e.sent,p="".concat(n,"_").concat(i,"_").concat(a),d?g.add(p):s("verifyHash failed"),e.abrupt("return",d);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),I=function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return t=e.sent,e.abrupt("return",t.getBackendName());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e.exports={signHash:x,verifyHash:w,verifyHashSync:function(e,t,n){var r="".concat(e,"_").concat(t,"_").concat(n);return g.has(r)},generateKeyPair:b,verifyKeyPair:k,verifyKeyPairSync:function(e){var t=e.publicKey,n=e.secretKey;return g.has("".concat(t,"_").concat(n))},testMode:function(){s("no testmode in sodium")},ciKeypair:f,pierceKeypair:h,_verifiedSet:g,_getBackend:I}}).call(this,n(17).Buffer)},87:function(e,t,n){var r=n(15),i=n(34),a={title:"Action",description:"Messages for communicating with a chains reducer.\n  Actions are always delivered as part of a channel between chains.",type:"object",required:["type","payload"],additionalProperties:!1,properties:{type:{type:"string",description:"The type of the action which is specified by the developer"},payload:{type:"object",description:"Type dependent data being transmitted with the action"}}},s={title:"Continuation",description:"Actions that implement the continuation system.",type:"object",required:["type","payload"],additionalProperties:!1,properties:{type:{type:"string",description:"One of three types.  Synchronous replies are resolves or rejections too.",enum:["@@REJECT","@@PROMISE","@@RESOLVE"]},payload:{type:"object",description:"Type dependent data being transmitted with the action"}}},o={title:"Integrity",description:"cryptographically secure hash produced from content.\n  May be 'UNKNOWN' to signal an address is unknown.",type:"object",additionalProperties:!1,required:["hash","algorithm"],properties:{hash:{type:"string",description:"base58 encoded hash hopefully with identifier at front, or UNKNOWN"},algorithm:{enum:["sha256"]}}},c={title:"Address",description:"Hash of the Provenance of the first block in this chain, \n  with prefix, check digits, in base58",type:"object",additionalProperties:!1,required:["chainId","status"],properties:{chainId:o,status:{pattern:"^UNKNOWN$|^GENESIS_|^LOOPBACK$|^ROOT$|^RESOLVED$|^INVALID$"}}},u={title:"PublicKey",description:"public key of a public / secret pair",type:"object",additionalProperties:!1,required:["key","algorithm"],properties:{key:{type:"string"},algorithm:{enum:["tweetnacl","sodium"]}}},l={title:"Signature",description:"A cryptographic signature of some detached integrity",type:"object",additionalProperties:!1,required:["publicKey","integrity","seal"],properties:{publicKey:u,integrity:o,seal:{type:"string"}}},d={title:"Provenance",description:'Proof of the Provenance of the object \n  referenced by signed integrity.\n  The integrity of the first provenance in a chain is the chainId.\n  When the provenance is inserted back into the dmz, the dmz becomes a Block.\n  The integrity which is signed is the integrity of the whole object, \n  minus "integrity" and "signatures" keys\n  \n  Integrity can be a merkle proof so a set of chains with the same\n  validators can create signatures for the root hash, then distribute\n  to all the chains where each is blinded to the others in the merkle \n  proof.\n  \n  Running chains internally is much faster than cross block boundaries.',type:"object",additionalProperties:!1,required:["dmzIntegrity","address","lineage","height","integrity","signatures"],properties:{dmzIntegrity:o,address:c,lineage:{type:"object",description:"Object of previous blockhashes this provenance item extends.\n  There may be many, but at least one is the most recent block provenance.\n  Others might be those resulting from overdrive consensus,\n  or periodic shortcutting of the chain history to quick lookup purposes.\n  Height must always be greater than any previous provenance for this address.\n  Provenance is monotonic, and should increment by 1 each time.\n  \n  First lineage supplied to create defines the chainId of the result.\n  \n  Provenance is a statement of authenticity and position in lineage.  \n  Lineage is the chain of previous provenances.\n  \n  Key gives the provenance id, which can be height, or foreignChain:height.\n  Value gives the hash of the block at the provenance id.",patternProperties:{"(.*?)":o}},height:{type:"integer",minimum:0},integrity:o,signatures:{type:"array",items:l,minItems:1,uniqueItems:!0}}},p={title:"Validators",type:"object",additionalProperties:!1,minProperties:1,patternProperties:{"(.*?)":u}},f={title:"Proof",description:"Interblock proof model.",type:"object",additionalProperties:!1,required:["block"],properties:{block:{type:"string"},network:{type:"object"},channel:{type:"string"}}},h={title:"Remote",description:"Slice of Channel state transmitted with a heavy Interblock",type:"object",additionalProperties:!1,required:["address","replies","requests","heavyHeight","lineageHeight"],properties:{address:c,replies:{type:"object",additionalProperties:!1,patternProperties:{"[0-9]*":s}},requests:{type:"object",additionalProperties:!1,patternProperties:{"[0-9]*":a}},heavyHeight:{type:"integer",minimum:-1},lineageHeight:{type:"integer",minimum:-1}}},v={title:"Interblock",description:"The fundamental unit of inter chain communication.\n  Contains provenance, a punched out DMZ, and a single transmit channel\n  of the source chain.\n  This must be an model, so as to ensure we do not leak info, rather \n  than making it a special case of a BlockModel.\n  This cannot import dmzModel directly, as it is a fundamental\n  circular reference, as the outside depends on the inside.\n  This can only be made from a validated block.\n  \n  This is the only place that needs punched out proofs.\n  \n  With no transmit key, an interblock is simply a provenance chain,\n  which is needed to ensure lineage\n  \n  By placing interblock stream inside the transmission, each side of\n  a connection can know what block of theirs the other side has processed.",type:"object",required:["provenance","proof","validators"],additionalProperties:!1,properties:{provenance:d,proof:f,network:{type:"object",additionalProperties:!1,minProperties:0,maxProperties:1,patternProperties:{"(.*?)":h}},validators:p}},g={title:"Channel",description:"Communication Queues.\n  These queues and their responses are what all interchain\n  communication seeks to facilitate.  All the cryptography\n  employed in this system is to reliably process these \n  queues.\n  \n  Each connection side has a transmit and a receive.\n  Each connection side transmits requests and replies to the other.\n  \n  Transmit = Sum( Channel ) \n  Receive = Sum( Interblock( Channel ) )\n  Interblocks  = Channel + Provenance\n  \n  'provenance' contains a continuous chain all the way back to  the foreign genesis.\n  \n  The contents of the latest received channel is stored on 'remote'\n  Replies are always processed before incoming requests.\n  When a received reply has executed, the local transmit action is removed\n  from the transmit queue.\n  \n  The queues hold the index for their next actions within them:\n  1.  Next remote reply index is the smallest index of the transit queue\n      for which there is a remote reply that is not a promise\n  2.  Next remote request index is given by the local highest reply index\n  \n  If systemRole === '.' then provenance checks are excused, as the\n  networkProducer.tx() function will flip outbound and inbound.  This is used\n  in the self channel.\n  \n  Counter is required to know where the request counter is up to, which needs independent\n  tracking as the channel might be cleared completely, but we cannot reuse numbers until\n  looparound at 32bit limit or similar",type:"object",required:[].concat(i(h.required),["systemRole","requestsLength","lineage","lineageTip"]),additionalProperties:!1,properties:r(r({},h.properties),{},{systemRole:{enum:["..",".","./","UP_LINK","DOWN_LINK","PIERCE"]},requestsLength:{type:"integer",minimum:0},heavy:v,lineage:{type:"array",uniqueItems:!0,items:o},lineageTip:{type:"array",uniqueItems:!0,items:v}})};e.exports={integritySchema:o,addressSchema:c,proofSchema:f,interblockSchema:v,provenanceSchema:d,validatorsSchema:p,signatureSchema:l,publicKeySchema:u,remoteSchema:h,channelSchema:g,actionSchema:a,continuationSchema:s}},88:function(e,t,n){var r=n(2227),i=n(2228),a=n(2229),s=n(556),o=n(2230);e.exports={networkProducer:r,blockProducer:i,lockProducer:a,channelProducer:s,pendingProducer:o}},891:function(e,t){},892:function(e,t){},945:function(e,t){},948:function(e,t,n){var r=n(121),i=n(9),a=n(15),s=n(10),o=n(12),c=n(18)("interblock:apps:collection"),u=n(552),l=u.convertToTemplate,d=u.demuxFormData,p=u.validateDatumTemplate,f=u.muxTemplateWithFormData,h=n(55).interchain,v=n(103).actions.spawn,g=function(){var e=s(i.mark((function e(t,n){var r,s,o,g,k,x,w,I,C,M,R,E,P;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.type,s=n.payload,e.t0=r,e.next="@@INIT"===e.t0?4:"ADD"===e.t0?8:"SET_TEMPLATE"===e.t0?30:33;break;case 4:return c("init"),o=l(t.datumTemplate||{}),c("datumTemplate",o),e.abrupt("return",a(a({},t),{},{datumTemplate:o}));case 8:if(g=t.datumTemplate,p(g),s.isTestData||y(s),k=d(g,n),x=b(g,k),w=u.covenantId,I=v(x,{covenantId:w}),!x){e.next=19;break}h(I),e.next=24;break;case 19:return e.next=21,h(I);case 21:C=e.sent,M=C.alias,x=M;case 24:return R=f(g,k),E=u.actions.set(R),c("datum set action",E),e.next=29,h(E,x);case 29:return e.abrupt("return",t);case 30:return m(s),P=l(s),e.abrupt("return",a(a({},t),{},{datumTemplate:P}));case 33:throw c(n),new Error("Unknown action type: ".concat(n.type));case 35:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y=function e(t){var n=t.formData,i=t.children,a=r(t,["formData","children"]);if("undefined"===typeof n)throw new Error("Must provide formData key");if(a)throw new Error("Only allowed keys are formData and children");if(i){if("object"!==typeof i)throw new Error("children must be object");return Object.values(i).every(e)}},m=function e(t){if(t.formData)throw new Error("No formData allowed on datum template");if(t.children)return Object.values(t.children).every(e)},b=function(e,t){if(e.namePath.length){var n=t.formData;return e.namePath.forEach((function(e){n=n[e]})),"number"===typeof n&&(n+=""),o.strictEqual(typeof n,"string"),c("_getChildName",n),n}c("_getChildName is blank")};e.exports={reducer:g,actions:{add:function(e){return{type:"ADD",payload:e}},setDatumTemplate:function(e){return{type:"SET_TEMPLATE",payload:e}},search:function(){return{type:"SEARCH"}},lock:function(){return{type:"LOCK"}},delete:function(){return{type:"DELETE"}}}}}},[[2918,1,2]]]);